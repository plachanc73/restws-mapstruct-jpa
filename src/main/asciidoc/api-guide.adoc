= Advitam Acquisition et Traitement - Documentation des services Web REST
Auteurs : Julien Mercier, Marco Gonzales et Pascal Lachance;
:doctype: book
:icons: font
:source-highlighter: highlightjs
:toc: left
:toclevels: 2
:sectlinks:

[[overview]]
= Présentation

Advitam est l’acronyme pour *Application Dédiée au Versement d’Information et au Traitement des Archives sur Multiples supports*, qui fait référence au latin Ad Vitam « pour la vie » donc à la conservation permanente de l’information acquise par BAnQ.

Pistard, l'ancien nom de l'application, signifie *Programme Informatisé Servant au Traitement des Archives et à la Recherche Documentaire*.

DGAN signifie *Direction Générale des Archives Nationales*.

Voici les informations pour les services Web de l'application Advitam :

 * <<architecture-api>>
 * <<code-http>>
 * <<roles-usagers>>
 * Services Web REST
 ** <<services-banq-commun>>
 ** <<services-pistard>>

[[architecture-api]]
== Architecture de l'API

L'architecture du back-end de Advitam repose sur des services Web de type REST.
Ainsi, chaque appel au back-end est *stateless* c'est à dire que le back-end ne garde pas de session entre les différentes requêtes, respectant ainsi la philosophie REST.

Les services Web peuvent être exposés sous les deux URL suivants :

 * depuis l'application (usager authentifié) : /service

 * depuis l'externe (anonyme) : /service_ext

Pour les appels des services Web depuis le portail (sous /service_ext), les utilisateurs n'ont pas besoin d'être authentifiés. Tandis que pour les services Web appelés depuis l'application (sous /service), les utilisateurs devront obligatoirement être authentifiés dans le front-end pour y avoir accès.
Le back-end récupère alors le code usager (uid) de l'utilisateur authentifié dans le front-end pour chaque requête effectuée.
Le système d'authentification utilisé est Shibboleth. L'architecture de sécurité n'est pas présentée ici, mais il peut-être utile de savoir qu'avant de parvenir au serveur d'applications back-end (WildFly), la requête passe par un serveur Apache pour l'authentification.

L'API utilse les actions HTTP suivantes :

 * POST : Pour créer et filtrer des ressources.
 * GET : Pour obtenir une ou plusieurs ressources.
 * PUT : Pour modifier une ressource.
 * PATCH : Pour changer une ou plusieurs ressources.
 * DELETE : Pour supprimer une ou plusieurs ressources.


[[code-http]]
== Codes de retour HTTP

Voici les codes de retour HTTP retournés par les services Web de Advitam :

 * 200 : Requête traitée avec succès.

 * 201 : Requête traitée avec succès et création d'un objet.

 * 202 : Requête acceptée. Ce code est retourné par le serveur lorsque la requête est en cours de traitement. Une notification sera envoyée à l'utilisateur pour l'informer que la requête est terminée.

 * 400 : Mauvaise Requête. Ce code est retourné par le serveur lorsque le lien ou le payload fourni n'est pas valide. Lorsque le payload fourni n'est pas valide et normalement un message d'erreur est retourné pour expliquer le problème.

 * 403 : Rôles insuffisants. L'utilisateur authentifié n'a pas les droits suffisants pour appeler le service. À ne pas confondre avec 401 qui est le code retourné par shibboleth lors d'un échec d'authentification.

 * 404 : Ressource inexistante. La ressource demandée n'existe pas. Par exemple, un GET /service/offreAcquisition/1/noteDesuivi pour obtenir les notes de suivi de l'offre d'acquisition numéro 1, retourne un code HTTP 404 si l'offre numéro 1 n'existe pas.

 * 409 : Conflit. La requête ne peut être traitée dans l'état actuel. Par exemple, si un des employés est déja assigné à l'offre ou si un numéro de dossier existe déjà pour l'organisme d'un versement.

 * 412 : Pré-conditions non-satisfaites. Une fois que l'authentification et l'autorisation est passées, que le payload json est valide et que la ressource demandée existe, le service vérifie que les pré-conditions métiers sont respectées. Par exemple, pour compléter une offre d'acquisition, l'utilisateur doit être assigné à l'offre et l'offre en question doit-être au statut *NOUV - Nouvelle* ou au statut 'REAF - Réaffectée'.

 * 500 : Erreur serveur. Une erreur s'est produite au niveau du serveur empêchant le traitement de poursuivre. Par exemple, l'utilisateur s'est authentifié avec shibboleth, mais le code utilisateur n'existe pas dans la base de données de Advitam. Dans ce cas, l'erreur retournée dans le payload peut donner une idée, mais il est souvent nécessaire d'aller voir les logs du serveur wildfly afin de comprendre le problème survenu.


[[roles-usagers]]
== Rôles des utilisateurs

Voici les rôles des employés et des utilisateurs externes pouvant utiliser Advitam :

 * <<roles-usagers-internes>>
 * <<roles-usagers-externes>>

Voici le service pour obtenir les informations de l'usager authentifié avec ses rôles :

 * <<services-usager-roles>>

[[roles-usagers-internes]]
=== Rôles des employés

Voici les rôles des employés qui sont considérés comme *usagers internes* :

 * Administrateur système (ADMIN_SYSTEME avec l'indicateur IND_ADMIN_SYSTEME)
 * Archiviste d'un centre d'archives BAnQ (PROFESSIONNEL avec l'indicateur IND_PROFESSIONNEL_PISTARD)
 * Coordonnateur d'un centre d'archives BAnQ (COORDONNATEUR avec l'indicateur IND_COORDONNATEUR)
 * Directeur d'un centre d'archives BAnQ (DIRECTION avec l'indicateur IND_DIRECTION_PISTARD)
 * Directeur de comité (DIRECTEUR_COMITE avec l'indicateur IND_DIRECTEUR_COMITE)
 * Employé d'un centre d'archives BAnQ avec un accès en consultation (CONSULTATION_PISTARD avec l'indicateur IND_CONSULTATION_PISTARD)
 * Responsable des facettes (RESPONSABLE_FACETTE avec l'indicateur IND_RESP_FACETTES)
 * Responsable des espaces de conservation (RESPONSABLE_ESPACES avec l'indicateur IND_RESP_ESPACES)
 * Responsable des restrictions (ANALYSTE_RESTRICTION avec l'indicateur IND_ANALYSTE_RESTRICTION)
 * Soutien d'un centre d'archives BAnQ (SOUTIEN avec l'indicateur IND_SOUTIEN_PISTARD)

[[roles-usagers-externes]]
=== Rôles des utilisateurs externes

Voici les utilisateurs externes qui sont considérés comme *usagers externes* travaillant pour un organisme :

 * Responsable des versements (RESPONSABLE_ORGANISME avec le secteur responsabilité VER)
 * Soutien au responsable des versements (SOUTIEN_ORGANISME avec le secteur responsabilité SOV)

[[services-usager-roles]]
=== Obtenir les informations d'un usager

Voici le service web pour obtenir les informations de l'usager authentifié avec ses rôles :

==== Exemple de requête

include::{snippets}/get_roles/http-request.adoc[]

==== Exemple de réponse

include::{snippets}/get_roles/http-response.adoc[]


[[services-banq-commun]]
== Services Web REST BAnQ Commun

Les ressources suivantes sont disponibles avec les services Web REST *BAnQ Commun* :

 * <<services-banq-commun-cache>>
 * <<services-banq-reference-centreArchive>>
 * <<services-banq-reference-conditionUtilisation>>
 * <<services-banq-reference-employe>>
 * <<services-banq-reference-genreDocument>>
 * <<services-banq-reference-greffe>>
 * <<services-banq-reference-juridiction>>
 * <<services-banq-reference-modeleDocument>>
 * <<services-banq-reference-municipalite>>
 * <<services-banq-commun-organisme>>
 * <<services-banq-reference-province>>
 * <<services-banq-reference-regionAdmin>>
 * <<services-banq-commun-regle>>
 * <<services-banq-commun-supportConsultation>>

[[services-banq-commun-cache]]
=== Cache d'objets

Les services Web pour les caches d'objets permettent :

 * <<services-banq-commun-cache-obtenirListe>>
 * <<services-banq-commun-cache-retirer>>

Les objets en cache sont ajoutés en lecture lors de l'obtention d'un objet en consultation par un usager ou en écriture par un usager qui veut le modifier.

Les objets en cache peuvent être retirés avec le lien fourni pour chaque objet dans la liste des objets en cache.

Voici les types d'objets ajoutés en cache actuellement par Advitam :

 * offreAcquisition
 * versementPublique

[[services-banq-commun-cache-obtenirListe]]
==== Obtenir les objets en cache

===== Exemple de requête

include::{snippets}/get_objetsEnCache/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_objetsEnCache/http-response.adoc[]


[[services-banq-commun-cache-retirer]]
==== Retirer un objet en cache

La méthode HTTP GET est utilisée ici exceptionnellement pour retirer un objet en cache (au lieu de DELETE), car on veut permettre que le lien *urlRemove* de chaque objet en cache puisse être utilisé en cliquant tout simplement dessus.

Les services Web pour retirer un objet en cache permettent :

 * <<services-banq-commun-cache-retirer-offreAcquisition>>
 * <<services-banq-commun-cache-retirer-versementPublique>>

[[services-banq-commun-cache-retirer-offreAcquisition]]
===== Retirer un objet en cache de type offreAcquisition

L'identifiant d'un objet en cache de type *offreAcquisition* est l'identifiant de l'acquisition correspondant à la propriété *acquisition.id* de l'entité *OffreAcquisition* et à la propriété *id* du Json *OffreAcquisitionJson*.

====== Exemple de requête

include::{snippets}/retirer_objetEnCache_offreAcquisition/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/retirer_objetEnCache_offreAcquisition/http-response.adoc[]

[[services-banq-commun-cache-retirer-versementPublique]]
===== Retirer un objet en cache de type versementPublique

L'identifiant d'un objet en cache de type *versementPublique* est l'identifiant de l'acquisition correspondant à la propriété *acquisition.id* de l'entité *VersementPublique* et à la propriété *id* du Json *VersementPubliqueJson*.

====== Exemple de requête

include::{snippets}/retirer_objetEnCache_versementPublique/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/retirer_objetEnCache_versementPublique/http-response.adoc[]


[[services-banq-reference-centreArchive]]
=== Centre d'archives

Les services Web pour les centres d'archives (aussi appelés centres BAnQ) permettent :

 * <<services-banq-reference-centreArchive-obtenirListe>>
 * <<services-banq-reference-centreArchive-obtenirAssocieEmploye>>
 * <<services-banq-reference-centreArchive-obtenir>>

[[services-banq-reference-centreArchive-obtenirListe]]
==== Obtenir les centres d'archives

Avec un usager authentifié, le tri des centres d'archives est effectué sur le nom et si le servive web est appelé de façon anonyme (externe), le tri des centres d'archives est effectué sur le type pour avoir les centres BAnQ en premier et ensuite le tri est effectué sur le nom complet.

===== Exemple de requête

Avec un usager authentifié :

include::{snippets}/get_centresArchives/http-request.adoc[]

Ou de façon anonyme (externe) :

include::{snippets}/get_centresArchivesExt/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_centresArchives/http-response.adoc[]


[[services-banq-reference-centreArchive-obtenirAssocieEmploye]]
==== Obtenir les centres d'archives associés à un employé à partir de son code

===== Exemple de requête

include::{snippets}/get_centresArchives_employe/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_centresArchives_employe/http-response.adoc[]


[[services-banq-reference-centreArchive-obtenir]]
==== Obtenir un centre d'archives à partir de son code

pass:q[<u>*La précondition*</u>] pour obtenir un centre d'archives est :

 * Un centre d'archives doit exister selon le code fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/get_centreArchives/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_centreArchives/http-response.adoc[]


[[services-banq-reference-conditionUtilisation]]
=== Préférence de condition d'utilisation

Les services Web pour les préférences de condition d'utilisation permettent :

 * <<services-banq-reference-conditionUtilisation-obtenirListe>>
 * <<services-banq-reference-conditionUtilisation-obtenir>>

[[services-banq-reference-conditionUtilisation-obtenirListe]]
==== Obtenir les préférences de condition d'utilisation selon un type

Voici les types de condition d'utilisation possibles :

 * ACQUISITION - Pour les acquisitions privées
 * CONDITION_EN_LIGNE - Pour les conditions de consultation en ligne
 * CONVENTION_UTIL - Pour la spécification de la convention
 * DETENTION_DROITS - Pour la détention des droits sur une unité de description
 * DOMAINE_PUB - Pour les document(s) appartenant au domaine public
 * UTIL_LICENCE_BANQ - Pour l'utilisation de la sous-licence par BAnQ
 * UTIL_LICENCE_USAGER - Pour l'utilisation de la sous-licence par l'usager

===== Exemple de requête

include::{snippets}/get_PreferencesConditionUtilisationByType/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_PreferencesConditionUtilisationByType/http-response.adoc[]


[[services-banq-reference-conditionUtilisation-obtenir]]
==== Obtenir une préférence de condition d'utilisation à partir de son code

pass:q[<u>*La précondition*</u>] pour obtenir une préférence de condition d'utilisation est :

 * Une préférence de condition d'utilisation doit exister selon le code fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/get_PreferenceConditionUtilisationByCode/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_PreferenceConditionUtilisationByCode/http-response.adoc[]


[[services-banq-reference-employe]]
=== Employé

Les services Web pour les employés permettent :

 * <<services-banq-reference-employe-obtenirListe>>
 * <<services-banq-reference-employe-obtenir>>

[[services-banq-reference-employe-obtenirListe]]
==== Obtenir les employés pour un centre d'archives donné

La liste des employés retournée est triée par ordre croissant du *Nom* et du *Prénom*.

Voici les paramètres optionnels :

 * Avec aucun paramètre, les employés actifs de tous les centres d'archives BAnQ sont retournés.
 * Avec le paramètre *codeCentreArchive*, les employés actifs associé au centre d'archives mentionné sont retournés.
 * Avec le paramètre *codeCentreArchiveAutorise*, les employés actifs autorisés au centre d'archives mentionné sont retournés.
 * Avec le paramètre *indProfessionnel* à true, les employés actifs avec un rôle d'archiviste (PROFESSIONNEL) sont retournés.
 * Avec le paramètre *indSoutien* à true, les employés actifs avec un rôle de soutien (SOUTIEN) sont retournés.
 * Avec les paramètres *codeCentreArchive*, *idOrganisme* et *indProfessionnel* à true, les employés actifs avec un rôle d'archiviste (PROFESSIONNEL) associés au centre d'archives mentionné sont retournés avec l'indicateur *indResponsableVersements* activé à true pour l'archiviste responsable des versements de l'organisme.

===== Exemple de requête

include::{snippets}/get_employes/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_employes/http-response.adoc[]


[[services-banq-reference-employe-obtenir]]
==== Obtenir un employé à partir de son code d'employé

pass:q[<u>*La précondition*</u>] pour obtenir un employé est :

 * Un employé doit exister selon le code fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/get_employeByCode/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_employeByCode/http-response.adoc[]


[[services-banq-reference-genreDocument]]
=== Genre de document

Les services WEB pour les genres de document permettent :

 * <<services-banq-reference-genreDocument-obtenirListe-generaux>>
 * <<services-banq-reference-genreDocument-obtenirListe-generaux-avecSpecifiques>>
 * <<services-banq-reference-genreDocument-obtenirListe-specifiques>>
 * <<services-banq-reference-genreDocument-obtenirListe-specifiquesPourGenreGeneral>>
 * <<services-banq-reference-genreDocument-obtenir>>
 * <<services-banq-reference-genreDocument-modifier>>

[[services-banq-reference-genreDocument-obtenirListe-generaux]]
==== Obtenir les genres de document généraux

===== Exemple de requête

Avec un usager authentifié :

include::{snippets}/get_genresGeneraux/http-request.adoc[]

Ou de façon anonyme (externe) :

include::{snippets}/get_genresGenerauxExt/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_genresGeneraux/http-response.adoc[]


[[services-banq-reference-genreDocument-obtenirListe-generaux-avecSpecifiques]]
==== Obtenir les genres de document généraux avec les spécifiques

===== Exemple de requête

Avec un usager authentifié :

include::{snippets}/get_genresGeneraux_avecGenresSpecifiques/http-request.adoc[]

Ou de façon anonyme (externe) :

include::{snippets}/get_genresGenerauxExt_avecGenresSpecifiques/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_genresGeneraux_avecGenresSpecifiques/http-response.adoc[]


[[services-banq-reference-genreDocument-obtenirListe-specifiques]]
==== Obtenir les genres de document spécifiques

===== Exemple de requête

Avec un usager authentifié :

include::{snippets}/get_genresSpecifiques/http-request.adoc[]

Ou de façon anonyme (externe) :

include::{snippets}/get_genresSpecifiquesExt/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_genresSpecifiques/http-response.adoc[]


[[services-banq-reference-genreDocument-obtenirListe-specifiquesPourGenreGeneral]]
==== Obtenir les genres de document spécifiques pour un genre de document général

pass:q[<u>*La précondition*</u>] pour obtenir un genre de document est :

 * Un genre de document général doit exister selon le code fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

Avec un usager authentifié :

include::{snippets}/get_genresSpecifiquesPourGenreGeneral/http-request.adoc[]

Ou de façon anonyme (externe) :

include::{snippets}/get_genresSpecifiquesExtPourGenreGeneral/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_genresSpecifiquesPourGenreGeneral/http-response.adoc[]


[[services-banq-reference-genreDocument-obtenir]]
==== Obtenir un genre de document à partir de son code

pass:q[<u>*La précondition*</u>] pour obtenir un genre de document est :

 * Un genre de document doit exister selon le code fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

Avec un usager authentifié :

include::{snippets}/get_genreDocument/http-request.adoc[]

Ou de façon anonyme (externe) :

include::{snippets}/get_genreDocumentExt/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_genreDocument/http-response.adoc[]


[[services-banq-reference-genreDocument-modifier]]
==== Modifier un genre de document

pass:q[<u>*La précondition*</u>] pour modifier un genre de document est :

 * Un genre de document doit exister selon l'identifiant fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/post_modifierDocument/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/post_modifierDocument/http-response.adoc[]


[[services-banq-reference-greffe]]
=== Greffe

Les services WEB pour les greffes permettent :

* <<services-banq-reference-greffe-obtenirListe>>
* <<services-banq-reference-greffe-obtenir>>
* <<services-banq-reference-greffe-creer>>
* <<services-banq-reference-greffe-modifier>>
* <<services-banq-reference-greffe-desactiver>>

[[services-banq-reference-greffe-obtenirListe]]
==== Obtenir les greffes actifs

===== Exemple de requête

include::{snippets}/get_greffes/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_greffes/http-response.adoc[]


[[services-banq-reference-greffe-obtenir]]
==== Obtenir un greffe à partir de son identifiant

pass:q[<u>*La précondition*</u>] pour obtenir un greffe est :

 * Un greffe doit exister selon l'identifiant fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/get_greffeById/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_greffeById/http-response.adoc[]

[[services-banq-reference-greffe-creer]]
==== Créer un greffe

pass:q[<u>*La précondition*</u>] pour créer un greffe est :

 * L'usager doit être interne sinon un code HTTP 403 est retourné.

===== Exemple de requête

include::{snippets}/post_creerGreffe/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/post_creerGreffe/http-response.adoc[]

[[services-banq-reference-greffe-modifier]]
==== Modifier un greffe

pass:q[<u>*Les préconditions*</u>] pour modifier un greffe sont :

 * Un greffe doit exister selon l'identifiant fourni sinon un code HTTP 404 est retourné.
 * L'usager doit être interne sinon un code HTTP 403 est retourné.

===== Exemple de requête

include::{snippets}/put_modifierGreffe/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/put_modifierGreffe/http-response.adoc[]

[[services-banq-reference-greffe-desactiver]]
==== Désactiver un greffe

pass:q[<u>*Les préconditions*</u>] pour désactiver un greffe sont :

 * Un greffe doit exister selon l'identifiant fourni sinon un code HTTP 404 est retourné.
 * L'usager doit être interne sinon un code HTTP 403 est retourné.

===== Exemple de requête

include::{snippets}/delete_desactiverGreffe/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/delete_desactiverGreffe/http-response.adoc[]


[[services-banq-reference-juridiction]]
=== Juridiction

Les services WEB pour les juridictions permettent :

* <<services-banq-reference-juridiction-obtenirListe>>
* <<services-banq-reference-juridiction-obtenir>>
* <<services-banq-reference-juridiction-creer>>
* <<services-banq-reference-juridiction-modifier>>
* <<services-banq-reference-juridiction-desactiver>>

[[services-banq-reference-juridiction-obtenirListe]]
==== Obtenir les juridictions actives

===== Exemple de requête

include::{snippets}/get_juridictions/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_juridictions/http-response.adoc[]


[[services-banq-reference-juridiction-obtenir]]
==== Obtenir une juridiction à partir de son identifiant

pass:q[<u>*La précondition*</u>] pour obtenir une juridiction est :

 * Une juridiction doit exister selon l'identifiant fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/get_juridictionById/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_juridictionById/http-response.adoc[]

[[services-banq-reference-juridiction-creer]]
==== Créer une juridiction

pass:q[<u>*La précondition*</u>] pour créer une juridiction est :

 * L'usager doit être interne sinon un code HTTP 403 est retourné.

===== Exemple de requête

include::{snippets}/post_creerJuridiction/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/post_creerJuridiction/http-response.adoc[]

[[services-banq-reference-juridiction-modifier]]
==== Modifier une juridiction

pass:q[<u>*Les préconditions*</u>] pour modifier une juridiction sont :

 * Une juridiction doit exister selon l'identifiant fourni sinon un code HTTP 404 est retourné.
 * L'usager doit être interne sinon un code HTTP 403 est retourné.

===== Exemple de requête

include::{snippets}/put_modifierJuridiction/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/put_modifierJuridiction/http-response.adoc[]

[[services-banq-reference-juridiction-desactiver]]
==== Désactiver une juridiction

pass:q[<u>*Les préconditions*</u>] pour désactiver une juridiction sont :

 * Une juridiction doit exister selon l'identifiant fourni sinon un code HTTP 404 est retourné.
 * L'usager doit être interne sinon un code HTTP 403 est retourné.

===== Exemple de requête

include::{snippets}/delete_desactiverJuridiction/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/delete_desactiverJuridiction/http-response.adoc[]


[[services-banq-reference-modeleDocument]]
=== Modèle de document

Les services Web pour les modèles de document permettent :

 * <<services-banq-reference-modeleDocument-obtenirListe>>
 * <<services-banq-reference-modeleDocument-obtenir>>
 * <<services-banq-reference-modeleDocument-modifier>>

 * Obtenir un modèle de document à partir de son code pour l'un des types d'objet suivants :
 ** assignation - <<services-banq-reference-modeleDocument-assignation>>
 ** offreAcquisition - <<services-banq-reference-modeleDocument-offreAcquisition>>
 ** versementPublique - <<services-banq-reference-modeleDocument-versementPublique>>
 ** demandeRestriction - <<services-banq-reference-modeleDocument-demandeRestriction>>

[[services-banq-reference-modeleDocument-obtenirListe]]
==== Obtenir les modèles de document

===== Exemple de requête

include::{snippets}/get_modelesDocument/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_modelesDocument/http-response.adoc[]


[[services-banq-reference-modeleDocument-obtenir]]
==== Obtenir un modèle de document à partir de son code

pass:q[<u>*La précondition*</u>] pour modifier un modèle de document est :

 * Un modèle de document doit exister selon le code fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/get_modeleDocument/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_modeleDocument/http-response.adoc[]


[[services-banq-reference-modeleDocument-modifier]]
==== Modifier un modèle de document

pass:q[<u>*Les préconditions*</u>] pour modifier un modèle de document sont :

 * Un modèle de document doit exister selon le code fourni sinon un code HTTP 404 est retourné.
 * L'usager doit être interne et avoir le rôle ADMIN_SYSTEME sinon un code HTTP 403 est retourné.

===== Exemple de requête

include::{snippets}/put_modifierModeleDocument/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/put_modifierModeleDocument/http-response.adoc[]


[[services-banq-reference-modeleDocument-assignation]]
==== Obtenir un modèle de document pour une assignation à une acquisition

Service web pour obtenir l'un des modèles de document suivants pour une assignation à une acquisition à partir de l'identifiant de l'assignation :

 * 00004 - Notification à l'archiviste attitré au traitement d’une offre
 * 00006 - Notification de statut final pour le donateur

pass:q[<u>*Les préconditions*</u>] pour obtenir un modèle de document pour une assignation sont :

 * Un modèle de document doit exister selon le code fourni sinon un code HTTP 404 est retourné.
 * L'assignation doit exister selon l'identifiant fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/get_modeleDocumentPourAssignation/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_modeleDocumentPourAssignation/http-response.adoc[]


[[services-banq-reference-modeleDocument-offreAcquisition]]
==== Obtenir un modèle de document pour une offre d'acquisition

Service web pour obtenir l'un des modèles de document suivants pour une offre d'acquisition à partir de l'identifiant de l'acquisition associé à l'offre :

 * 00001 - Notification d'accusé de réception d’une offre au donateur
 * 00002 - Notification de la réception d'une offre de don au responsable du centre d'archives BAnQ
 * 00003 - Notification de la réception d'une offre de don réaffectée au responsable du centre d'archives BAnQ réaffecté
 * 00007 - Notification de l'enregistrement d’une nouvelle acquisition à la DGAN

pass:q[<u>*Les préconditions*</u>] pour obtenir un modèle de document pour une offre sont :

 * Un modèle de document doit exister selon le code fourni sinon un code HTTP 404 est retourné.
 * L'offre d'acquisition doit exister selon l'identifiant de l'acquisition fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/get_modeleDocumentPourOffreAcquisition/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_modeleDocumentPourOffreAcquisition/http-response.adoc[]


[[services-banq-reference-modeleDocument-versementPublique]]
==== Obtenir un modèle de document pour un versement publique

Service web pour obtenir l'un des modèles de document suivants pour un versement à partir de l'identifiant de l'acquisition associé au versement :

 * 00008 - Notification d'une recommandation de transfert d'un versement au responsable de l'organisme
 * 00009 - Notification de la réception d'un versement au responsable du centre d'archives BAnQ
 * 00010 - Notification de la réception d'un versement au responsable de l'organisme
 * 00011 - Notification modifications nécessaires à une demande de versement au responsable de l'organisme
 * 00012 - Notification suite aux modifications demandées d'un versement au responsable du centre BAnQ

pass:q[<u>*Les préconditions*</u>] pour obtenir un modèle de document pour un versement sont :

 * Un modèle de document doit exister selon le code fourni sinon un code HTTP 404 est retourné.
 * Le versement doit exister selon l'identifiant de l'acquisition fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/get_modeleDocumentPourVersementPublique/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_modeleDocumentPourVersementPublique/http-response.adoc[]


[[services-banq-reference-modeleDocument-demandeRestriction]]
==== Obtenir un modèle de document pour une demande de restriction

Service web pour obtenir l'un des modèles de document suivants pour une demande de restriction à partir de l'identifiant :

 * 00013 - Notification pour une nouvelle demande de création d'une restriction à l'analyste restriction
 * 00014 - Notification pour une nouvelle demande de modification d'une restriction à l'analyste restriction
 * 00015 - Notification pour l'acceptation d'une demande de création d'une restriction au demandeur
 * 00016 - Notification pour l'acceptation d'une demande de modification d'une restriction au demandeur
 * 00017 - Notification pour le refus d'une demande de création d'une restriction au demandeur
 * 00018 - Notification pour le refus d'une demande de modification d'une restriction au demandeur

pass:q[<u>*Les préconditions*</u>] pour obtenir un modèle de document pour une demande de restriction sont :

 * Un modèle de document doit exister selon le code fourni sinon un code HTTP 404 est retourné.
 * La demande de restriction doit exister selon l'identifiant fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/get_modeleDocumentPourDemandeRestriction/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_modeleDocumentPourDemandeRestriction/http-response.adoc[]


[[services-banq-reference-municipalite]]
=== Municipalité

Les services Web pour les municipalités permettent :

 * <<services-banq-reference-municipalite-obtenirListe>>
 * <<services-banq-reference-municipalite-obtenir>>

[[services-banq-reference-municipalite-obtenirListe]]
==== Obtenir les municipalités

===== Exemple de requête

include::{snippets}/get_municipalites/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_municipalites/http-response.adoc[]


[[services-banq-reference-municipalite-obtenir]]
==== Obtenir une municipalité à partir de son code

pass:q[<u>*La précondition*</u>] pour obtenir une municipalité est :

 * Une municipalité doit exister selon le code fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/get_municipalite/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_municipalite/http-response.adoc[]


[[services-banq-commun-organisme]]
=== Organisme

Les services Web pour les organismes permettent :

 * <<services-banq-commun-organisme-obtenirListe>>
 * <<services-banq-commun-organisme-obtenir>>

[[services-banq-commun-organisme-obtenirListe]]
==== Obtenir les organismes

===== Exemple de requête

include::{snippets}/get_organismes/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_organismes/http-response.adoc[]


[[services-banq-commun-organisme-obtenir]]
==== Obtenir un organisme à partir de son identifiant

pass:q[<u>*La précondition*</u>] pour obtenir un organisme est :

 * Un organisme doit exister selon l'identifiant fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/get_organismeById/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_organismeById/http-response.adoc[]


[[services-banq-reference-province]]
=== Province

Les services Web pour les provinces permettent :

 * <<services-banq-reference-province-obtenirListe>>
 * <<services-banq-reference-province-obtenir>>

[[services-banq-reference-province-obtenirListe]]
==== Obtenir les provinces

===== Exemple de requête

include::{snippets}/get_provinces/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_provinces/http-response.adoc[]


[[services-banq-reference-province-obtenir]]
==== Obtenir une province à partir de son code

pass:q[<u>*La précondition*</u>] pour obtenir une province est :

 * Une province doit exister selon le code fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/get_province/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_province/http-response.adoc[]


[[services-banq-reference-regionAdmin]]
=== Région administrative

Les services Web pour les régions administratives permettent :

 * <<services-banq-reference-regionAdmin-obtenirListe>>
 * <<services-banq-reference-regionAdmin-obtenir>>

[[services-banq-reference-regionAdmin-obtenirListe]]
==== Obtenir les régions administratives

===== Exemple de requête

include::{snippets}/get_regionsAdmins/http-request.adoc[]

ou depuis le portail :

include::{snippets}/get_regionsAdminsExt/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_regionsAdmins/http-response.adoc[]


[[services-banq-reference-regionAdmin-obtenir]]
==== Obtenir une région administrative à partir de son code

pass:q[<u>*La précondition*</u>] pour obtenir une région administrative est :

 * Une région administrative doit exister selon le code fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/get_regionAdmin/http-request.adoc[]

ou depuis le portail :

include::{snippets}/get_regionAdminExt/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_regionAdmin/http-response.adoc[]


[[services-banq-commun-regle]]
=== Règle

Les services Web pour les règles de conservation permettent :

 * <<services-banq-commun-regle-obtenirListe>>
 * <<services-banq-commun-regle-obtenir>>

[[services-banq-commun-regle-obtenirListe]]
==== Obtenir les règles de conservation d'un organisme

pass:q[<u>*La précondition*</u>] pour obtenir une règle de conservation est :

 * Une règle de conservation doit exister selon l'identifiant de l'organisme fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/get_ReglesByIdOrganisme/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_ReglesByIdOrganisme/http-response.adoc[]


[[services-banq-commun-regle-obtenir]]
==== Obtenir une règle de conservation à partir de son identifiant

pass:q[<u>*La précondition*</u>] pour obtenir une règle de conservation est :

 * Une règle de conservation doit exister selon l'identifiant fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/get_RegleById/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_RegleById/http-response.adoc[]


[[services-banq-commun-supportConsultation]]
=== Support de consultation

Les services Web pour les supports de consultations permettent :

 * <<services-banq-commun-supportConsultation-obtenirListe>>
 * <<services-banq-commun-supportConsultation-obtenir>>

[[services-banq-commun-supportConsultation-obtenirListe]]
==== Obtenir les supports de consultations

===== Exemple de requête

include::{snippets}/get_supportsConsultation/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_supportsConsultation/http-response.adoc[]


[[services-banq-commun-supportConsultation-obtenir]]
==== Obtenir un support de consultation à partir de son code

pass:q[<u>*La précondition*</u>] pour obtenir un support de consultation est :

 * Un support de consultation doit exister selon le code fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/get_supportConsultation/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_supportConsultation/http-response.adoc[]


[[services-pistard]]
== Services Web REST Advitam Acquisition et Traitement

Les ressources suivantes sont disponibles avec les services Web REST *Advitam Acquisition et Traitement* :

 * Pour la gestion des fonds d'archives (services Web communs aux archives privées et publiques) :
 ** <<services-pistard-commun-typeClasseFonds>>
 ** <<services-pistard-commun-classeFonds>>
 ** <<services-pistard-commun-fonds>>
 ** <<services-pistard-commun-localisation>>
 ** <<services-pistard-commun-preference-equipementConservation>>
 ** <<services-pistard-traitement-uniteDescription>>
 ** <<services-pistard-traitement-typeMessageControleUniteDescription>>
 ** <<services-pistard-traitement-codeMessageControleUniteDescription>>
 ** <<services-pistard-traitement-messageControleUniteDescription>>
 ** <<services-pistard-traitement-contenuFonds>>
 ** <<services-pistard-traitement-facette>>
 ** <<services-pistard-traitement-termeFacette>>
 ** <<services-pistard-traitement-instrumentRecherche>>
 ** <<services-pistard-traitement-ligneCollationGenreSpecifique>>
 ** <<services-pistard-traitement-preference-caracteristiqueMaterielle>>
 ** <<services-pistard-traitement-preference-critereDocumentPrecieux>>
 ** <<services-pistard-traitement-preference-etatPhysique>>
 ** <<services-pistard-traitement-preference-moyenIntervention>>
 ** <<services-pistard-traitement-typeCategorieTermeIndexation>>
 ** <<services-pistard-traitement-typeRepertoireTermeIndexation>>
 ** <<services-pistard-traitement-termeIndexation>>

 * Pour la gestion des acquisitions (services Web communs aux archives privées et publiques) :
 ** <<services-pistard-commun-acquisition>>
 ** <<services-pistard-commun-acquisition-assignation>>
 ** <<services-pistard-commun-acquisition-contenant>>
 ** <<services-pistard-commun-acquisition-noteSuivi>>

 * Pour la gestion des acquisitions pour les archives privées :
 ** <<services-pistard-acquisition-privee-offreAcquisition>>

 * Pour la gestion des acquisitions pour les archives publiques :
 ** <<services-pistard-acquisition-publique-versement>>
 ** <<services-pistard-acquisition-publique-contenant>>
 ** <<services-pistard-acquisition-publique-restrictionsAdmissibles>>
 ** <<services-pistard-acquisition-publique-document-dos>>
 ** <<services-pistard-acquisition-publique-document-reg>>
 ** <<services-pistard-acquisition-publique-document-ajd>>
 ** <<services-pistard-acquisition-publique-document-djd>>
 ** <<services-pistard-acquisition-publique-document-cjd>>
 ** <<services-pistard-acquisition-publique-document-rjd>>
 
 * Pour la gestion des restrictions :
 ** <<services-pistard-categorieRestriction>>
 ** <<services-pistard-typeDuree>>
 ** <<services-pistard-demandeRestriction>>
 ** <<services-pistard-restriction>>
 ** <<services-pistard-restrictionAppliquee>>
 

[[services-pistard-commun-typeClasseFonds]]
=== Type de classe de fonds

Le service web pour les types de classe de fonds permet :

 * <<services-pistard-commun-typeClasseFonds-liste>>

[[services-pistard-commun-typeClasseFonds-liste]]
==== Obtenir les types de classes de fonds

===== Exemple de requête

Avec un usager authentifié :

include::{snippets}/get_typeClassesFonds/http-request.adoc[]

Ou de façon anonyme (externe) :

include::{snippets}/get_typeClassesFondsExt/http-request.adoc[]

===== Exemple de réponse

Avec un usager authentifié :

include::{snippets}/get_typeClassesFonds/http-response.adoc[]

Ou de façon anonyme (externe) :

include::{snippets}/get_typeClassesFondsExt/http-response.adoc[]


[[services-pistard-commun-classeFonds]]
=== Classe de fonds

Les services Web pour les classes de fonds permettent :

 * <<services-pistard-commun-classeFonds-obtenirListe>>
 * <<services-pistard-commun-classeFonds-chercher>>
 * <<services-pistard-commun-classeFonds-obtenir>>

[[services-pistard-commun-classeFonds-obtenirListe]]
==== Obtenir les classes de fonds

===== Exemple de requête

Avec un usager authentifié :

include::{snippets}/get_classesFonds/http-request.adoc[]

Ou de façon anonyme (externe) :

include::{snippets}/get_classesFondsExt/http-request.adoc[]

===== Exemple de réponse

Avec un usager authentifié :

include::{snippets}/get_classesFonds/http-response.adoc[]

Ou de façon anonyme (externe) :

include::{snippets}/get_classesFondsExt/http-response.adoc[]


[[services-pistard-commun-classeFonds-chercher]]
==== Chercher des classes de fonds

Le service web pour rechercher les classes de fonds permet :

 * <<services-pistard-commun-classeFonds-chercher-typeClasse>>
 * <<services-pistard-commun-classeFonds-chercher-typesClasse>>
 * <<services-pistard-commun-classeFonds-chercher-typeVersement>>

[[services-pistard-commun-classeFonds-chercher-typeClasse]]
===== Chercher des classes de fonds selon un type de classe de fonds

Le service web recherche les classes de fonds selon un des types de classe de fonds (Voir <<services-pistard-commun-typeClasseFonds-liste>>).

====== Exemple de requête

Avec un usager authentifié :

include::{snippets}/filtrer_classesFonds_typeClasse_GOUV/http-request.adoc[]

Ou de façon anonyme (externe) :

include::{snippets}/filtrer_classesFondsExt_typeClasse_GOUV/http-request.adoc[]

====== Exemple de réponse

Avec un usager authentifié :

include::{snippets}/filtrer_classesFonds_typeClasse_GOUV/http-response.adoc[]

Ou de façon anonyme (externe) :

include::{snippets}/filtrer_classesFondsExt_typeClasse_GOUV/http-response.adoc[]


[[services-pistard-commun-classeFonds-chercher-typesClasse]]
===== Chercher des classes de fonds selon une liste de types de classe de fonds

Le service web recherche les classes de fonds selon une liste de types de classe de fonds (Voir <<services-pistard-commun-typeClasseFonds-liste>>).

====== Exemple de requête

Avec un usager authentifié :

include::{snippets}/filtrer_classesFonds_typesClasse/http-request.adoc[]

Ou de façon anonyme (externe) :

include::{snippets}/filtrer_classesFondsExt_typesClasse/http-request.adoc[]

====== Exemple de réponse

Avec un usager authentifié :

include::{snippets}/filtrer_classesFonds_typesClasse/http-response.adoc[]

Ou de façon anonyme (externe) :

include::{snippets}/filtrer_classesFondsExt_typesClasse/http-response.adoc[]


[[services-pistard-commun-classeFonds-chercher-typeVersement]]
===== Chercher des classes de fonds selon un type de versement

Le service web pour rechercher les classes de fonds selon un des types de versement suivants :

 * GOUV - Gourvernemental
 * CIVI - Directeur de l'état civil
 * COUR - Cour municipale
 * JUDI - Tribunal provincial

====== Exemple de requête

include::{snippets}/filtrer_classesFonds_typeVersement_GOUV/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/filtrer_classesFonds_typeVersement_GOUV/http-response.adoc[]


[[services-pistard-commun-classeFonds-obtenir]]
==== Obtenir une classe de fonds

pass:q[<u>*La précondition*</u>] pour obtenir une classe de fonds est :

 * Une classe de fonds doit exister selon l'identifiant fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/get_classeFonds/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_classeFonds/http-response.adoc[]


[[services-pistard-commun-fonds]]
=== Fonds d'archives

Les services Web pour les fonds d'archives permettent :

 * <<services-pistard-commun-fonds-chercher>>
 * <<services-pistard-commun-fonds-obtenir>>
 * <<services-pistard-commun-fonds-creer-archivesprivees>>
 * <<services-pistard-commun-fonds-creer-archivespubliques>>
 * <<services-pistard-commun-fonds-copier-archivespubliques>>
 * <<services-pistard-commun-fonds-modifier>>

[[services-pistard-commun-fonds-chercher]]
==== Chercher des fonds d'archives

La liste des fonds est triée par ordre croissant sur la côte de fonds (classe + numéro de fonds).

===== Exemple de requête

include::{snippets}/post_chercherFonds/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/post_chercherFonds/http-response.adoc[]


[[services-pistard-commun-fonds-obtenir]]
==== Obtenir un fonds d'archives

pass:q[<u>*La précondition*</u>] pour obtenir un fonds d'archives est :

 * Un fonds d'archives doit exister selon l'identifiant fourni sinon un code HTTP 404 est retourné.
 
===== Exemple de requête

include::{snippets}/get_obtenirFonds/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_obtenirFonds/http-response.adoc[]


[[services-pistard-commun-fonds-creer-archivesprivees]]
==== Créer un fonds pour les archives privées

Pour les archives privées, le numéro de fonds est attribué automatiquement lors de la création.

Une unité de description de type 'F - Fonds' est créée en même temps que la création du fonds.

pass:q[<u>*Les préconditions*</u>] pour créer un fonds pour les archives privées sont :

 * L'usager interne doit être archiviste (PROFESSIONNEL) ou coordonnateur (COORDONNATEUR) sinon un code HTTP 403 est retourné.
 * Un centre d'archives doit exister selon le code fourni sinon un code HTTP 404 est retourné.
 * L'usager interne doit être autorisé au niveau du centre d'archives demandé sinon un code HTTP 400 est retourné.
 * Une classe de fonds doit exister selon le code fourni sinon un code HTTP 404 est retourné.
 * Le nouveau titre du fonds ne doit pas exister au niveau d'un autre fonds du centre d'archives sinon un code HTTP 409 est retourné.
 * Une acquisition doit exister pour chaque numéro fourni dans le centre d'archives sinon un code HTTP 412 est retourné.

Si l'une des acquisitions fournies n'est pas encore enregistrée, on ne fait que l'ignorer.

===== Exemple de requête

include::{snippets}/post_creerFonds_ArchivesPrivees/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/post_creerFonds_ArchivesPrivees/http-response.adoc[]


[[services-pistard-commun-fonds-creer-archivespubliques]]
==== Créer un fonds pour les archives publiques

Pour les archives publiques, le numéro de fonds est attribué automatiquement lors de la création.

Une unité de description de type 'F - Fonds' est créée avec les informations fournies.

pass:q[<u>*Les préconditions*</u>] pour créer un fonds pour les archives publiques sont :

 * L'usager interne doit être archiviste (PROFESSIONNEL) ou coordonnateur (COORDONNATEUR) sinon un code HTTP 403 est retourné.
 * Un centre d'archives doit exister selon le code fourni sinon un code HTTP 404 est retourné.
 * L'usager interne doit être autorisé au niveau du centre d'archives demandé sinon un code HTTP 400 est retourné.
 * Une classe de fonds doit exister selon le code fourni sinon un code HTTP 404 est retourné.
 * Le nouveau titre du fonds ne doit pas exister au niveau d'un autre fonds du centre d'archives sinon un code HTTP 409 est retourné.
 * Une acquisition doit exister pour chaque numéro fourni dans le centre d'archives sinon un code HTTP 412 est retourné.

Si l'une des acquisitions fournies n'est pas encore enregistrée, on ne fait que l'ignorer.

===== Exemple de requête

include::{snippets}/post_creerFonds_ArchivesPubliques/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/post_creerFonds_ArchivesPubliques/http-response.adoc[]


[[services-pistard-commun-fonds-copier-archivespubliques]]
==== Copier un fonds pour les archives publiques

Pour les archives publiques, il est possible de copier un fonds existant dans un autre centre d'archives.

Une unité de description de type 'F - Fonds' est créée pour le nouveau centre d'archives avec les mêmes informations suivantes :

 * Le code de classe de fonds
 * Le numéro du fonds
 * Le titre propre
 * L'histoire administrative / Notice biographique

pass:q[<u>*Les préconditions*</u>] pour copier un fonds pour les archives publiques sont :

 * L'usager interne doit être archiviste (PROFESSIONNEL) ou coordonnateur (COORDONNATEUR) sinon un code HTTP 403 est retourné.
 * Un centre d'archives doit exister selon le code fourni sinon un code HTTP 404 est retourné.
 * L'usager interne doit être autorisé au niveau du centre d'archives demandé sinon un code HTTP 400 est retourné.
 * Un fonds doit exister selon l'identifiant fourni sinon un code HTTP 404 est retourné.
 * Le fonds ne doit pas d'une classe de fonds du type 'PRIV - Privé' sinon un code HTTP 412 est retourné.
 * Une acquisition doit exister pour chaque numéro fourni dans le centre d'archives sinon un code HTTP 412 est retourné.

Si l'une des acquisitions fournies n'est pas encore enregistrée, on ne fait que l'ignorer.

===== Exemple de requête

include::{snippets}/post_copierFonds_ArchivesPubliques/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/post_copierFonds_ArchivesPubliques/http-response.adoc[]


[[services-pistard-commun-fonds-modifier]]
==== Modifier un fonds d'archives

En plus de modifier le titre du fonds, le sysème met aussi à jour le titre propre de l'unité de description de type 'F - Fonds' associé au fonds.

pass:q[<u>*Les préconditions*</u>] pour créer un fonds pour les archives publiques sont :

 * L'usager interne doit être archiviste (PROFESSIONNEL) ou coordonnateur (COORDONNATEUR) sinon un code HTTP 403 est retourné.
 * Un fonds doit exister selon l'identifiant fourni sinon un code HTTP 404 est retourné.
 * Le nouveau titre du fonds ne doit pas exister au niveau d'un autre fonds du centre d'archives sinon un code HTTP 409 est retourné.

===== Exemple de requête

include::{snippets}/put_modifierFonds/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/put_modifierFonds/http-response.adoc[]


[[services-pistard-commun-localisation]]
=== Espace de conservation

Les services Web pour les espaces de conservation permettent :

 * <<services-pistard-commun-localisation-obtenirListePourCentreArchive>>
 * <<services-pistard-commun-localisation-obtenirListePourLocalisationParent>>
 * <<services-pistard-commun-localisation-chercherTablettes>>
 * <<services-pistard-commun-localisation-chercherEspacesLibres>>
 * <<services-pistard-commun-localisation-obtenir>>
 * <<services-pistard-commun-localisation-creer>>
 * <<services-pistard-commun-localisation-modifier>>
 * <<services-pistard-commun-localisation-supprimer>>
 * <<services-pistard-commun-localisation-chargerSolr>>
 * <<services-pistard-commun-localisation-annulerChargementSolr>>
 * <<services-pistard-commun-localisation-statutChargementSolr>>

Voici les types d'espace de conservation *typeLocalisation* selon l'ordre hiérarchique :

 * MAG - Magasin
 * SEC - Section
 * RAN - Rangée
 * ETA - Étagère
 * TAB - Tablette

Voici les informations ajoutées au niveau de la liste des quantités des localisations enfants *qteLocalisationsEnfants* :

 * Pour un magasin (MAG), on retourne la quantité de sections (SEC) et de rangées (RAN).
 * Pour une section (SEC), on retourne la quantité de rangées (RAN) et d'étagères (ETA).
 * Pour une rangée (RAN), on retourne la quantité de d'étagères (ETA) et de tablettes (TAB). 
 * Pour une étagère (ETA), on retourne la quantité de tablettes (TAB).
 * Pour une tablette (TAB), on retourne la quantité d'espaces occupés par un contenant (OCC) et d'espaces libres pour localiser un contenant (LIB).

[[services-pistard-commun-localisation-obtenirListePourCentreArchive]]
==== Obtenir les magasins d'un centre d'archives

===== Exemple de requête

include::{snippets}/post_filtrerLocalisations_pourCentreArchive/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/post_filtrerLocalisations_pourCentreArchive/http-response.adoc[]


[[services-pistard-commun-localisation-obtenirListePourLocalisationParent]]
==== Obtenir les espaces de conservation enfants d'un parent

===== Exemple de requête

include::{snippets}/post_filtrerLocalisations_pourLocalisationParent/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/post_filtrerLocalisations_pourLocalisationParent/http-response.adoc[]


[[services-pistard-commun-localisation-chercherTablettes]]
==== Chercher des tablettes pour un centre d'archives

Les résultats de recherche proviennent de Solr et ils sont classés par facette.

Voici le nom des champs possibles pour les critères de recherche :

 * typeLocalisation - Type de localisation - Doit toujours être égale à TAB pour rechercher des tablettes dans Solr.
 * codeCentreArchive - Code du centres d'archives (Champ Solr: codeCentreArchive)
 * noMagasin - Numéro du magasin (Champ Solr: noMagasin)
 * codeSection - Code de section (Champ Solr: codeSection)
 * noRangee - Numéro de rangée (Champ Solr: noRangee)
 * noEtagere - Numéro d'étagère (Champ Solr: noEtagere)
 * noTablette - Numéro de tablette (Champ Solr: noTablette)
 * codeEquipementConservation - Code d'équipement de conservation (Champ Solr: codeEquipementConservation)
 * largeur - Largeur de la tablette (Champ Solr: largeur)
 * hauteur - Hauteur de la tablette (Champ Solr: hauteur)
 * profondeur - Profondeur de la tablette (Champ Solr: profondeur)
 * particularites (Champ Solr: particularitesNettoye)
 * indEspaceLibre (Champ Solr: indEspaceLibre)
 
Voici le nom des champs possibles pour trier les résultats de recherche :

 * adresseLocalisation - L'adresse de localisation de la tablette - Ce champ personnalisé au niveau du Backend est utilisé pour un tri ascendant par défaut sur les champs suivants : noMagasin, codeSection, noRangee, noEtagere et noTablette.
 * noMagasin - Numéro du magasin
 * codeSection - Code de section
 * noRangee - Code de section
 * noEtagere - Numéro d'étagère
 * noTablette - Numéro de tablette
 * codeEquipementConservation - Code d'équipement de conservation
 * largeur - Largeur de la tablette
 * hauteur - Hauteur de la tablette
 * profondeur - Profondeur de la tablette
 * nbrContenants - Nombre de contenants

===== Exemple de requête

include::{snippets}/post_filtrerLocalisations_rechercherTablettes/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/post_filtrerLocalisations_rechercherTablettes/http-response.adoc[]


[[services-pistard-commun-localisation-chercherEspacesLibres]]
==== Chercher des espaces libres pour un centre d'archives

Les résultats de recherche proviennent de Solr et ils sont classés par facette.

Voici le nom des champs possibles pour les critères de recherche :

 * typeLocalisation - Type de localisation - Doit toujours être égale à LIB pour rechercher des espaces libres dans Solr.
 * codeCentreArchive - Code du centres d'archives (Champ Solr: codeCentreArchive)
 * noMagasin - Numéro du magasin (Champ Solr: noMagasin)
 * codeSection - Code de section (Champ Solr: codeSection)
 * noRangee - Numéro de rangée (Champ Solr: noRangee)
 * noEtagere - Numéro d'étagère (Champ Solr: noEtagere)
 * noTablette - Numéro de tablette (Champ Solr: noTablette)
 * codeEquipementConservation - Code d'équipement de conservation (Champ Solr: codeEquipementConservation)
 * largeur - Largeur de l'espace libre (Champ Solr: largeur)
 * hauteur - Hauteur de l'espace libre (Champ Solr: hauteur)
 * profondeur - Profondeur de l'espace libre (Champ Solr: profondeur)
 
Voici le nom des champs possibles pour trier les résultats de recherche :

 * adresseLocalisation - L'adresse de localisation de l'espace libre - Ce champ personnalisé au niveau du Backend est utilisé pour un tri ascendant par défaut sur les champs suivants : noMagasin, codeSection, noRangee, noEtagere, noTablette et codeEspace où le codeEspace contient les champs suivants dans cet ordre typePosition, position et niveau forçant ainsi un tri selon le type de position A/B avant la position.
 * noMagasin - Numéro du magasin
 * codeSection - Code de section
 * noRangee - Code de section
 * noEtagere - Numéro d'étagère
 * noTablette - Numéro de tablette
 * codeEspace - Code de l'espace libre
 * codeEquipementConservation - Code d'équipement de conservation
 * dimensions - Les dimensions de l'espace libre - Ce champ personnalisé au niveau du Backend est utilisé pour un tri sur les champs suivants : largeur, hauteur, profondeur
 * largeur - Largeur de l'espace libre
 * hauteur - Hauteur de l'espace libre
 * profondeur - Profondeur de l'espace libre
 * capaciteNbrContenantsPossibles - Capacité de l'espace libre - Ce champ personnalisé au niveau du Backend est utilisé pour un tri sur volumeEspaceLibre.

===== Exemple de requête

include::{snippets}/post_filtrerLocalisations_rechercherEspacesLibres_pasClassesParTablette/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/post_filtrerLocalisations_rechercherEspacesLibres_pasClassesParTablette/http-response.adoc[]

Si la recherche d'espaces libres fournie une largeur, mais pas de hauteur, on force l'ajout d'un critère de recherche pour obtenir seulement les espaces libres de niveau 01.

Si la recherche d'espaces libres fournie une largeur, mais pas de profondeur ou que la profondeur recherchée est plus que les 2/3 de la profondeur de la tablette d'uun espace libre trouvé, on force l'espace libre au Bord seulement si la profondeur de l'espace libre est la même que celle de la tablette, c'est-à-dire que l'espace au Bord est aussi libre.

[[services-pistard-commun-localisation-obtenir]]
==== Obtenir un espace de conservation

Avec ce service, en plus d'obtenir les informations de l'espace de conservation représenté par un objet de type *Localisation*, voici deux propriétés qui sont initialisées :

 - *localisationsParent* : Liste des localisations parent en ordre. Par exemple, pour une tablette, cette liste contiendra les parents de celle-ci soit le magasin, la section, la rangée et l'étagère.
 - *indLocalisationUtilisee* : Indicateur qui est initialisé à *true* pour une tablette, si elle n'est pas vide (associée à au moins un contenant) et pour les localisations d'un autre type, si elles ont au moins une localisation enfant.

pass:q[<u>*La précondition*</u>] pour obtenir un espace de conservation est :

 * Un espace de conservation doit exister selon l'identifiant fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/get_obtenirLocalisation/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_obtenirLocalisation/http-response.adoc[]


[[services-pistard-commun-localisation-creer]]
==== Créer un espace de conservation

Le service web de création d'un espace de conservation permet :

 * <<services-pistard-commun-localisation-creer-magasin>>
 * <<services-pistard-commun-localisation-creer-section>>
 * <<services-pistard-commun-localisation-creer-rangee>>
 * <<services-pistard-commun-localisation-creer-etagere>>
 * <<services-pistard-commun-localisation-creer-tablette>>

pass:q[<u>*La précondition*</u>] pour créer un espace de conservation est :

 * L'usager interne doit être responsable des espaces de conservation (RESPONSABLE_ESPACES) sinon un code HTTP 403 est retourné.

[[services-pistard-commun-localisation-creer-magasin]]
===== Créer un espace de conservation de type Magasin

Un espace de conservation de type 'MAG - Magasin' est créé pour un centre d'archives.

====== Exemple de requête

include::{snippets}/post_creerLocalisation_typeMagasin/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/post_creerLocalisation_typeMagasin/http-response.adoc[]

[[services-pistard-commun-localisation-creer-section]]
===== Créer un espace de conservation de type Section

Un espace de conservation de type 'SEC - Section' est créé pour un magasin.

====== Exemple de requête

include::{snippets}/post_creerLocalisation_typeSection/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/post_creerLocalisation_typeSection/http-response.adoc[]

[[services-pistard-commun-localisation-creer-rangee]]
===== Créer un espace de conservation de type Rangée

Un espace de conservation de type 'RAN - Rangée' est créé pour une section.

====== Exemple de requête

include::{snippets}/post_creerLocalisation_typeRangee/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/post_creerLocalisation_typeRangee/http-response.adoc[]

[[services-pistard-commun-localisation-creer-etagere]]
===== Créer un espace de conservation de type Étagère

Un espace de conservation de type 'ETA - Étagère' est créé pour une rangée.

====== Exemple de requête

include::{snippets}/post_creerLocalisation_typeEtagere/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/post_creerLocalisation_typeEtagere/http-response.adoc[]

[[services-pistard-commun-localisation-creer-tablette]]
===== Créer un espace de conservation de type Tablette

Un espace de conservation de type 'TAB - Tablette' est créé pour une rangée.

====== Exemple de requête

include::{snippets}/post_creerLocalisation_typeTablette/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/post_creerLocalisation_typeTablette/http-response.adoc[]


[[services-pistard-commun-localisation-modifier]]
==== Modifier un espace de conservation
 
pass:q[<u>*Les préconditions*</u>] pour modifier un espace de conservation sont :

 * L'usager interne doit être responsable des espaces de conservation (RESPONSABLE_ESPACES) sinon un code HTTP 403 est retourné.
 * Un espace de conservation doit exister avec l'identifiant fourni sinon un code HTTP 404 est retourné.
 * Pour un espace de conservation de type 'TAB - Tablette', les dimensions de la tablette doivent respecter les dimensions des contenants localisés sinon un code HTTP 409 est retourné.

===== Exemple de requête

include::{snippets}/put_modifierLocalisation/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/put_modifierLocalisation/http-response.adoc[]


[[services-pistard-commun-localisation-supprimer]]
==== Supprimer un espace de conservation
 
pass:q[<u>*Les préconditions*</u>] pour supprimer un espace de conservation sont :

 * L'usager interne doit être responsable des espaces de conservation (RESPONSABLE_ESPACES) sinon un code HTTP 403 est retourné.
 * Un espace de conservation doit exister avec l'identifiant fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/delete_supprimerLocalisation/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/delete_supprimerLocalisation/http-response.adoc[]


[[services-pistard-commun-localisation-chargerSolr]]
==== Charger dans Solr les informations des tablettes

Le service web de chargement des tablettes dans Solr permet :

 * <<services-pistard-commun-localisation-chargerSolr-localisation>>
 * <<services-pistard-commun-localisation-chargerSolr-unCentreArchives>>
 * <<services-pistard-commun-localisation-chargerSolr-tousLesCentresArchives>>

pass:q[<u>*La précondition*</u>] pour charger les tablettes dans Solr est :

 * L'usager interne doit être administrateur système (ADMIN_SYSTEME) sinon un code HTTP 403 est retourné.

Les paramètres dans le lien pour lancer le chargement des informations des unités dans Solr sont les suivants :
 - Le code du centre d'archives
 - Le type de chargement *UN* pour un seul centre d'archives ou *TOUS* pour tous les centres d'archives à partir du centre d'archives selon le code fourni

Il est ainsi possible de lancer le chargement des informations des tablettes dans Solr pour un seul ou tous les centre d'archives. Le premier centre d'archives dans la liste des centres d'archives triée selon leur nom ascendant est '07H - BAnQ Gatineau'.

[[services-pistard-commun-localisation-chargerSolr-localisation]]
===== Charger dans Solr les informations d'une tablette ou des tablettes d'un espace de conservation

====== Exemple de requête

include::{snippets}/put_chargerLocalisationSolr/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/put_chargerLocalisationSolr/http-response.adoc[]

[[services-pistard-commun-localisation-chargerSolr-unCentreArchives]]
===== Charger dans Solr les informations des tablettes d'un centre d'archives

====== Exemple de requête

include::{snippets}/put_chargerLocalisationsSolr_pourUnCentreArchives/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/put_chargerLocalisationsSolr_pourUnCentreArchives/http-response.adoc[]

[[services-pistard-commun-localisation-chargerSolr-tousLesCentresArchives]]
===== Charger dans Solr les informations des tablettes de tous les centres d'archives

====== Exemple de requête

include::{snippets}/put_chargerLocalisationsSolr_pourTousLesCentresArchives/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/put_chargerLocalisationsSolr_pourTousLesCentresArchives/http-response.adoc[]


[[services-pistard-commun-localisation-annulerChargementSolr]]
==== Annuler le chargement dans Solr des informations des tablettes

===== Exemple de requête

include::{snippets}/delete_chargerLocalisationsSolrAnnuler/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/delete_chargerLocalisationsSolrAnnuler/http-response.adoc[]


[[services-pistard-commun-localisation-statutChargementSolr]]
==== Obtenir le statut de chargement dans Solr des informations des tablettes

===== Exemple de requête

include::{snippets}/get_chargerLocalisationsSolrStatut/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_chargerLocalisationsSolrStatut/http-response.adoc[]


[[services-pistard-commun-preference-equipementConservation]]
=== Préférence d'équipement de conservation

Les services WEB pour les préférences d'équipement de conservation permettent :

 * <<services-pistard-commun-preference-equipementConservation-obtenirListe>>
 * <<services-pistard-commun-preference-equipementConservation-obtenir>>

[[services-pistard-commun-preference-equipementConservation-obtenirListe]]
==== Obtenir les préférences d'équipement de conservation selon un type d'espace de conservation

Actuellement, il y a des espaces de conservation seulement pour les tablettes (TAB).

===== Exemple de requête

include::{snippets}/get_obtenirPreferencesEquipementConservation/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_obtenirPreferencesEquipementConservation/http-response.adoc[]


[[services-pistard-commun-preference-equipementConservation-obtenir]]
==== Obtenir une préférence d'équipement de conservation à partir de son identifiant

pass:q[<u>*La précondition*</u>] pour obtenir une préférence d'équipement de conservation est :

 * Une préférence d'équipement de conservation doit exister selon l'identifiant fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/get_obtenirPreferenceEquipementConservation/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_obtenirPreferenceEquipementConservation/http-response.adoc[]


[[services-pistard-traitement-uniteDescription]]
=== Unité de description

Les services Web pour les unités de description permettent :

 * <<services-pistard-traitement-uniteDescription-chercher>>
 * <<services-pistard-traitement-uniteDescription-obtenir>>
 * <<services-pistard-traitement-uniteDescription-creer>>
 * <<services-pistard-traitement-uniteDescription-modifier>>
 * <<services-pistard-traitement-uniteDescription-supprimer>>
 * <<services-pistard-traitement-uniteDescription-changerStatut>>
 * <<services-pistard-traitement-uniteDescription-modifierZoneRDDA>>
 * <<services-pistard-traitement-uniteDescription-modifierZoneRDDACollation>>
 * <<services-pistard-traitement-uniteDescription-associerTermeFacette>>
 * <<services-pistard-traitement-uniteDescription-dissocierTermeFacette>>
 * <<services-pistard-traitement-uniteDescription-associerInstrumentRecherche>>
 * <<services-pistard-traitement-uniteDescription-dissocierInstrumentRecherche>>
 * <<services-pistard-traitement-uniteDescription-creerDocumentInteret>>
 * <<services-pistard-traitement-uniteDescription-modifierDocumentInteret>>
 * <<services-pistard-traitement-uniteDescription-supprimerDocumentInteret>>
 * <<services-pistard-traitement-uniteDescription-modifierConditionUtilisation>>
 * <<services-pistard-traitement-uniteDescription-modifierEtatConservation>>
 * <<services-pistard-traitement-uniteDescription-obtenirTermesIndexationProposes>>
 * <<services-pistard-traitement-uniteDescription-obtenirTermesIndexationRattaches>>
 * <<services-pistard-traitement-uniteDescription-rattacherTermeIndexation>>
 * <<services-pistard-traitement-uniteDescription-detacherTermeIndexation>>
 * <<services-pistard-traitement-uniteDescription-validerTermesIndexationNonControles>>
 * <<services-pistard-traitement-uniteDescription-filtrerAcquisitionsAssociees>>
 * <<services-pistard-traitement-uniteDescription-associerAcquisition>>
 * <<services-pistard-traitement-uniteDescription-dissocierAcquisition>>
 * <<services-pistard-traitement-uniteDescription-chargerSolr>>
 * <<services-pistard-traitement-uniteDescription-annulerChargementSolr>>
 * <<services-pistard-traitement-uniteDescription-statutChargementSolr>>

Voici les types d'unité *typeUnite* possibles pour les unités de description :

 * F - Fonds
 * S - Série
 * SS - Sous-série
 * SSS - Sous-sous-série
 * D - Dossier
 * P - Pièce

Voici les codes de statut d'unité possibles pour les unités de description :

 * ENTRT : En traitement
 * TRT : Traitée
 * DIF : Diffusée

Voici les types de section *typeSection* possibles pour les sections des unités de description :

 * ZONE_RDDA - Pour les zones avec des champs RDDA.
 * ZONE_RDDA_COLLATION - Pour la zone avec les informations RDDA de collation.

Voici les types de zone *typeZone* possibles pour les zones des unités de description :

 * TITRE - Zone RDDA 1 - Zone du titre et de la mention de responsabilité
 * PUBLICATION - Zone RDDA 4 - Zone des dates de création
 * COLLATION - Zone RDDA 5 - Zone de la collation
 * DESCRIPTION - Zone RDDA 7 - Zone de la description des documents d'archives 
 * NOTE - Zone RDDA 8 - Zone des notes
 
Voici les types d'affichage *typeAffichage* possibles pour les champs des unités de description :

 * OBL - Obligatoire - Valeur affichée et obligatoire en modification
 * FAC - Facultatif - Valeur affichée et optionnelle en modification
 * LEC - Lecture - Valeur affichée et non modifiable
 * ND - Non-disponible - Valeur pas affichée

Voici les types de champ *typeChamp* possibles pour les champs des unités de description :

 * CLO - Clob - La valeur d'un champ de format Clob sera enregistrée et fournie dans le champ valeurChampCLO.
 * DAT - Date - La valeur d'un champ de format Date sera enregistrée et fournie dans le champ valeurChampDAT.
 * NUM - Numérique - La valeur d'un champ de format Numérique sera enregistrée et fournie dans le champ valeurChampNUM.
 * TXT - Texte - La valeur d'un champ de format Numérique sera enregistrée et fournie dans le champ valeurChampTXT.

Voici les niveaux de restriction possibles pour les unités de description :

 * AUCUNE_RESTRICTION
 * RESTRICTION_PARTIELLE
 * RESTRICTION_COMPLETE


[[services-pistard-traitement-uniteDescription-chercher]]
==== Chercher des unités de description

Le service web de recherche des unités de description permet :

 * <<services-pistard-traitement-uniteDescription-chercher-modifiables>>
 * <<services-pistard-traitement-uniteDescription-chercher-dernieresFondsModifies>>
 * <<services-pistard-traitement-uniteDescription-chercher-dernieresUnitesModifiees>>
 * <<services-pistard-traitement-uniteDescription-chercher-listeFondsPourCentresArchives>>
 * <<services-pistard-traitement-uniteDescription-chercher-listeFondsPourTypesClasseFonds>>
 * <<services-pistard-traitement-uniteDescription-chercher-listeFondsPourClassesFonds>>
 * <<services-pistard-traitement-uniteDescription-chercher-pourFonds>>
 * <<services-pistard-traitement-uniteDescription-chercher-pourFondsEtTypeUnite>>
 * <<services-pistard-traitement-uniteDescription-chercher-pourParent>>
 * <<services-pistard-traitement-uniteDescription-chercher-dansUnFonds>>
 * <<services-pistard-traitement-uniteDescription-chercher-avancee>>

[[services-pistard-traitement-uniteDescription-chercher-modifiables]]
===== Obtenir toutes les unités de description modifiables

====== Exemple de requête

include::{snippets}/post_filtrerUniteDescription_modifiableSeulement/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/post_filtrerUniteDescription_modifiableSeulement/http-response.adoc[]

[[services-pistard-traitement-uniteDescription-chercher-dernieresFondsModifies]]
===== Obtenir les derniers fonds modifiés par l'employé

====== Exemple de requête

include::{snippets}/post_filtrerUniteDescription_derniersFondsModifies/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/post_filtrerUniteDescription_derniersFondsModifies/http-response.adoc[]

[[services-pistard-traitement-uniteDescription-chercher-dernieresUnitesModifiees]]
===== Obtenir les dernières unités de description modifiées par l'employé

====== Exemple de requête

include::{snippets}/post_filtrerUniteDescription_dernieresUnitesModifiees/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/post_filtrerUniteDescription_dernieresUnitesModifiees/http-response.adoc[]

[[services-pistard-traitement-uniteDescription-chercher-listeFondsPourCentresArchives]]
===== Obtenir toutes les unités de description de type Fonds pour une liste de centres d'archives

====== Exemple de requête

include::{snippets}/post_filtrerUniteDescription_listeFondsPourCentresArchives/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/post_filtrerUniteDescription_listeFondsPourCentresArchives/http-response.adoc[]

[[services-pistard-traitement-uniteDescription-chercher-listeFondsPourTypesClasseFonds]]
===== Obtenir toutes les unités de description de type Fonds pour une liste de types de classe de fonds

====== Exemple de requête

include::{snippets}/post_filtrerUniteDescription_listeFondsPourTypesClasseFonds/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/post_filtrerUniteDescription_listeFondsPourTypesClasseFonds/http-response.adoc[]

[[services-pistard-traitement-uniteDescription-chercher-listeFondsPourClassesFonds]]
===== Obtenir toutes les unités de description de type Fonds pour une liste de classes de fonds

====== Exemple de requête

include::{snippets}/post_filtrerUniteDescription_listeFondsPourClassesFonds/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/post_filtrerUniteDescription_listeFondsPourClassesFonds/http-response.adoc[]

[[services-pistard-traitement-uniteDescription-chercher-pourFonds]]
===== Obtenir toutes les unités de description dans un fonds d'un centre d'archives

====== Exemple de requête

include::{snippets}/post_filtrerUniteDescription_pourFonds/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/post_filtrerUniteDescription_pourFonds/http-response.adoc[]

[[services-pistard-traitement-uniteDescription-chercher-pourFondsEtTypeUnite]]
===== Obtenir toutes les unités de description d'un type d'unité d'un parent 

====== Exemple de requête

include::{snippets}/post_filtrerUniteDescription_pourParentEtTypeUnite_obtenirSeries/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/post_filtrerUniteDescription_pourParentEtTypeUnite_obtenirSeries/http-response.adoc[]

[[services-pistard-traitement-uniteDescription-chercher-pourParent]]
===== Obtenir toutes les unités de description d'un parent

====== Exemple de requête

include::{snippets}/post_filtrerUniteDescription_pourParent/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/post_filtrerUniteDescription_pourParent/http-response.adoc[]

[[services-pistard-traitement-uniteDescription-chercher-dansUnFonds]]
===== Chercher les unités de description dans un fonds

====== Exemple de requête

include::{snippets}/post_filtrerUniteDescription_dansUnFonds/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/post_filtrerUniteDescription_dansUnFonds/http-response.adoc[]

[[services-pistard-traitement-uniteDescription-chercher-avancee]]
===== Chercher les unités de description avec différents critères (recherche avancée)

Voici le nom des champs possibles pour les critères de recherche :

 * indUnitesModifiablesSeulement - Indicateur pour obtenir seulement les unités modifiables par l'usager
 * indUnitesModifieesSeulement - Indicateur pour obtenir seulement les unités modifiées par l'usager
 * idUniteDescription - Identifiant de l'unité de description (Champ Solr: id)
 ** Les espaces sont enlevés de la valeur recherchée.
 * typesUnite - Les codes de l'un des types de l'unité (Champ Solr: typeUnite)
 * typeUnite - Le code du type de l'unité (Champ Solr: typeUnite)
 * statutUnite - Le code du statut de l'unité (Champ Solr: statutUnite)
 * niveauRestrictionUnite - Le code du niveau de restriction de l'unité (Champ Solr: niveauRestrictionUnite)
 * codesCentreArchive - Les codes de l'un des centres d'archives de l'unité (Champ Solr: codeCentreArchive)
 * typesClasseFonds - Les codes de l'un des types de classes de fonds de l'unité (Champ Solr: typeClasseFonds)
 * codesClasseFonds - Les codes de l'une des classes de fonds de l'unité (Champ Solr: codeClasseFonds)
 * codeClasseFonds - Le code de classe de fonds de l'unité (Champ Solr: codeClasseFonds)
 * noFonds - Le numéro du fonds de l'unité (Champ Solr: noFonds)
 * idUniteParent - Identifiant de l'unité parent (Champ Solr: idUniteParent)
 * coteComplete - La cote complète de l'unité (Champ Solr: coteComplete)
 ** Les espaces sont enlevés de la valeur recherchée.
 ** La valeur recherchée est forcée en majuscule.
 ** Si l'opération de recherche 'EGALE_A' est effectuée, un critère en 'OU' est ajouté sur la cote complète afin d'inclure les descendants de l'unité de description trouvée.
 ** Si l'opération de recherche 'COTE_INFERIEUR' est effectuée, une recherche 'EGALE_A' est effectuée avec un critère en 'OU' sur la cote complète afin d'inclure les descendants de l'unité de description trouvée.
 * coteAncienne - L'ancienne cote BAnQ (Champ Solr: coteAncienne)
 ** La valeur recherchée est nettoyée si la recherche floue n'est pas activée.
 * titrePropre - Les champs 'Titre propre' et 'Compléments du titre' de la Zone RDDA 1 concaténés et séparés par un espace (Champ Solr: titrePropreNettoye)
 ** La valeur recherchée est nettoyée si la recherche floue n'est pas activée.
 * mentionResponsabilite - Le champ 'Mentions de responsabilité' de la Zone RDDA 1 (Champ Solr: mentionResponsabiliteNettoye)
 ** La valeur recherchée est nettoyée si la recherche floue n'est pas activée.
 * porteeEtContenu - Le champ 'Portée et contenu' de la Zone RDDA 7 (Champ Solr: porteeEtContenuNettoye)
 ** La valeur recherchée est nettoyée si la recherche floue n'est pas activée.
 * histoireAdministrativeNoticeBiographique - Le champ 'Histoire administrative / Notice biographique' de la Zone RDDA 7 (Champ Solr: histoireAdministrativeNoticeBiographiqueNettoye)
 ** La valeur recherchée est nettoyée si la recherche floue n'est pas activée.
 * historiqueConservation - Le champ 'Historique de la conservation' de la Zone RDDA 7 (Champ Solr: historiqueConservationNettoye)
 ** La valeur recherchée est nettoyée si la recherche floue n'est pas activée.
 * zoneNoteVarianteTitrePropre - Le champ 'Variantes du titre propre' de la Zone RDDA 8 (Champ Solr: zoneNoteVarianteTitrePropreNettoye)
 ** La valeur recherchée est nettoyée si la recherche floue n'est pas activée.
 * zoneNoteMentionResponsabilite - Le champ 'Mentions de responsabilité' de la Zone RDDA 8 (Champ Solr: zoneNoteMentionResponsabiliteNettoye)
 ** La valeur recherchée est nettoyée si la recherche floue n'est pas activée.
 * zoneNoteCollation - Le champ 'Collation' de la Zone RDDA 8 (Champ Solr: zoneNoteCollationNettoye)
 ** La valeur recherchée est nettoyée si la recherche floue n'est pas activée.
 * zoneNoteEtatConservation - Le champ 'État de conservation' de la Zone RDDA 8 (Champ Solr: zoneNoteEtatConservationNettoye)
 ** La valeur recherchée est nettoyée si la recherche floue n'est pas activée.
 * zoneNoteRestauration - Le champ 'Restauration' de la Zone RDDA 8 (Champ Solr: zoneNoteRestaurationNettoye)
 ** La valeur recherchée est nettoyée si la recherche floue n'est pas activée.
 * zoneNoteClassement - Le champ 'Classement' de la Zone RDDA 8 (Champ Solr: zoneNoteClassementNettoye)
 ** La valeur recherchée est nettoyée si la recherche floue n'est pas activée.
 * zoneNoteLangueDocument - Le champ 'Langue des documents' de la Zone RDDA 8 (Champ Solr: zoneNoteLangueDocumentNettoye)
 ** La valeur recherchée est nettoyée si la recherche floue n'est pas activée.
 * zoneNoteAutreFormat - Le champ 'Autres formats' de la Zone RDDA 8 (Champ Solr: zoneNoteAutreFormatNettoye)
 ** La valeur recherchée est nettoyée si la recherche floue n'est pas activée.
 * zoneNoteDocumentConnexe - Le champ 'Documents connexes' de la Zone RDDA 8 (Champ Solr: zoneNoteDocumentConnexeNettoye)
 ** La valeur recherchée est nettoyée si la recherche floue n'est pas activée.
 * zoneNoteSourceComplementaire - Le champ 'Sources complémentaires' de la Zone RDDA 8 (Champ Solr: zoneNoteSourceComplementaireNettoye)
 ** La valeur recherchée est nettoyée si la recherche floue n'est pas activée.
 * zoneNoteNumeroOrigine - Le champ 'Numéro d’origine' de la Zone RDDA 8 (Champ Solr: zoneNoteNumeroOrigineNettoye)
 ** La valeur recherchée est nettoyée si la recherche floue n'est pas activée.
 * zoneNoteNoteGenerale - Le champ 'Notes générales' de la Zone RDDA 8 (Champ Solr: zoneNoteNoteGeneraleNettoye)
 ** La valeur recherchée est nettoyée si la recherche floue n'est pas activée.
 * jourDateDebutExtreme - Le jour de la date de début extrême (Champ Solr: jourDateDebutExtreme)
 * moisDateDebutExtreme - Le mois de la date de début extrême (Champ Solr: moisDateDebutExtreme)
 * anneeDateDebutExtreme - L'année de la date de début extrême (Champ Solr: anneeDateDebutExtreme)
 * jourDateFinExtreme - Le jour de la date de fin extrême (Champ Solr: jourDateFinExtreme)
 * moisDateFinExtreme - Le mois de la date de fin extrême (Champ Solr: moisDateFinExtreme)
 * anneeDateFinExtreme - L'année de la date de fin extrême (Champ Solr: anneeDateFinExtreme)
 * genresGeneraux - Les codes des genres généraux associés à l'unité (Champ Solr: genresGeneraux)
 * genresSpecifiques - Les codes des genres spécifiques associés à l'unité (Champ Solr: genresSpecifiques)
 * termeIndexationSujet - Un terme d'indexation de type 'Sujet' associé à l'unité (Champ Solr: termesIndexationSujet)
 ** La recherche est effectuée pour un seul terme d'indexation de type 'Sujet' associé à l'unité.
 * termeIndexationLieu - Un terme d'indexation de type 'Lieu' associé à l'unité (Champ Solr: termesIndexationLieu)
 ** La recherche est effectuée pour un seul terme d'indexation de type 'Lieu' associé à l'unité.
 * termeIndexationAuteur - Un terme d'indexation de type 'Auteur' associé à l'unité (Champ Solr: termesIndexationAuteur)
 ** La recherche est effectuée pour un seul terme d'indexation de type 'Auteur' associé à l'unité.
 * termeIndexationRefuse - Un terme d'indexation refusé associé à l'unité (Champ Solr: termesIndexationRefuses)
 ** La recherche est effectuée pour un seul terme d'indexation refusé associé à l'unité.
 * facetteArchivistique - La facette archivistique associée à l'unité (champ Solr: facettesArchivistiques)
 * termeFacetteArchivistique - Le terme de facette archivistique associé à l'unité (champ Solr: termesFacetteArchivistiques)
 * sousTermeFacetteArchivistique - Le sous-terme (aussi nommé terme inférieur) de facette archivistique associé à l'unité (champ Solr: sousTermesFacetteArchivistiques)
 * noAcquisitionAssociee - Un numéro d'une acquisition dans le format 'aaaa-mm-jj' associée à l'unité (Champ Solr: noAcquisitionsAssociees)
 ** La recherche est effectuée pour un seul numéro d'acquisition associée à l'unité.
 ** Les tirets sont enlevés de la valeur recherchée.
 * noContenantAssocie - Un numéro d'un contenant associé à l'unité avec le numéro d'acquisition dans le format 'aaaa-mm-jj \ {noContenant}' (Champ Solr: noContenantsAssocies)
 ** La recherche est effectuée pour un seul numéro de contenant associé à l'unité.
 ** Les tirets, le backslash et les espaces sont enlevés de la valeur recherchée.
 ** Un underscore est ajouté avant et après le numéro de contenant recherché.
 * indiceReperageContenus - L'indice de repérage des contenus associés à l'unité (Champ Solr: indiceReperageContenusNettoye)
 ** La valeur recherchée est nettoyée si la recherche floue n'est pas activée.
 * texte - Le texte recherché dans le champ accumulateur de plusieurs champs (Champ Solr: textNettoye - Ce champ contient la valeur des champs Solr suivants : titrePropreAvecComplementNettoye, mentionResponsabiliteNettoye, porteeEtContenuNettoye, histoireAdministrativeNoticeBiographiqueNettoye, historiqueConservationNettoye, zoneNoteVarianteTitrePropreNettoye, zoneNoteMentionResponsabiliteNettoye, zoneNoteCollationNettoye, zoneNoteEtatConservationNettoye, zoneNoteRestaurationNettoye, zoneNoteClassementNettoye, zoneNoteLangueDocumentNettoye, zoneNoteAutreFormatNettoye, zoneNoteDocumentConnexeNettoye, zoneNoteSourceComplementaireNettoye, zoneNoteNumeroOrigineNettoye, zoneNoteNoteGeneraleNettoye, indiceReperageContenusNettoye)
 ** La valeur recherchée est nettoyée si la recherche floue n'est pas activée.

Voici les types d'opérations de recherche possibles pour les critères de recherche selon les cas :

  * COMMENCE_PAR - Un des mots commence par une valeur recherchée ou si plusieurs valeurs sont recherchées, un des mots du champ commence par la première valeur recherchée et toutes les valeurs recherchée sont contenues dans le champ.
  * CONTIENT_AUCUN_DES_MOTS - Le champ contient aucun des mots. Ce type d'opération de recherche active la recherche floue.
  * CONTIENT_EXPRESSION_EXACTE - Le champ contient exactement la valeur recherchée ou si plusieurs valeurs sont recherchées, le champ contient exactement dans l'ordre les valeurs recherchées.
  * CONTIENT_TOUS_LES_MOTS - Le champ contient exactement la valeur recherchée ou si plusieurs valeurs sont recherchées, le champ contient chaque valeur recherchée peu importe leur ordre. Ce type d'opération de recherche active la recherche floue.
  * EGALE_A - Le champ correspond exactement à la valeur recherchée.
  * NE_CONTIENT_PAS_EXPRESSION - Le champ ne contient pas la valeur recherchée ou si plusieurs valeurs sont recherchées, le champ ne contient pas dans l'ordre les valeurs recherchées.
  * TERMINE_PAR - Un des mots se termine par une valeur recherchée ou si plusieurs valeurs est recherchée, un des mots du champ se termine par la première valeur recherchée et toutes les valeurs recherchée sont contenues dans le champ.

Voici le nom des champs possibles pour trier les résultats de recherche :

 * coteComplete - Le champ coteComplete est dans Solr, mais le tri n'est pas fait sur ce champ. Il est plutôt configuré au niveau du Backend pour utiliser un tri ascendant par défaut au niveau des champs Solr suivants : nomCentreArchive, codeClasseFonds, noFonds, positionSerie, positionSousSerie, positionSousSousSerie, positionDossier et positionPiece.
 * datesExtremes - Le champ datesExtremes dans Solr contient les dates extrêmes de l'unité dans le format 'aaaa-mm-jj à aaaa-mm-jj' s'il y a des dates sinon il contient 'Aucune date'.
 * idUnitePourTri - Le champ id dans Solr contient l'identifiant de l'unité de description, mais le tri est fait avec la valeur numérique de l'identifiant avec le champ Solr idUnitePourTri.
 * titreProprePourTri - Le champ titreProprePourTri de type string dans Solr contient le 'Titre propre' de la Zone RDDA 1 nettoyé pour permettre le tri.
 * statutUnite - Le champ statutUnite dans Solr contient le code du statut de l'unité de description.
 * niveauRestrictionUnite - Le champ niveauRestrictionUnite dans Solr contient le niveau de restriction de l'unité de description.

La mention 'Nettoyé' au niveau de la valeur d'un champ signifie que la valeur est modifiée pour effectuer les changements suivants :

 * Remplacer les caractères avec des accents par leur caractère correspondant sans accent
 * Mettre la valeur en minuscule
 * Remplacer les caractères qui ne sont pas un espace, un chiffre ou une lettre par un espace
 * Enlever les espaces double tant qu'il en reste au niveau de la valeur

====== Exemple de requête

include::{snippets}/post_filtrerUniteDescription_avecCriteres/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/post_filtrerUniteDescription_avecCriteres/http-response.adoc[]


[[services-pistard-traitement-uniteDescription-creer]]
==== Créer une unité de description

Le service web pour créer une unité de description permet :

 * <<services-pistard-traitement-uniteDescription-creer-sansCoteManuelle>>
 * <<services-pistard-traitement-uniteDescription-creer-avecCoteManuelle>>

pass:q[<u>*Les préconditions*</u>] pour créer une unité de description sont :

 * L'usager interne doit être archiviste (PROFESSIONNEL) ou soutien (SOUTIEN) et être autorisé à modifier l'unité sinon un code HTTP 403 est retourné.
 * Une acquisition doit exister pour chaque numéro fourni dans le centre d'archives sinon un code HTTP 412 est retourné.

Si l'une des acquisitions fournies n'est pas encore enregistrée, on ne fait que l'ignorer.

[[services-pistard-traitement-uniteDescription-creer-sansCoteManuelle]]
===== Créer une unité de description sans cote manuelle

====== Exemple de requête

include::{snippets}/post_creerUniteDescription/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/post_creerUniteDescription/http-response.adoc[]

[[services-pistard-traitement-uniteDescription-creer-avecCoteManuelle]]
===== Créer une unité de description avec une cote manuelle

pass:q[<u>*Les préconditions*</u>] pour créer une unité de description avec une cote manuelle sont :

 * L'usager interne doit être archiviste (PROFESSIONNEL) ou soutien (SOUTIEN) et être autorisé à modifier l'unité sinon un code HTTP 403 est retourné.
 * La cote manuelle fournie ne doit pas exister pour une autre unité de description au même niveau et du même type sinon un code HTTP 412 est retourné.
 * La cote manuelle doit contenir seulement des caractères permis (les lettres sans accent, les chiffres, le point, le plus, le trait d'union, la barre oblique et le souligné) sinon un code HTTP 412 est retourné.

====== Exemple de requête

include::{snippets}/post_creerUniteDescription_avecCoteManuelle/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/post_creerUniteDescription_avecCoteManuelle/http-response.adoc[]


[[services-pistard-traitement-uniteDescription-obtenir]]
==== Obtenir une unité de description à partir de son identifiant

pass:q[<u>*La précondition*</u>] pour obtenir une unité de description est :

 * Une unité de description doit exister selon l'identifiant fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/get_obtenirUniteDescription/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_obtenirUniteDescription/http-response.adoc[]


[[services-pistard-traitement-uniteDescription-modifier]]
==== Modifier une unité de description

Le service web pour modifier une unité de description permet :

 * <<services-pistard-traitement-uniteDescription-modifier-sansCoteManuelle>>
 * <<services-pistard-traitement-uniteDescription-modifier-avecCoteManuelle>>
 * <<services-pistard-traitement-uniteDescription-modifier-typeFonds>>

pass:q[<u>*Les préconditions*</u>] pour modifier une unité de description sont :

 * L'usager interne doit être archiviste (PROFESSIONNEL) ou soutien (SOUTIEN) et être autorisé à modifier l'unité sinon un code HTTP 403 est retourné.
 * L'unité de description doit exister avec l'identifiant fourni sinon un code HTTP 404 est retourné.
 * Si les modifications demandées provoque un changement à une autre unité de description qui n'est en traitement un code HTTP 412 est retourné.

[[services-pistard-traitement-uniteDescription-modifier-sansCoteManuelle]]
===== Modifier une unité de description sans cote manuelle

pass:q[<u>*Les préconditions*</u>] pour modifier une unité de description sans cote manuelle sont :

 * L'usager interne doit être archiviste (PROFESSIONNEL) ou soutien (SOUTIEN) et être autorisé à modifier l'unité sinon un code HTTP 403 est retourné.
 * L'unité de description doit exister avec l'identifiant fourni sinon un code HTTP 404 est retourné.
 * Si les modifications demandées provoque un changement à une autre unité de description qui n'est en traitement un code HTTP 412 est retourné.
 
====== Exemple de requête

include::{snippets}/put_modifierUniteDescription/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/put_modifierUniteDescription/http-response.adoc[]

[[services-pistard-traitement-uniteDescription-modifier-avecCoteManuelle]]
===== Modifier une unité de description avec une cote manuelle

pass:q[<u>*Les préconditions*</u>] pour modifier une unité de description avec une cote manuelle sont :

 * L'usager interne doit être archiviste (PROFESSIONNEL) ou soutien (SOUTIEN) et être autorisé à modifier l'unité sinon un code HTTP 403 est retourné.
 * L'unité de description doit exister avec l'identifiant fourni sinon un code HTTP 404 est retourné.
 * La cote manuelle fournie ne doit pas exister pour une autre unité de description au même niveau et du même type sinon un code HTTP 412 est retourné.
 * La cote manuelle doit contenir seulement des caractères permis (les lettres sans accent, les chiffres, le point, le plus, le trait d'union, la barre oblique et le souligné) sinon un code HTTP 412 est retourné.
 * Si les modifications demandées provoque un changement à une autre unité de description qui n'est en traitement un code HTTP 412 est retourné.

====== Exemple de requête

include::{snippets}/put_modifierUniteDescription_avecCoteManuelle/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/put_modifierUniteDescription_avecCoteManuelle/http-response.adoc[]

[[services-pistard-traitement-uniteDescription-modifier-typeFonds]]
===== Modifier une unité de description de type Fonds

Les seules informations modifiables pour une unité de description de type 'F - Fonds' sont la cote verseur et l'ancienne cote BAnQ (à ne pas confondre avec la cote précédente qui est gérée par la système afin d'y enregistrer la cote précédent un changement qui modifie la cote de l'unité).

pass:q[<u>*Les préconditions*</u>] pour modifier une unité de description de type Fonds sont :

 * L'usager interne doit être archiviste (PROFESSIONNEL) ou soutien (SOUTIEN) et être autorisé à modifier l'unité sinon un code HTTP 403 est retourné.
 * L'unité de description doit exister avec l'identifiant fourni sinon un code HTTP 404 est retourné.

====== Exemple de requête

include::{snippets}/put_modifierUniteDescription_typeFonds/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/put_modifierUniteDescription_typeFonds/http-response.adoc[]


[[services-pistard-traitement-uniteDescription-changerStatut]]
==== Changer le statut d'une unité de description

Le service web pour changer le statut d'une unité de description permet :

 * <<services-pistard-traitement-uniteDescription-changerStatut-traiter>>
 * <<services-pistard-traitement-uniteDescription-changerStatut-diffuser>>
 * <<services-pistard-traitement-uniteDescription-changerStatut-retirer>>
 * <<services-pistard-traitement-uniteDescription-changerStatut-modifier>>

pass:q[<u>*Les préconditions*</u>] pour changer le statut d'une unité de description sont :

 * L'usager interne doit être archiviste (PROFESSIONNEL) ou soutien (SOUTIEN) et être autorisé à modifier l'unité sinon un code HTTP 403 est retourné.
 * L'unité de description doit exister avec l'identifiant fourni sinon un code HTTP 404 est retourné.
 * L'unité de description doit avoir le statut 'ENTRT - En traitement' pour la traiter sinon un code HTTP 412 est retourné.
 * L'unité de description doit avoir le statut 'TRT - Traité' pour la diffuser sinon un code HTTP 412 est retourné.
 * L'unité de description doit avoir le statut 'DIF - Diffusé' pour retirer sa diffusion sinon un code HTTP 412 est retourné.
 * L'unité de description doit avoir le statut 'DIF - Diffusé' ou 'TRT - Traité' pour la modifier sinon un code HTTP 412 est retourné.
 * L'unité de description doit avoir aucune erreur de contrôle pour la traiter ou la diffuser sinon un code HTTP 412 est retourné.

[[services-pistard-traitement-uniteDescription-changerStatut-traiter]]
===== Changer le statut d'une unité de description pour la traiter

pass:q[<u>*Les préconditions*</u>] pour traiter une unité de description sont :

 * L'usager interne doit être archiviste (PROFESSIONNEL) ou soutien (SOUTIEN) et être autorisé à modifier l'unité sinon un code HTTP 403 est retourné.
 * L'unité de description doit exister avec l'identifiant fourni sinon un code HTTP 404 est retourné.
 * L'unité de description doit avoir le statut 'ENTRT - En traitement' pour la traiter sinon un code HTTP 412 est retourné.
 * L'unité de description doit avoir aucune erreur de contrôle pour la traiter ou la diffuser sinon un code HTTP 412 est retourné.

Avec ce changement de statut, l'unité de description passe de 'ENTRT - En traitement' à 'TRT - Traité'.

====== Exemple de requête

include::{snippets}/patch_changeStatutUniteDescription_actionTRAITER/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/patch_changeStatutUniteDescription_actionTRAITER/http-response.adoc[]

[[services-pistard-traitement-uniteDescription-changerStatut-diffuser]]
===== Changer le statut d'une unité de description pour la diffuser

pass:q[<u>*Les préconditions*</u>] pour diffuser une unité de description sont :

 * L'usager interne doit être archiviste (PROFESSIONNEL) ou soutien (SOUTIEN) et être autorisé à modifier l'unité sinon un code HTTP 403 est retourné.
 * L'unité de description doit exister avec l'identifiant fourni sinon un code HTTP 404 est retourné.
 * L'unité de description doit avoir le statut 'TRT - Traité' pour la diffuser sinon un code HTTP 412 est retourné.
 * L'unité de description doit avoir aucune erreur de contrôle pour la traiter ou la diffuser sinon un code HTTP 412 est retourné.

Avec ce changement de statut, l'unité de description passe de 'TRT - Traité' à 'DIF - Diffusé'.

====== Exemple de requête

include::{snippets}/patch_changeStatutUniteDescription_actionDIFFUSER/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/patch_changeStatutUniteDescription_actionDIFFUSER/http-response.adoc[]

[[services-pistard-traitement-uniteDescription-changerStatut-retirer]]
===== Changer le statut d'une unité de description pour retirer sa diffusion

pass:q[<u>*Les préconditions*</u>] pour retirer la diffusion d'une unité de description sont :

 * L'usager interne doit être archiviste (PROFESSIONNEL) ou soutien (SOUTIEN) et être autorisé à modifier l'unité sinon un code HTTP 403 est retourné.
 * L'unité de description doit exister avec l'identifiant fourni sinon un code HTTP 404 est retourné.
 * L'unité de description doit avoir le statut 'DIF - Diffusé' pour retirer sa diffusion sinon un code HTTP 412 est retourné.

Avec ce changement de statut, la diffusion de l'unité de description sera retirée et elle passe de 'DIF - Diffusé' à 'TRT - Traité'.

====== Exemple de requête

include::{snippets}/patch_changeStatutUniteDescription_actionRETIRER/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/patch_changeStatutUniteDescription_actionRETIRER/http-response.adoc[]

[[services-pistard-traitement-uniteDescription-changerStatut-modifier]]
===== Changer le statut d'une unité de description pour la modifier

pass:q[<u>*Les préconditions*</u>] pour modifier une unité de description sont :

 * L'usager interne doit être archiviste (PROFESSIONNEL) ou soutien (SOUTIEN) et être autorisé à modifier l'unité sinon un code HTTP 403 est retourné.
 * L'unité de description doit exister avec l'identifiant fourni sinon un code HTTP 404 est retourné.
 * L'unité de description doit avoir le statut 'DIF - Diffusé' ou 'TRT - Traité' pour la modifier sinon un code HTTP 412 est retourné.

Avec ce changement de statut, l'unité de description passe de 'DIF - Diffusé' ou de 'TRT - Traité' à 'ENTRT - En traitement'.

====== Exemple de requête

include::{snippets}/patch_changeStatutUniteDescription_actionMODIFIER_statutDIF/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/patch_changeStatutUniteDescription_actionMODIFIER_statutDIF/http-response.adoc[]


[[services-pistard-traitement-uniteDescription-supprimer]]
==== Supprimer une unité de description

pass:q[<u>*Les préconditions*</u>] pour modifier une unité de description sont :

 * L'usager interne doit être archiviste (PROFESSIONNEL) ou soutien (SOUTIEN) et être autorisé à modifier l'unité sinon un code HTTP 403 est retourné.
 * L'unité de description doit exister avec l'identifiant fourni sinon un code HTTP 404 est retourné.
 * L'unité ne doit pas contenir d'éléments sinon un code HTTP 412 est retourné.

===== Exemple de requête

include::{snippets}/delete_supprimerUniteDescription/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/delete_supprimerUniteDescription/http-response.adoc[]


[[services-pistard-traitement-uniteDescription-supprimer]]
==== Recoter les cotes des unités enfants d'une unité de description

pass:q[<u>*Les préconditions*</u>] pour recoter les cotes des unités enfants d'une unité de description sont :

 * L'usager interne doit être archiviste (PROFESSIONNEL) ou soutien (SOUTIEN) et être autorisé à modifier l'unité sinon un code HTTP 403 est retourné.
 * L'unité de description doit exister avec l'identifiant fourni sinon un code HTTP 404 est retourné.
 * La première et la dernière unité doivent être du même type et avoir le même parent que l'unité fournie dans le lien sinon un code HTTP 400 est retourné.

===== Exemple de requête

include::{snippets}/post_recoterUnitesEnfants/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/post_recoterUnitesEnfants/http-response.adoc[]


[[services-pistard-traitement-uniteDescription-modifierZoneRDDA]]
==== Modifier la valeur des champs RDDA d'une zone d'une unité de description

pass:q[<u>*Les préconditions*</u>] pour modifier la valeur des champs RDDA d'une zone d'une unité de description sont :

 * L'usager interne doit être archiviste (PROFESSIONNEL) ou soutien (SOUTIEN) et être autorisé à modifier l'unité sinon un code HTTP 403 est retourné.
 * L'unité de description doit exister avec l'identifiant fourni sinon un code HTTP 404 est retourné.
 * Si les modifications demandées provoque un changement à une autre unité de description qui n'est en traitement un code HTTP 412 est retourné.

===== Exemple de requête

include::{snippets}/put_modifierZoneRDDA1Titre/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/put_modifierZoneRDDA1Titre/http-response.adoc[]


[[services-pistard-traitement-uniteDescription-modifierZoneRDDACollation]]
==== Modifier les informations de la zone RDDA Collation d'une unité de description

pass:q[<u>*Les préconditions*</u>] pour modifier les informations de la zone RDDA Collation d'une unité de description sont :

 * L'usager interne doit être archiviste (PROFESSIONNEL) ou soutien (SOUTIEN) et être autorisé à modifier l'unité sinon un code HTTP 403 est retourné.
 * L'unité de description doit exister avec l'identifiant fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/put_modifierZoneRDDA5Collation/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/put_modifierZoneRDDA5Collation/http-response.adoc[]


[[services-pistard-traitement-uniteDescription-associerTermeFacette]]
==== Associer un terme de facette ou inférieur à une unité de description

pass:q[<u>*Les préconditions*</u>] pour associer un terme de facette ou inférieur à une unité de description sont :

 * L'usager interne doit être archiviste (PROFESSIONNEL) ou soutien (SOUTIEN) et être autorisé à modifier l'unité sinon un code HTTP 403 est retourné.
 * L'unité de description doit exister avec l'identifiant fourni sinon un code HTTP 404 est retourné.
 * Le terme de facette ou inférieur doit exister avec l'identifiant fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/patch_associerTermeFacetteAUniteDescription/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/patch_associerTermeFacetteAUniteDescription/http-response.adoc[]


[[services-pistard-traitement-uniteDescription-dissocierTermeFacette]]
==== Dissocier un terme de facette ou inférieur d'une unité de description

pass:q[<u>*Les préconditions*</u>] pour dissocier un terme de facette ou inférieur d'une unité de description sont :

 * L'usager interne doit être archiviste (PROFESSIONNEL) ou soutien (SOUTIEN) et être autorisé à modifier l'unité sinon un code HTTP 403 est retourné.
 * L'unité de description doit exister avec l'identifiant fourni sinon un code HTTP 404 est retourné.
 * Le terme de facette ou inférieur doit exister avec l'identifiant fourni sinon un code HTTP 404 est retourné.
 * Le terme de facette ou inférieur doit être associé à l'unité de description sinon un code HTTP 409 est retourné.

===== Exemple de requête

include::{snippets}/delete_dissocierTermeFacetteDeUniteDescription/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/delete_dissocierTermeFacetteDeUniteDescription/http-response.adoc[]


[[services-pistard-traitement-uniteDescription-associerInstrumentRecherche]]
==== Associer un instrument de recherche à une unité de description

pass:q[<u>*Les préconditions*</u>] pour associer un instrument de recherche à une unité de description sont :

 * L'usager interne doit être archiviste (PROFESSIONNEL) ou soutien (SOUTIEN) et être autorisé à modifier l'unité sinon un code HTTP 403 est retourné.
 * L'unité de description doit exister avec l'identifiant fourni sinon un code HTTP 404 est retourné.
 * L'instrument de recherche doit exister avec l'identifiant fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/patch_associerInstrumentRechercheAUniteDescription/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/patch_associerInstrumentRechercheAUniteDescription/http-response.adoc[]


[[services-pistard-traitement-uniteDescription-dissocierInstrumentRecherche]]
==== Dissocier un instrument de recherche d'une unité de description

pass:q[<u>*Les préconditions*</u>] pour dissocier un instrument de recherche d'une unité de description sont :

 * L'usager interne doit être archiviste (PROFESSIONNEL) ou soutien (SOUTIEN) et être autorisé à modifier l'unité sinon un code HTTP 403 est retourné.
 * L'unité de description doit exister avec l'identifiant fourni sinon un code HTTP 404 est retourné.
 * L'instrument de recherche doit exister avec l'identifiant fourni sinon un code HTTP 404 est retourné.
 * L'instrument de recherche doit être associé à l'unité de description sinon un code HTTP 409 est retourné.

===== Exemple de requête

include::{snippets}/delete_dissocierInstrumentRechercheDeUniteDescription/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/delete_dissocierInstrumentRechercheDeUniteDescription/http-response.adoc[]


[[services-pistard-traitement-uniteDescription-creerDocumentInteret]]
==== Créer un document d'intérêt pour une unité de description

pass:q[<u>*Les préconditions*</u>] pour créer un document d'intérêt pour une unité de description sont :

 * L'usager interne doit être archiviste (PROFESSIONNEL) ou soutien (SOUTIEN) et être autorisé à modifier l'unité sinon un code HTTP 403 est retourné.
 * L'unité de description doit exister avec l'identifiant fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/post_creerDocumentInteret/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/post_creerDocumentInteret/http-response.adoc[]


[[services-pistard-traitement-uniteDescription-modifierDocumentInteret]]
==== Modifier un document d'intérêt d'une unité de description

pass:q[<u>*Les préconditions*</u>] pour modifier un document d'intérêt d'une unité de description sont :

 * L'usager interne doit être archiviste (PROFESSIONNEL) ou soutien (SOUTIEN) et être autorisé à modifier l'unité sinon un code HTTP 403 est retourné.
 * L'unité de description doit exister avec l'identifiant fourni sinon un code HTTP 404 est retourné.
 * Le document d'intérêt à modifier doit être associé à l'unité de description sinon un code HTTP 412 est retourné.

===== Exemple de requête

include::{snippets}/put_modifierDocumentInteret/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/put_modifierDocumentInteret/http-response.adoc[]


[[services-pistard-traitement-uniteDescription-supprimerDocumentInteret]]
==== Supprimer un document d'intérêt d'une unité de description

pass:q[<u>*Les préconditions*</u>] pour supprimer un document d'intérêt d'une unité de description sont :

 * L'usager interne doit être archiviste (PROFESSIONNEL) ou soutien (SOUTIEN) et être autorisé à modifier l'unité sinon un code HTTP 403 est retourné.
 * L'unité de description doit exister avec l'identifiant fourni sinon un code HTTP 404 est retourné.
 * Le document d'intérêt à modifier doit être associé à l'unité de description sinon un code HTTP 412 est retourné.

===== Exemple de requête

include::{snippets}/delete_supprimerDocumentInteret/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/delete_supprimerDocumentInteret/http-response.adoc[]


[[services-pistard-traitement-uniteDescription-modifierConditionUtilisation]]
==== Modifier les informations des conditions d'utilisation d'une unité de description

pass:q[<u>*Les préconditions*</u>] pour modifier les informations des conditions d'utilisation d'une unité de description sont :

 * L'usager interne doit être archiviste (PROFESSIONNEL) ou soutien (SOUTIEN) et être autorisé à modifier l'unité sinon un code HTTP 403 est retourné.
 * L'unité de description doit exister avec l'identifiant fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/put_modifierConditionUtilisation/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/put_modifierConditionUtilisation/http-response.adoc[]


[[services-pistard-traitement-uniteDescription-modifierEtatConservation]]
==== Modifier l'état de conservation et de restauration d'une unité de description

pass:q[<u>*Les préconditions*</u>] pour modifier l'état de conservation et de restauration d'une unité de description sont :

 * L'usager interne doit être archiviste (PROFESSIONNEL) ou soutien (SOUTIEN) et être autorisé à modifier l'unité sinon un code HTTP 403 est retourné.
 * L'unité de description doit exister avec l'identifiant fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/put_modifierEtatConservation/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/put_modifierEtatConservation/http-response.adoc[]


[[services-pistard-traitement-uniteDescription-obtenirTermesIndexationProposes]]
==== Obtenir les termes d'indexation proposés pour une unité de description

pass:q[<u>*Les préconditions*</u>] pour obtenir les termes d'indexation proposés pour une unité de description sont :

 * L'usager interne doit être archiviste (PROFESSIONNEL) ou soutien (SOUTIEN) et être autorisé à modifier l'unité sinon un code HTTP 403 est retourné.
 * L'unité de description doit exister avec l'identifiant fourni sinon un code HTTP 404 est retourné.

Voici les valeurs possibles pour *typeZoneTexte* :

 - TITRE_PROPRE : Titre propre
 - MENTION_RESP : Mentions de responsabilité de la zone RDDA 1
 - NOTES_MENTION : Mentions de responsabilité de la zone RDDA 8
 - PORTEE_CONTENU : Portée et contenu

===== Exemple de requête

include::{snippets}/get_obtenirTermesIndexationProposes/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_obtenirTermesIndexationProposes/http-response.adoc[]


[[services-pistard-traitement-uniteDescription-obtenirTermesIndexationRattaches]]
==== Obtenir les termes d'indexation rattachés pour une unité de description

pass:q[<u>*Les préconditions*</u>] pour obtenir les termes d'indexation rattachés à une unité de description sont :

 * L'usager interne doit être archiviste (PROFESSIONNEL) ou soutien (SOUTIEN) et être autorisé à modifier l'unité sinon un code HTTP 403 est retourné.
 * L'unité de description doit exister avec l'identifiant fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/get_obtenirTermesIndexationRattaches/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_obtenirTermesIndexationRattaches/http-response.adoc[]


[[services-pistard-traitement-uniteDescription-rattacherTermeIndexation]]
==== Rattacher un terme d'indexation à une unité de description

pass:q[<u>*Les préconditions*</u>] pour rattacher un terme d'indexation à une unité de description sont :

 * L'usager interne doit être archiviste (PROFESSIONNEL) ou soutien (SOUTIEN) et être autorisé à modifier l'unité sinon un code HTTP 403 est retourné.
 * L'unité de description doit exister avec l'identifiant fourni sinon un code HTTP 404 est retourné.
 * Le terme d'indexation doit exister avec l'identifiant fourni sinon un code HTTP 404 est retourné.

En plus de rattacher un terme d'indexation à une unité de description, ce service web permet également de modifier le type d'attribut d'un terme déjà rattaché.

Voici les types d'attributs *typeAttribut* possibles :

 * SUJET
 * AUTEUR
 * PROVENANCE
 * AUTEUR_SUJET

===== Exemple de requête

include::{snippets}/patch_rattacherTermeIndexationAUniteDescription/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/patch_rattacherTermeIndexationAUniteDescription/http-response.adoc[]


[[services-pistard-traitement-uniteDescription-detacherTermeIndexation]]
==== Détacher un terme d'indexation d'une unité de description

pass:q[<u>*Les préconditions*</u>] pour détacher un terme d'indexation d'une unité de description sont :

 * L'usager interne doit être archiviste (PROFESSIONNEL) ou soutien (SOUTIEN) et être autorisé à modifier l'unité sinon un code HTTP 403 est retourné.
 * L'unité de description doit exister avec l'identifiant fourni sinon un code HTTP 404 est retourné.
 * Le terme d'indexation doit exister avec l'identifiant fourni sinon un code HTTP 404 est retourné.
 * Le terme d'indexation doit être rattaché à l'unité de description sinon un code HTTP 409 est retourné.

===== Exemple de requête

include::{snippets}/delete_detacherTermeIndexationDeUniteDescription/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/delete_detacherTermeIndexationDeUniteDescription/http-response.adoc[]


[[services-pistard-traitement-uniteDescription-validerTermesIndexationNonControles]]
==== Valider les termes d'indexation non controlés d'une unité de description

pass:q[<u>*Les préconditions*</u>] pour valider les termes d'indexation non controlés d'une unité de description sont :

 * L'usager interne doit être archiviste (PROFESSIONNEL) ou soutien (SOUTIEN) et être autorisé à modifier l'unité sinon un code HTTP 403 est retourné.
 * L'unité de description doit exister avec l'identifiant fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/patch_validerTermesIndexationNonControlles/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/patch_validerTermesIndexationNonControlles/http-response.adoc[]


[[services-pistard-traitement-uniteDescription-filtrerAcquisitionsAssociees]]
==== Filtrer les acquisitions associées à une unité de description

Ce service web permet de filtrer les acquisitions associées à une unité de description et par défaut les acquisitions associées aux unités inférieures ne sont pas considérées.

Si le paramètre optionnel *indToutLeFonds* est activé, le service retourne les acquisitions associées à toutes les unités de description du fonds de l'unité fournie et les acquisitions déjà associées à l'unité fournie sont exclues.

Si le paramètre optionel *indToutLeFonds* n'est pas activé, le service retourne les acquisitions associées à l'unité de description fournie et il est possible d'activer le paramêtre optionnel *indInclureUnitesInferieures* pour obtenir les acquisitions associées aux unités inférieures en plus de celles associées à l'unité fournie.

pass:q[<u>*La précondition*</u>] pour filtrer les acquisitions associées à une unité de description est :

 * L'unité de description doit exister avec l'identifiant fourni sinon un code HTTP 404 est retourné.

Voici le nom des champs à utiliser pour demander un tri pour l'une des colonnes dans la liste des acquisitions associées à une unité de description :

 * noAcquisition : Nom pour demander un tri pour la colonne 'No d'acquisition'. Le tri par défaut est descendant sur ce champ.
 * titreAcquisition : Nom pour demander un tri pour la colonne 'Titre / organisme'.
 * libelleStatutAcquisition : Nom pour demander un tri pour la colonne 'Statut'.
 * typeRattachement : Nom pour demander un tri pour la colonne 'Type de rattachement'.

===== Exemple de requête

include::{snippets}/post_filtrerAcquisitionsAssociees/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/post_filtrerAcquisitionsAssociees/http-response.adoc[]


[[services-pistard-traitement-uniteDescription-associerAcquisition]]
==== Associer une ou plusieurs acquisitions à une unité de description

pass:q[<u>*Les préconditions*</u>] pour associer une ou plusieurs acquisitions à une unité de description sont :

 * L'usager interne doit être archiviste (PROFESSIONNEL) ou soutien (SOUTIEN) et être autorisé à modifier l'unité sinon un code HTTP 403 est retourné.
 * L'unité de description doit exister avec l'identifiant fourni sinon un code HTTP 404 est retourné.
 * Une acquisition doit exister pour chaque identifiant fourni sinon un code HTTP 404 est retourné.

Si l'une des acquisitions fournies est déjà associée à l'unité de description ou si elle n'est pas au moins enregistrée, on ne fait que l'ignorer.

===== Exemple de requête

include::{snippets}/patch_associerAcquisitionsAUniteDescription/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/patch_associerAcquisitionsAUniteDescription/http-response.adoc[]


[[services-pistard-traitement-uniteDescription-dissocierAcquisition]]
==== Dissocier une ou plusieurs acquisitions d'une unité de description

pass:q[<u>*Les préconditions*</u>] pour dissocier une ou plusieurs acquisitions d'une unité de description sont :

 * L'usager interne doit être archiviste (PROFESSIONNEL) ou soutien (SOUTIEN) et être autorisé à modifier l'unité sinon un code HTTP 403 est retourné.
 * L'unité de description doit exister avec l'identifiant fourni sinon un code HTTP 404 est retourné.
 * Une acquisition doit exister pour chaque identifiant fourni sinon un code HTTP 404 est retourné.
 * L'unité de description ne doit pas avoir de contenu dans un contenant de l'acquisition à dissocier sinon un code HTTP 412 est retourné.

Si l'une des acquisitions fournies est déjà dissociée de l'unité de description, on ne fait que l'ignorer.

===== Exemple de requête

include::{snippets}/delete_dissocierAcquisitionsDeUniteDescription/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/delete_dissocierAcquisitionsDeUniteDescription/http-response.adoc[]


[[services-pistard-traitement-uniteDescription-chargerSolr]]
==== Charger ou synchroniser dans la collection Solr Pistard Arc les informations des unités de description

Le service web de chargement des unités de description dans Solr permet :

 * <<services-pistard-traitement-uniteDescription-chargerSolr-unite>>
 * <<services-pistard-traitement-uniteDescription-chargerSolr-unCentreArchives>>
 * <<services-pistard-traitement-uniteDescription-chargerSolr-tousLesCentresArchives>>

pass:q[<u>*La précondition*</u>] pour charger les unités de description dans Solr est :

 * L'usager interne doit être administrateur système (ADMIN_SYSTEME) sinon un code HTTP 403 est retourné.

Les paramètres dans le lien pour lancer le chargement dans la collection Solr Pistard Arc ou la synchronisation des informations des unités avec la base de données sont les suivants :

 - Le code du centre d'archives
 - Le numéro de la page des résultats de recherche pour le centre d'archives à 1000 résultats par page
 - Le type de chargement :

 -- *CHARGER_UN* pour charger les informations des unités d'un seul centre d'archives
 -- *CHARGER_TOUS* pour charger les informations des unités de tous les centres d'archives
 -- *SYNCHRONISER_UN* pour synchroniser les informations des unités d'un seul centre d'archives
 -- *SYNCHRONISER_TOUS* pour synchroniser les informations des unités de tous les centres d'archives

Il est ainsi possible de lancer le chargement ou la synchronisation des informations des unités dans Solr pour un seul ou pour tous les centres d'archives à partir de la page 0 ou à partir d'une autre page pour le premier centre d'archives pour ne pas recommencer le chargement depuis le début. Le premier centre d'archives dans la liste des centres d'archives triée selon leur nom ascendant est '07H - BAnQ Gatineau'.

[[services-pistard-traitement-uniteDescription-chargerSolr-unite]]
===== Charger dans Solr les informations d'une unité de description

====== Exemple de requête

include::{snippets}/put_chargerUniteSolr/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/put_chargerUniteSolr/http-response.adoc[]

[[services-pistard-traitement-uniteDescription-chargerSolr-unCentreArchives]]
===== Charger dans Solr les informations des unités de description d'un centre d'archives

Le service web permet de lancer :

 - le chargement des informations de toutes les unités d'un centre d'archives à partir du début avec le numéro de page à 0 avec le type de chargement *CHARGER_UN*.
 - le chargement des informations de toutes les unités d'un centre d'archives à partir d'une page précise à 1000 unités par page afin de ne pas recommencer le chargement depuis le début avec le type de chargement *CHARGER_UN*.
 - la synchronisation des informations de toutes les unités d'un centre d'archives avec le type de chargement *SYNCHRONISER_UN*.
 
====== Exemple de requête

include::{snippets}/put_chargerUnitesSolr_pourUnCentreArchives/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/put_chargerUnitesSolr_pourUnCentreArchives/http-response.adoc[]

[[services-pistard-traitement-uniteDescription-chargerSolr-tousLesCentresArchives]]
===== Charger dans Solr les informations des unités de description de tous les centres d'archives

Le service web permet de lancer :

 - le chargement des informations de toutes les unités des centres d'archives à partir du début avec le numéro de page à 0 avec le code du premier centre d'archives à considérer et avec le type de chargement *CHARGER_TOUS*.
 - le chargement des informations de toutes les unités des centres d'archives à partir d'une page précise à 1000 unités par page afin de ne pas recommencer le chargement depuis le début avec le code du premier centre d'archives à considérer et avec le type de chargement *CHARGER_TOUS*.
 - la synchronisation des informations de toutes les unités des centres d'archives avec le code du premier centre d'archives à considérer et avec le type de chargement *SYNCHRONISER_TOUS*.

====== Exemple de requête

include::{snippets}/put_chargerUnitesSolr_pourTousLesCentresArchives/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/put_chargerUnitesSolr_pourTousLesCentresArchives/http-response.adoc[]


[[services-pistard-traitement-uniteDescription-annulerChargementSolr]]
==== Annuler le chargement dans Solr des informations des unités de description

===== Exemple de requête

include::{snippets}/delete_chargerUnitesSolrAnnuler/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/delete_chargerUnitesSolrAnnuler/http-response.adoc[]


[[services-pistard-traitement-uniteDescription-statutChargementSolr]]
==== Obtenir le statut de chargement dans Solr des informations des unités de description

===== Exemple de requête

include::{snippets}/get_chargerUnitesSolrStatut/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_chargerUnitesSolrStatut/http-response.adoc[]


[[services-pistard-traitement-typeMessageControleUniteDescription]]
=== Type de message de contrôle du traitement

Le service web pour obtenir les types de message de contrôle des unités de description permet :

 * <<services-pistard-commun-typeMessageControleUniteDescription-liste>>

[[services-pistard-commun-typeMessageControleUniteDescription-liste]]
==== Obtenir les types de message de contrôle du traitement

===== Exemple de requête

include::{snippets}/get_typeMessageControleUniteDescription/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_typeMessageControleUniteDescription/http-response.adoc[]


[[services-pistard-traitement-codeMessageControleUniteDescription]]
=== Code de message de contrôle du traitement

Le service web pour obtenir les codes de message de contrôle des unités de description permet :

 * <<services-pistard-commun-codeMessageControleUniteDescription-liste>>

[[services-pistard-commun-codeMessageControleUniteDescription-liste]]
==== Obtenir les codes de message de contrôle du traitement

===== Exemple de requête

include::{snippets}/get_codeMessageControleUniteDescription/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_codeMessageControleUniteDescription/http-response.adoc[]


[[services-pistard-traitement-messageControleUniteDescription]]
=== Message de contrôle du traitement

Le service web pour les messages de contrôle du traitement permet :

 * <<services-pistard-traitement-messageControleUniteDescription-filtrer>>

[[services-pistard-traitement-messageControleUniteDescription-filtrer]]
==== Filtrer les messages de contrôle du traitement d'une unité de description et de ses unités inférieures

Ce service web permet de filtrer la liste des messages de contrôle du traitement d'une unité de description et de ses unités inférieures selon différents critères.

Voici les critères de recherche possibles :

 * idUniteDescription : Identifiant d'une unité de description.
 * typeMessageControle : Le type de message de contrôle (AVERTISSEMENT, ERREUR).
 * codeMessageControle : Le code de message de contrôle (CONTENANTS_LOCALISES, DATES_CREATION_OBLIGATOIRE, etc).
 * indInclureUnitesInferieures : Indicateur pour inclure les messages de contrôle des unités inférieures de l'unité de description fournie.

Voici le nom des champs à utiliser pour demander un tri pour l'une des colonnes dans l'une des listes de contenus de fonds :

 * typeMessageControle : Nom pour demander un tri pour la colonne 'Type'.
 * messageControle : Nom pour demander un tri pour la colonne 'Message'.
 * coteUniteDescription : Nom pour demander un tri pour la colonne 'Cote'.
 * titrePropreUniteDescription : Nom pour demander un tri pour la colonne 'Titre propre'.
 * statutUniteDescription : Nom pour demander un tri pour la colonne du statut de l'unité de description.
 
Le tri par défaut est effectué pour avoir les erreurs en premier et ensuite sur la colonne 'Cote' ascendant et la colonne 'Message' ascendant.

===== Exemple de requête

include::{snippets}/post_filtrerMessageControleUniteDescription/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/post_filtrerMessageControleUniteDescription/http-response.adoc[]


[[services-pistard-traitement-contenuFonds]]
=== Contenu de fonds

Les services Web pour les contenus de fonds permettent :

 * <<services-pistard-traitement-contenuFonds-filtrer>>
 * <<services-pistard-traitement-contenuFonds-obtenirAssociesAuContenant>>
 * <<services-pistard-traitement-contenuFonds-obtenir>>
 * <<services-pistard-traitement-contenuFonds-creer>>
 * <<services-pistard-traitement-contenuFonds-modifier>>
 * <<services-pistard-traitement-contenuFonds-changerContenant>>
 * <<services-pistard-traitement-contenuFonds-supprimer>>

[[services-pistard-traitement-contenuFonds-filtrer]]
==== Filtrer les contenus de fonds

Ce service web permet de filtrer la liste des contenus de fonds selon différents critères :

 * <<services-pistard-traitement-contenuFonds-filtrerAssociesAuContenant>>
 * <<services-pistard-traitement-contenuFonds-filtrerAssociesAUniteEtAcquisition>>
 * <<services-pistard-traitement-contenuFonds-filtrerAssociesAUnite>>

Voici les critères de recherche possibles :

 * idAcquisition : Identifiant d'une acquisition.
 * idContenant : Identifiant d'un contenant.
 * idUniteDescription : Identifiant d'une unité de description.

Voici le nom des champs à utiliser pour demander un tri pour l'une des colonnes dans l'une des listes de contenus de fonds :

 * noContenant : Nom pour demander un tri pour la colonne 'Contenant'.
 * coteUniteDescription : Nom pour demander un tri pour la colonne 'Cote'.
 * titrePropreUniteDescription : Nom pour demander un tri pour la colonne 'Titre propre'.
 * statutUniteDescription : Nom pour demander un tri pour la colonne 'Statut'.
 * indiceReperage : Nom pour demander un tri pour la colonne 'Indice de repérage'.
 * dimensions : Nom pour demander un tri pour la colonne 'Dimensions'.
 * adresseLocalisationAvecCodeEspace : Nom pour demander un tri pour la colonne 'Adresse de localisation' avec les champs dans cet ordre : NO_MAGASIN, CODE_SECTION, NO_RANGEE, NO_ETAGERE, NO_TABLETTE, TYPE_POSITION, POSITION et NIVEAU.
 * noRestrictionsAppliquees : Nom pour demander un tri pour la colonne 'Restriction(s)'.

[[services-pistard-traitement-contenuFonds-filtrerAssociesAuContenant]]
===== Filtrer les contenus de fonds associés à un contenant

====== Exemple de requête

include::{snippets}/post_filtrerContenusFonds_associesAuContenant/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/post_filtrerContenusFonds_associesAuContenant/http-response.adoc[]

[[services-pistard-traitement-contenuFonds-filtrerAssociesAUniteEtAcquisition]]
===== Filtrer les contenus de fonds associés à une unité de description pour les contenants associés à une acquisition

====== Exemple de requête

include::{snippets}/post_filtrerContenusFonds_associesAUniteEtAcquisition/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/post_filtrerContenusFonds_associesAUniteEtAcquisition/http-response.adoc[]

[[services-pistard-traitement-contenuFonds-filtrerAssociesAUnite]]
====== Filtrer les contenus de fonds associés à une unité de description

======= Exemple de requête

include::{snippets}/post_filtrerContenusFonds_associesAUnite_selonId/http-request.adoc[]

======= Exemple de réponse

include::{snippets}/post_filtrerContenusFonds_associesAUnite_selonId/http-response.adoc[]


[[services-pistard-traitement-contenuFonds-obtenirAssociesAuContenant]]
==== Obtenir les contenus de fonds associés à un contenant

===== Exemple de requête

include::{snippets}/get_obtenirContenusFondsAssociesAuContenant/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_obtenirContenusFondsAssociesAuContenant/http-response.adoc[]


[[services-pistard-traitement-contenuFonds-obtenir]]
==== Obtenir un contenu de fonds

pass:q[<u>*La précondition*</u>] pour obtenir un contenu de fonds est :

 * Un contenu de fonds doit exister selon l'identifiant fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/get_obtenirContenuFonds/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_obtenirContenuFonds/http-response.adoc[]


[[services-pistard-traitement-contenuFonds-creer]]
==== Créer un ou plusieurs contenus de fonds

Ce service web permet de créer un ou plusieurs contenus de fonds pour une unité de description et une liste de contenants.

pass:q[<u>*Les préconditions*</u>] pour créer un ou plusieurs contenus de fonds sont :

 * L'usager interne doit être archiviste (PROFESSIONNEL) ou soutien (SOUTIEN) et être autorisé à modifier l'unité de description associée au contenu de fonds sinon un code HTTP 403 est retourné.
 * Une unité de description doit exister selon l'identifiant fourni sinon un code HTTP 404 est retourné.
 * Un contenant doit exister selon chaque identifiant fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/post_creerContenusFonds/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/post_creerContenusFonds/http-response.adoc[]


[[services-pistard-traitement-contenuFonds-modifier]]
==== Modifier un contenu de fonds

Ce service web permet de modifier l'indice de repérage d'un contenu de fonds.

pass:q[<u>*Les préconditions*</u>] pour modifier un contenu de fonds sont :

 * L'usager interne doit être archiviste (PROFESSIONNEL) ou soutien (SOUTIEN) et être autorisé à modifier l'unité de description associée au contenu de fonds sinon un code HTTP 403 est retourné.
 * Le contenu de fonds doit exister avec l'identifiant fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/put_modifierContenuFonds/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/put_modifierContenuFonds/http-response.adoc[]


[[services-pistard-traitement-contenuFonds-changerContenant]]
==== Changer le contenant d'un contenu de fonds

Ce service web permet de changer le contenant d'un contenu de fonds d'une unité de description et d'un ancien contenant par un nouveau contenant.

pass:q[<u>*Les préconditions*</u>] pour changer le contenant d'un contenu de fonds sont :

 * L'usager interne doit être archiviste (PROFESSIONNEL) ou soutien (SOUTIEN) et être autorisé à modifier l'unité de description associée au contenu de fonds sinon un code HTTP 403 est retourné.
 * Un contenu de fonds doit exister pour les identifiants de l'unité de description et de l'ancien contenant fournis sinon un code HTTP 404 est retourné.
 * L'usager interne doit être responsable des espaces de conservation (RESPONSABLE_ESPACE), archiviste (PROFESSIONNEL) ou soutien (SOUTIEN) et être autorisé à modifier le contenu de fonds sinon un code HTTP 403 est retourné.

===== Exemple de requête

include::{snippets}/post_changerContenantContenuFonds/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/post_changerContenantContenuFonds/http-response.adoc[]


[[services-pistard-traitement-contenuFonds-supprimer]]
==== Supprimer un ou plusieurs contenus de fonds

Ce service web permet de supprimer un ou plusieurs contenus de fonds pour une unité de description et une liste de contenants.

Si un identifiant de contenant est fourni et qu'il ne correspond pas à un contenu de fonds de l'unité de description, il est ignoré.

pass:q[<u>*Les préconditions*</u>] pour supprimer un ou plusieurs contenus de fonds sont :

 * L'usager interne doit être archiviste (PROFESSIONNEL) ou soutien (SOUTIEN) et être autorisé à modifier l'unité de description associée au contenu de fonds sinon un code HTTP 403 est retourné.
 * Une unité de description doit exister selon l'identifiant fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/delete_supprimerContenusFonds/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/delete_supprimerContenusFonds/http-response.adoc[]


[[services-pistard-traitement-facette]]
=== Facette

Les services Web pour les facettes permettent :

 * <<services-pistard-traitement-facette-obtenirFacettesSeulement>>
 * <<services-pistard-traitement-facette-obtenirFacettesEtTermesDeFacette>>
 * <<services-pistard-traitement-facette-obtenir>>
 * <<services-pistard-traitement-facette-creer>>
 * <<services-pistard-traitement-facette-modifier>>
 * <<services-pistard-traitement-facette-supprimer>>

Le type pour les facettes est *FAC*.

[[services-pistard-traitement-facette-obtenirFacettesSeulement]]
==== Obtenir seulement les facettes

===== Exemple de requête

include::{snippets}/get_obtenirFacettesSeulement/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_obtenirFacettesSeulement/http-response.adoc[]


[[services-pistard-traitement-facette-obtenirFacettesEtTermesDeFacette]]
==== Obtenir les facettes et les termes de facette

===== Exemple de requête

include::{snippets}/get_obtenirFacettesEtTermesDeFacette/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_obtenirFacettesEtTermesDeFacette/http-response.adoc[]


[[services-pistard-traitement-facette-obtenir]]
==== Obtenir une facette

pass:q[<u>*La précondition*</u>] pour obtenir une facette est :

 * Une facette doit exister selon l'identifiant fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/get_obtenirFacette/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_obtenirFacette/http-response.adoc[]


[[services-pistard-traitement-facette-creer]]
==== Créer une facette

pass:q[<u>*Les préconditions*</u>] pour créer une facette sont :

 * L'usager doit être interne et avoir le rôle RESPONSABLE_FACETTE sinon un code HTTP 403 est retourné.
 * Le titre de la facette ne doit pas exister sinon un code HTTP 409 est retourné.

===== Exemple de requête

include::{snippets}/post_creerFacette/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/post_creerFacette/http-response.adoc[]


[[services-pistard-traitement-facette-modifier]]
==== Modifier une facette

pass:q[<u>*Les préconditions*</u>] pour modifier une facette sont :

 * L'usager doit être interne et avoir le rôle RESPONSABLE_FACETTE sinon un code HTTP 403 est retourné.
 * La facette doit exister avec l'identifiant fourni sinon un code HTTP 404 est retourné.
 * Le titre de la facette ne doit pas exister sinon un code HTTP 409 est retourné.

===== Exemple de requête

include::{snippets}/put_modifierFacette/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/put_modifierFacette/http-response.adoc[]


[[services-pistard-traitement-facette-supprimer]]
==== Supprimer une facette

pass:q[<u>*Les préconditions*</u>] pour supprimer une facette sont :

 * L'usager doit être interne et avoir le rôle RESPONSABLE_FACETTE sinon un code HTTP 403 est retourné.
 * La facette doit exister avec l'identifiant fourni sinon un code HTTP 404 est retourné.
 * La facette ne doit pas contenir de termes sinon un code HTTP 412 est retourné.

===== Exemple de requête

include::{snippets}/delete_supprimerFacette/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/delete_supprimerFacette/http-response.adoc[]


[[services-pistard-traitement-termeFacette]]
=== Terme de facette

Les services Web pour les termes de facette permettent :

 * <<services-pistard-traitement-termeFacette-obtenirTermesPourFacette>>
 * <<services-pistard-traitement-termeFacette-obtenirSousTermesPourTerme>>
 * <<services-pistard-traitement-termeFacette-obtenir>>
 * <<services-pistard-traitement-termeFacette-creer>>
 * <<services-pistard-traitement-termeFacette-modifier>>
 * <<services-pistard-traitement-termeFacette-supprimer>>

Voici les types possibles pour les termes de facettes :

 * TER - Terme d'une facette
 * SOU - Terme inférieur (Sous-terme d'un terme)
 * SYN - Synonyme d'un terme

[[services-pistard-traitement-termeFacette-obtenirTermesPourFacette]]
==== Obtenir les termes d'une facette

===== Exemple de requête

include::{snippets}/get_obtenirTermesPourFacette/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_obtenirTermesPourFacette/http-response.adoc[]


[[services-pistard-traitement-termeFacette-obtenirSousTermesPourTerme]]
==== Obtenir les sous-termes d'un terme

===== Exemple de requête

include::{snippets}/get_obtenirSousTermesPourTerme/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_obtenirSousTermesPourTerme/http-response.adoc[]


[[services-pistard-traitement-termeFacette-obtenir]]
==== Obtenir un terme de facette

pass:q[<u>*La précondition*</u>] pour obtenir un terme de facette est :

 * Un terme de facette doit exister selon l'identifiant fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/get_obtenirTermeFacette/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_obtenirTermeFacette/http-response.adoc[]


[[services-pistard-traitement-termeFacette-creer]]
==== Créer un terme de facette

pass:q[<u>*Les préconditions*</u>] pour créer un terme de facette sont :

 * L'usager doit être interne et avoir le rôle RESPONSABLE_FACETTE sinon un code HTTP 403 est retourné.
 * Le titre du terme de facette ne doit pas exister pour un autre terme pour la même facette sinon un code HTTP 409 est retourné.
 * Le titre de chaque terme de niveau inférieur doit être unique pour le terme de facette sinon un code HTTP 409 est retourné.
 * Le titre de chaque synonyme doit être unique pour le terme de facette sinon un code HTTP 409 est retourné.

===== Exemple de requête

include::{snippets}/post_creerTermeFacette/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/post_creerTermeFacette/http-response.adoc[]


[[services-pistard-traitement-termeFacette-modifier]]
==== Modifier un terme de facette

pass:q[<u>*Les préconditions*</u>] pour modifier un terme de facette sont :

 * L'usager doit être interne et avoir le rôle RESPONSABLE_FACETTE sinon un code HTTP 403 est retourné.
 * Le titre du terme de facette ne doit pas exister pour un autre terme pour la même facette sinon un code HTTP 409 est retourné.
 * Le titre de chaque terme de niveau inférieur doit être unique pour le terme de facette sinon un code HTTP 409 est retourné.
 * Le titre de chaque synonyme doit être unique pour le terme de facette sinon un code HTTP 409 est retourné.

===== Exemple de requête

include::{snippets}/put_modifierTermeFacette/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/put_modifierTermeFacette/http-response.adoc[]


[[services-pistard-traitement-termeFacette-supprimer]]
==== Supprimer un terme de facette

pass:q[<u>*Les préconditions*</u>] pour supprimer un terme de facette sont :

 * L'usager doit être interne et avoir le rôle RESPONSABLE_FACETTE sinon un code HTTP 403 est retourné.
 * Le terme de facette ne doit pas contenir des termes de niveau inférieur sinon un code HTTP 412 est retourné.
 * Le terme de facette ne doit pas être associé à une unité de description sinon un code HTTP 412 est retourné.

===== Exemple de requête

include::{snippets}/delete_supprimerTermeFacette/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/delete_supprimerTermeFacette/http-response.adoc[]


[[services-pistard-traitement-instrumentRecherche]]
=== Instrument de recherche

Les services Web pour les instruments de recherche permettent :

 * <<services-pistard-traitement-instrumentRecherche-obtenirAssociesFonds>>
 * <<services-pistard-traitement-instrumentRecherche-obtenir>>
 * <<services-pistard-traitement-instrumentRecherche-creer>>
 * <<services-pistard-traitement-instrumentRecherche-modifier>>
 * <<services-pistard-traitement-instrumentRecherche-supprimer>>

[[services-pistard-traitement-instrumentRecherche-obtenirAssociesFonds]]
==== Obtenir les instruments de recherche associés au fonds d'une unité de description

pass:q[<u>*La précondition*</u>] pour obtenir les instruments de recherche associés au fonds d'une unité de description :

 * L'unité de description doit exister avec l'identifiant fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/get_obtenirInstrumentsRechercheAssociesFonds/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_obtenirInstrumentsRechercheAssociesFonds/http-response.adoc[]


[[services-pistard-traitement-instrumentRecherche-obtenir]]
==== Obtenir un instrument de recherche

pass:q[<u>*La précondition*</u>] pour obtenir un instrument de recherche est :

 * L'instrument de recherche doit exister avec l'identifiant fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/get_obtenirInstrumentRecherche/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_obtenirInstrumentRecherche/http-response.adoc[]


[[services-pistard-traitement-instrumentRecherche-creer]]
==== Créer un instrument de recherche

pass:q[<u>*Les préconditions*</u>] pour créer un instrument de recherche sont :

 * L'usager interne doit être archiviste (PROFESSIONNEL) ou soutien (SOUTIEN) et être autorisé à modifier l'unité sinon un code HTTP 403 est retourné.
 * Le titre de l'instrument de recherche ne doit pas exister au niveau du fonds sinon un code HTTP 409 est retourné.

===== Exemple de requête

include::{snippets}/post_creerInstrumentRecherche_avecSupportsConsultation/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/post_creerInstrumentRecherche_avecSupportsConsultation/http-response.adoc[]


[[services-pistard-traitement-instrumentRecherche-modifier]]
==== Modifier un instrument de recherche

pass:q[<u>*Les préconditions*</u>] pour modifier un instrument de recherche sont :

 * L'usager interne doit être archiviste (PROFESSIONNEL) ou soutien (SOUTIEN) et être autorisé à modifier l'unité sinon un code HTTP 403 est retourné.
 * L'instrument de recherche doit exister avec l'identifiant fourni sinon un code HTTP 404 est retourné.
 * Le titre de l'instrument de recherche ne doit pas exister au niveau du fonds sinon un code HTTP 409 est retourné.

===== Exemple de requête

include::{snippets}/put_modifierInstrumentRecherche_ajouterSupportConsultation/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/put_modifierInstrumentRecherche_ajouterSupportConsultation/http-response.adoc[]


[[services-pistard-traitement-instrumentRecherche-supprimer]]
==== Supprimer un instrument de recherche

pass:q[<u>*Les préconditions*</u>] pour supprimer un instrument de recherche sont :

 * L'usager interne doit être archiviste (PROFESSIONNEL) ou soutien (SOUTIEN) et être autorisé à modifier l'unité sinon un code HTTP 403 est retourné.
 * La facette doit exister avec l'identifiant fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/delete_supprimerInstrumentRecherche/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/delete_supprimerInstrumentRecherche/http-response.adoc[]


[[services-pistard-traitement-ligneCollationGenreSpecifique]]
=== Ligne collation genre spécifique

Les services WEB pour les lignes collation genre spécifique permettent :

* <<services-pistard-traitement-ligneCollationGenreSpecifique-obtenir>>
* <<services-pistard-traitement-ligneCollationGenreSpecifique-supprimer>>

[[services-pistard-traitement-ligneCollationGenreSpecifique-obtenir]]
==== Obtenir une ligne collation genre spécifique à partir de son identifiant

pass:q[<u>*La précondition*</u>] pour obtenir une ligne collation genre spécifique est :

 * Une ligne collation genre spécifique doit exister selon l'identifiant fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/get_obtenirLigneCollationGenreSpecifique/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_obtenirLigneCollationGenreSpecifique/http-response.adoc[]


[[services-pistard-traitement-ligneCollationGenreSpecifique-supprimer]]
==== Supprimer une ligne collation genre spécifique

pass:q[<u>*Les préconditions*</u>] pour supprimer une ligne collation genre spécifique sont :

 * Une ligne collation genre spécifique doit exister selon l'identifiant fourni sinon un code HTTP 404 est retourné.
 * L'usager interne doit être archiviste (PROFESSIONNEL) ou soutien (SOUTIEN) et être autorisé à modifier l'unité associée sinon un code HTTP 403 est retourné.

===== Exemple de requête

include::{snippets}/delete_supprimerLigneCollationGenreSpecifique/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/delete_supprimerLigneCollationGenreSpecifique/http-response.adoc[]


[[services-pistard-traitement-preference-caracteristiqueMaterielle]]
=== Préférence caractéristique matérielle

Les services WEB pour les préférences caractéristique matérielle permettent :

 * <<services-pistard-traitement-preference-caracteristiqueMaterielle-obtenirListe>>
 * <<services-pistard-traitement-preference-caracteristiqueMaterielle-obtenir>>

[[services-pistard-traitement-preference-caracteristiqueMaterielle-obtenirListe]]
==== Obtenir les préférences caractéristique matérielle pour un genre de document spécifique

pass:q[<u>*La précondition*</u>] pour obtenir les préférences caractéristique matérielle pour un genre de document spécifique est :

 * Un genre de document spécifique doit exister selon le code fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/get_obtenirPreferencesCaracteristiqueMaterielle/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_obtenirPreferencesCaracteristiqueMaterielle/http-response.adoc[]


[[services-pistard-traitement-preference-caracteristiqueMaterielle-obtenir]]
==== Obtenir une préférence caractéristique matérielle à partir de son identifiant

pass:q[<u>*La précondition*</u>] pour obtenir une préférence caractéristique matérielle est :

 * Une préférence caractéristique matérielle doit exister selon l'identifiant fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/get_obtenirPreferenceCaracteristiqueMaterielle/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_obtenirPreferenceCaracteristiqueMaterielle/http-response.adoc[]


[[services-pistard-traitement-preference-critereDocumentPrecieux]]
=== Préférence de critère de document précieux

Les services WEB pour les préférences de critère de document précieux permettent :

 * <<services-pistard-traitement-preference-critereDocumentPrecieux-obtenirListe>>
 * <<services-pistard-traitement-preference-critereDocumentPrecieux-obtenir>>

[[services-pistard-traitement-preference-critereDocumentPrecieux-obtenirListe]]
==== Obtenir les préférences de critère de document précieux

===== Exemple de requête

include::{snippets}/get_obtenirPreferencesCritereDocumentPrecieux/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_obtenirPreferencesCritereDocumentPrecieux/http-response.adoc[]


[[services-pistard-traitement-preference-critereDocumentPrecieux-obtenir]]
==== Obtenir une préférence de critère de document précieux à partir de son identifiant

pass:q[<u>*La précondition*</u>] pour obtenir une préférence de critère de document précieux est :

 * Une préférence de critère de document précieux doit exister selon l'identifiant fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/get_obtenirPreferenceCritereDocumentPrecieux/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_obtenirPreferenceCritereDocumentPrecieux/http-response.adoc[]


[[services-pistard-traitement-preference-etatPhysique]]
=== Préférence d'état physique

Les services WEB pour les préférences d'état physique permettent :

 * <<services-pistard-traitement-preference-etatPhysique-obtenirListe>>
 * <<services-pistard-traitement-preference-etatPhysique-obtenir>>

[[services-pistard-traitement-preference-etatPhysique-obtenirListe]]
==== Obtenir les préférences d'état physique

===== Exemple de requête

include::{snippets}/get_obtenirPreferencesEtatPhysique/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_obtenirPreferencesEtatPhysique/http-response.adoc[]


[[services-pistard-traitement-preference-etatPhysique-obtenir]]
==== Obtenir une préférence d'état physique à partir de son identifiant

pass:q[<u>*La précondition*</u>] pour obtenir une préférence d'état physique est :

 * Une préférence d'état physique doit exister selon l'identifiant fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/get_obtenirPreferenceEtatPhysique/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_obtenirPreferenceEtatPhysique/http-response.adoc[]


[[services-pistard-traitement-preference-moyenIntervention]]
=== Préférence de moyen d'intervention

Les services WEB pour les préférences moyen d'intervention permettent :

 * <<services-pistard-traitement-preference-moyenIntervention-obtenirListe>>
 * <<services-pistard-traitement-preference-moyenIntervention-obtenir>>

[[services-pistard-traitement-preference-moyenIntervention-obtenirListe]]
==== Obtenir les préférences de moyen d'intervention

===== Exemple de requête

include::{snippets}/get_obtenirPreferencesMoyenIntervention/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_obtenirPreferencesMoyenIntervention/http-response.adoc[]


[[services-pistard-traitement-preference-moyenIntervention-obtenir]]
==== Obtenir une préférence de moyen d'intervention à partir de son identifiant

pass:q[<u>*La précondition*</u>] pour obtenir une préférence de moyen d'intervention est :

 * Une préférence de moyen d'intervention doit exister selon l'identifiant fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/get_obtenirPreferenceMoyenIntervention/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_obtenirPreferenceMoyenIntervention/http-response.adoc[]


[[services-pistard-traitement-typeCategorieTermeIndexation]]
=== Type de catégorie pour les termes d'indexation

Le service web pour obtenir les types de catégorie pour les termes d'indexation permet :

 * <<services-pistard-commun-typeCategorieTermeIndexation-liste>>

[[services-pistard-commun-typeCategorieTermeIndexation-liste]]
==== Obtenir les types de catégorie pour les termes d'indexation

===== Exemple de requête

include::{snippets}/get_typeCategorieTermeIndexation/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_typeCategorieTermeIndexation/http-response.adoc[]


[[services-pistard-traitement-typeRepertoireTermeIndexation]]
=== Type de répertoire pour les termes d'indexation

Le service web pour obtenir les types de répertoire pour les termes d'indexation permet :

 * <<services-pistard-commun-typeRepertoireTermeIndexation-liste>>

[[services-pistard-commun-typeRepertoireTermeIndexation-liste]]
==== Obtenir les types de répertoire pour les termes d'indexation

===== Exemple de requête

include::{snippets}/get_typeRepertoireTermeIndexation/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_typeRepertoireTermeIndexation/http-response.adoc[]


[[services-pistard-traitement-termeIndexation]]
=== Terme d'indexation

Les services Web pour les termes d'indexation permettent :

 * <<services-pistard-traitement-termeIndexation-chercher>>
 * <<services-pistard-traitement-termeIndexation-obtenir>>
 * <<services-pistard-traitement-termeIndexation-creer>>
 * <<services-pistard-traitement-termeIndexation-soumettreDemandeModifications>>

[[services-pistard-traitement-termeIndexation-chercher]]
==== Chercher des termes d'indexation

La recherche de termes d'indexation est effectuée selon les champs obligatoires suivants :

 * libelle - Le libellé à rechercher
 * typesRepertoireCogito - Une liste de répertoires de Cogito
 * typesCategorieCogito - Une liste de catégories de Cogito
 
Voici les types de répertoire Cogito *typesRepertoireCogito* avec le libellé à afficher dans le menu déroulant du formulaire de recherche, la source Cogito (Attribut SOURCE d'un descriptor) et le répertoire du projet au niveau du serveur Cogito :

 * FAL
 ** Libellé : FAL
 ** Source Cogito : FAL
 ** Répertoire Cogito : FAL
 * PARLEMENTAIRES
 ** Libellé : Parlementaires
 ** Source Cogito : Dictionnaire des parlementaires
 ** Répertoire Cogito : PARLEMENTAIRES
 * PETIT_JEAN
 ** Libellé : Petit-Jean
 ** Source Cogito : Petit Jean
 ** Répertoire Cogito : PETIT%20JEAN
 * PISTARD
 ** Libellé : Pistard
 ** Source Cogito : PISTARD
 ** Répertoire Cogito : PISTARD
 * RVM
 ** Libellé : RVM
 ** Source Cogito : RVM
 ** Répertoire Cogito : RVM
 * TOPOS
 ** Libellé : Topos
 ** Source Cogito : TOPOS
 ** Répertoire Cogito : TOPOS

Voici les types de catégories Cogito *typesCategorieCogito* avec le libellé à afficher dans le menu déroulant du formulaire de recherche et la catégorie au niveau du serveur Cogito :

 * EVENEMENT
 ** Libellé : Évènement
 ** Catégorie Cogito : /Entity/Evenement
 * LIEU
 ** Libellé : Lieu
 ** Catégorie Cogito : /Entity/Lieu
 * NOM_COMMUN
 ** Libellé : Nom commun
 ** Catégorie Cogito : /Entity/Nom commun
 * PERSONNE_MORALE
 ** Libellé : Personne morale
 ** Catégorie Cogito : /Entity/Personne morale
 * PERSONNE_PHYSIQUE
 ** Libellé : Personne physique
 ** Catégorie Cogito : /Entity/Personne physique

Voici les valeurs possibles pour le type de demande *typeDemande*  pour les termes d'indexation provenant du répertoire PISTARD dans Cogito :

 * Aucune valeur : Signifie que le terme a été validé par le responsable du de l'indexation.
 * CANDIDAT : Signifie que c'est un terme candidat et qui n'a pas encore été approuvé par le responsable de l'indexation.
 * MODIFICATION : Signifie que le terme a fait l'objet d'une demande de modifications qui n'a pas encore été approuvée par le responsable de l'indexation.

===== Exemple de requête

include::{snippets}/post_chercherTermeIndexation/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/post_chercherTermeIndexation/http-response.adoc[]


[[services-pistard-traitement-termeIndexation-obtenir]]
==== Obtenir un terme d'indexation

pass:q[<u>*La précondition*</u>] pour obtenir un terme d'indexation est :

 * Un terme d'indexation doit exister selon l'identifiant fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/get_obtenirTermeIndexation/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_obtenirTermeIndexation/http-response.adoc[]


[[services-pistard-traitement-termeIndexation-creer]]
==== Créer un terme d'indexation

Voici les 2 cas possibles de création d'un terme d'indexation :

 * <<services-pistard-traitement-termeIndexation-creer-existeDansCogito>>
 * <<services-pistard-traitement-termeIndexation-creer-termeCandidatDansCogito>>

[[services-pistard-traitement-termeIndexation-creer-existeDansCogito]]
===== Créer un terme d'indexation qui existe dans Cogito pour Pistard

L'objectif de ce service web est de créer un terme d'indexation qui existe dans Cogito pour Pistard dans la table de référence REF_TERME afin de permettre d'avoir un identifiant pour entre autre le rattacher à une unité de description et pour permettre la consultation de ces informations.

pass:q[<u>*Les préconditions*</u>] pour créer un terme d'indexation pour Pistard et qui existe dans Cogito sont :

 * L'usager interne doit être archiviste (PROFESSIONNEL) sinon un code HTTP 403 est retourné.
 * Les informations suivantes sont obligatoires pour créer un terme d'indexation pour Pistard dans la table de référence REF_TERME afin de permettre de retrouver le terme d'indexation par la suite dans son répertoire Cogito. S'il manque une des informations obligatoires, un code HTTP 400 est retourné avec un message précisant la source de l'erreur :

 ** idCogito : Identifiant Cogito
 ** libelle : Libellé
 ** repertoireCogito : Code du répertoire Cogito
 ** categorieCogito : Code de la catégorie Cogito

====== Exemple de requête

include::{snippets}/post_creerTermeIndexation_existeDansCogito/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/post_creerTermeIndexation_existeDansCogito/http-response.adoc[]

[[services-pistard-traitement-termeIndexation-creer-termeCandidatDansCogito]]
===== Créer un terme d'indexation candidat dans le répertoire Pistard de Cogito

L'objectif de ce service web est de créer un nouveau terme d'indexation candidat dans Cogito afin d'enrichir le répertoire Pistard des termes disponibles. Le nouveau terme est aussi créé dans la table de référence REF_TERME afin de permettre d'avoir un identifiant pour entre autre le rattacher à une unité de description et pour permettre la consultation de ces informations. Le nouveau terme d'indexation candidat sera évalué par le responsable de l'indexation à partir de Cogito.

pass:q[<u>*Les préconditions*</u>] pour créer un terme d'indexation candidat dans le répertoire Pistard de Cogito sont :

 * L'usager interne doit être archiviste (PROFESSIONNEL) sinon un code HTTP 403 est retourné.
 * Le terme d'indexation ne doit pas exister dans le répertoire Pistard dans Cogito sinon un code HTTP 412 est retourné.

====== Exemple de requête

include::{snippets}/post_creerTermeIndexation_termeCandidatDansCogito/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/post_creerTermeIndexation_termeCandidatDansCogito/http-response.adoc[]


[[services-pistard-traitement-termeIndexation-soumettreDemandeModifications]]
==== Soumettre une demande de modifications d'un terme d'indexation dans le répertoire Pistard de Cogito

L'objectif de ce service web est de soumettre une demande de modifications d'un terme d'indexation dans le répertoire Pistard de Cogito. Les informations de la demande de modification seront enregistrées au niveau de champs prédéterminés dans le répertoire Pistard de Cogito pour le terme d'indexation concerné afin de permettre au responsable de l'indexation d'évaluer la demande de modifications.

pass:q[<u>*Les préconditions*</u>] pour soumettre une demande de modifications d'un terme d'indexation dans le répertoire Pistard de Cogito sont :

 * L'usager interne doit être archiviste (PROFESSIONNEL) sinon un code HTTP 403 est retourné.
 * Un terme d'indexation doit exister selon l'identifiant fourni sinon un code HTTP 404 est retourné.
 * Le terme d'indexation ne doit pas être un terme candidat ou avoir une demande de modifications dans le répertoire Pistard de Cogito sinon un code HTTP 412 est retourné.

===== Exemple de requête

include::{snippets}/put_soumettreDemandeModificationsTermeIndexation/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/put_soumettreDemandeModificationsTermeIndexation/http-response.adoc[]


[[services-pistard-commun-acquisition]]
=== Acquisition

Le service web pour les acquisitions permet :

 * <<services-pistard-commun-acquisition-filtrer>>

Voici les autres services Web en lien avec les acquisitions :

 * Pour la gestion des acquisitions (services Web communs aux archives privées et publiques) :
 ** <<services-pistard-commun-acquisition-assignation>>
 ** <<services-pistard-commun-acquisition-contenant>>
 ** <<services-pistard-commun-acquisition-noteSuivi>>

 * Pour la gestion des acquisitions pour les archives privées :
 ** <<services-pistard-acquisition-privee-offreAcquisition>>

 * Pour la gestion des acquisitions pour les archives publiques :
 ** <<services-pistard-acquisition-publique-versement>>
 ** <<services-pistard-acquisition-publique-document-dos>>
 ** <<services-pistard-acquisition-publique-document-reg>>
 ** <<services-pistard-acquisition-publique-document-ajd>>
 ** <<services-pistard-acquisition-publique-document-djd>>
 ** <<services-pistard-acquisition-publique-document-cjd>>
 ** <<services-pistard-acquisition-publique-document-rjd>>
 ** <<services-pistard-acquisition-publique-contenant>>

[[services-pistard-commun-acquisition-filtrer]]
==== Filtrer les acquisitions

Ce service web permet de filtrer les acquisitions selon différents critères.

Voici les critères de recherche possibles :

 * codeCentreArchive : Le code d'un centre d'archives.
 * noAcquisition : Le début ou la totalité du numéro d'acquisition.
 * titreAcquisition : Une partie du titre d'acquisition qui correspond au titre d'une offre d'acquisition privée ou au nom de l'organisme d'un versement publique.
 * indMesAcquisitions : Activer cet indicateur pour limiter la recherche aux versements assignés à l'usager effectuant la recherche.
 * statutAssignation : Le statut d'assignation des acquisitions (ASSIGNEE ou NON_ASSIGNEE). Si laissé vide, les 2 statuts sont considérés.
 * indPourAssocierAUniteDescription : Activer cet indicateur pour obtenir seulement les acquisitions qui sont à un statut qui permet une association à une unité de description (Enregistrée (ENRE ou ENR), En traitement (ETRA ou ETR), À évaluer (EVAL) et Traitée (TRAT ou TRT)).
 * codesStatutAcquisition : La liste des codes de statut à considérer.
 ** Pour les offres d'acquisitions privées, les statuts supportés sont :
 *** NOUV - Nouvelle
 *** REAF - Réaffectée
 *** COMP - Complétée
 *** ACCP - Acceptée
 *** DOCU - Documentée
 *** APPR - Approuvée
 *** ENRE - Enregistrée
 *** ETRA - En traitement
 *** EVAL - À évaluer
 ** Pour les versements publiques, les statuts supportés sont :
 *** ENR - Enregistré
 *** ETR - En traitement
 * idUniteDescription : Identifiant de l'unité de description pour obtenir ses acquisitions associées. Si noAcquisition est fourni, le centre d'archives de cette unité de description est ajouté comme critère pour rechercher l'acquisition dans le centre d'archives de l'unité de description fournie.
 * exclureAssociationIdUniteDescription : Identifiant de l'unité de description à considérer pour exclure ses acquisitions associées.
 * indInclureUnitesInferieures : Si l'indicateur indToutLeFonds n'est pas activé, vous pouvez activer cet indicateur pour obtenir les acquisitions associées aux unités inférieures en plus de celles associées à l'unité fournie.

Voici le nom des champs à utiliser pour demander un tri pour l'une des colonnes dans la liste des acquisitions si la recherche est effectuée pour un centre d'archives (L'identifiant *idUniteDescription* non fourni) :

 * noAcquisition : Nom pour demander un tri pour la colonne 'No d'acquisition'. Le tri par défaut est descendant sur ce champ.
 * titreAcquisition : Nom pour demander un tri pour la colonne 'Titre / organisme'.
 * dateCreationAcquisition : Nom pour demander un tri pour la colonne 'Date de création'.
 * dateLimiteAcquisition : Nom pour demander un tri pour la colonne 'Date limite'.
 * dateAssignation : Nom pour demander un tri sur la date d'assignation' lorsque la recherche est effectuée avec l'indicateur indMesAcquisitions activé.
 * libelleStatutAcquisition : Nom pour demander un tri pour la colonne 'Statut'.
 * typeArchivesVersees : Nom pour demander un tri pour la colonne 'Archives'.
 * nomEmployesAssignes : Nom pour demander un tri pour la colonne 'Personnel attitré'.

Voici le nom des champs à utiliser pour demander un tri pour l'une des colonnes dans la liste des acquisitions si la recherche est effectuée pour une unité de description (L'identifiant *idUniteDescription* fourni) :

 * noAcquisition : Nom pour demander un tri pour la colonne 'No d'acquisition'. Le tri par défaut est descendant sur ce champ.
 * titreAcquisition : Nom pour demander un tri pour la colonne 'Titre / organisme'.
 * libelleStatutAcquisition : Nom pour demander un tri pour la colonne 'Statut'.
 * typeRattachement : Nom pour demander un tri pour la colonne 'Type de rattachement'.

===== Exemple de requête

include::{snippets}/post_filtrerAcquisitions/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/post_filtrerAcquisitions/http-response.adoc[]


[[services-pistard-commun-acquisition-assignation]]
=== Assignation aux acquisitions

Les services Web pour la gestion des assignations aux acquisitions permettent :

 * <<services-pistard-commun-acquisition-assignation-filtrer>>
 * <<services-pistard-commun-acquisition-assignation-filtrerEmployes>>
 * <<services-pistard-commun-acquisition-assignation-assignerEmployes>>
 * <<services-pistard-commun-acquisition-assignation-supprimer>>

[[services-pistard-commun-acquisition-assignation-filtrer]]
==== Filtrer les assignations

Voici le nom des champs à utiliser pour demander un tri pour l'une des colonnes dans la liste des assignations :

 * nomCentreArchive : Nom pour demander un tri pour la colonne 'Centre d'archives'. Le tri par défaut est ascendant sur ce champ et ensuite sur personnelAttitre.
 * personnelAttitre : Nom pour demander un tri pour la colonne 'Personel attitré'.
 * titreEmploye : Nom pour demander un tri pour la colonne 'Titre'.
 * dateAssignation : Nom pour demander un tri pour la colonne 'Date d'assignation'.
 * nbrAcquisitionsAssigneesEmploye : Nom pour demander un tri pour la colonne 'Nombre d'acquisitions assignées'.

===== Exemple de requête

include::{snippets}/post_filtrerAssignationsPourAcquisition/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/post_filtrerAssignationsPourAcquisition/http-response.adoc[]


[[services-pistard-commun-acquisition-assignation-filtrerEmployes]]
==== Filtrer les employés pour une assignation

Voici le nom des champs à utiliser pour demander un tri pour l'une des colonnes dans la liste des employés pour une assignation :

 * employeAAssigner : Nom pour demander un tri pour la colonne 'Personel à attitrer'.
 * titreEmploye : Nom pour demander un tri pour la colonne 'Titre'.
 * nbrAcquisitionsAssigneesEmploye : Nom pour demander un tri pour la colonne 'Nombre d'acquisitions assignées'.

===== Exemple de requête

include::{snippets}/post_filtrerEmployesPourAssignation/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/post_filtrerEmployesPourAssignation/http-response.adoc[]


[[services-pistard-commun-acquisition-assignation-assignerEmployes]]
==== Assigner un ou plusieurs employés à une acquisition

pass:q[<u>*Les préconditions*</u>] pour assigner un ou plusieurs employés à une acquisition sont :

 * Une acquisition doit exister pour l'identifiant fourni sinon un code HTTP 404 est retourné.
 * L'usager interne doit être un coordonnateur (COORDONNATEUR) sinon un code HTTP 403 est retourné.
 * Un employé doit exister pour chaque code fourni sinon un code HTTP 404 est retourné.
 * Si l'acquisition n'est pas au moins enregistrée, elle ne peut être assigner qu'à un seul archiviste. Si un archiviste est déjà assigné ou si 2 archivistes sont fournis, un code HTTP 409 est retourné.
 * Si l'acquisition ne peut pas être assignée à cause de son statut, un code HTTP 412 est retourné.

===== Exemple de requête

include::{snippets}/post_assignations/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/post_assignations/http-response.adoc[]


[[services-pistard-commun-acquisition-assignation-supprimer]]
==== Supprimer une ou plusieurs assignations

pass:q[<u>*Les préconditions*</u>] pour supprimer une ou plusieurs assignations sont :

 * Une assignation doit exister pour chaque identifiant fourni sinon un code HTTP 404 est retourné.
 * La largeur doit être fourni sinon un code HTTP 400 est retourné.
 * L'usager interne doit être responsable des espaces de conservation (RESPONSABLE_ESPACE), archiviste (PROFESSIONNEL) ou soutien (SOUTIEN) et être autorisé à modifier le contenant sinon un code HTTP 403 est retourné.

===== Exemple de requête

include::{snippets}/supprimer_assignations/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/supprimer_assignations/http-response.adoc[]


[[services-pistard-commun-acquisition-contenant]]
=== Contenant d'une acquisition

Les services Web pour les contenants d'une acquisition permettent :

 * <<services-pistard-commun-acquisition-contenant-filtrer>>
 * <<services-pistard-commun-acquisition-contenant-obtenir>>
 * <<services-pistard-commun-acquisition-contenant-dimensions-obtenir>>
 * <<services-pistard-commun-acquisition-contenant-creer>>
 * <<services-pistard-commun-acquisition-contenant-modifier>>
 * <<services-pistard-commun-acquisition-contenant-supprimer>>
 * <<services-pistard-commun-acquisition-contenant-localiser>>
 * <<services-pistard-commun-acquisition-contenant-delocaliser>>
 * <<services-pistard-commun-acquisition-contenant-produireEtiquette>>

Voici les niveaux de restriction possibles pour les contenants :

 * AUCUNE_RESTRICTION
 * RESTRICTION_PARTIELLE
 * RESTRICTION_COMPLETE


[[services-pistard-commun-acquisition-contenant-filtrer]]
==== Filtrer les contenants

Ce service web permet de filtrer les contenants selon différents critères :

 * <<services-pistard-commun-acquisition-contenant-filtrerAssociesIdAcquisition>>
 * <<services-pistard-commun-acquisition-contenant-filtrerAssociesNoAcquisition>>
 * <<services-pistard-commun-acquisition-contenant-filtrerAssociesNoAcquisitionEtNoContenant>>
 * <<services-pistard-commun-acquisition-contenant-filtrerAssociesTablette>>
 * <<services-pistard-commun-acquisition-contenant-filtrerAssociesUnite>>
 * <<services-pistard-commun-acquisition-contenant-filtrerAssociesUniteEtAcquisition>>

Voici les critères de recherche possibles :

 * idAcquisition : Identifiant d'une acquisition.
 * codeCentreArchive : Le code d'un centre d'archives. Le code d'un centre d'archives doit être fourni pour considérer le numéro d'acquisition fourni.
 * noAcquisition : Le numéro d'une acquisition dans le format YYYY-MM-SSS (Ex. 2018-09-005). Pour être considérée, codeCentreArchive ou idUniteDescription doit être fourni.
 * noContenant : Le numéro de contenant. Valeur numérique optionnelle. Pour que noContenant soit considéré, il faut qu'un numéro d'acquisition soit également fourni.
 * idLocalisationTablette : Identifiant d'une localisation de type 'TAB - Tablette'.
 * idUniteDescription : Identifiant d'une unité de description.
 * idUnitePreTraitement : Identifiant d'une unité de pré-traitement.
 * indInclureContenantsIndirects : Indicateur pour inclure les contenants indirectement associés à l'unité de description. Cet indicateur est utilisé seulement si un idUniteDescription est fourni avec ou sans noAcquisition et noContenant et si indExclureContenantsDirects n'est pas activé.
 * indExclureContenantsDirects : Indicateur pour exclure les contenants directement associés à l'unité de description. Cet indicateur est utilisé seulement si un idUniteDescription est fourni avec ou sans noAcquisition et noContenant.

Voici le nom des champs à utiliser pour l'affichage des colonnes dans la liste des contenants :

 * noAcquisition + ' \ ' + noContenant : Numéro de contenant formatté avec son numéro d'acquisition
 * dimensions : Dimensions du contenant dans le format 'Largeur X Hauteur X Profondeur' avec un NA si une valeur n'est pas fournie
 * adresseLocalisationAvecCodeEspace : Adresse de localisation du contenant avec un code d'espace dans le format suivant : M S RRR EE-TT-PPPT-NN
 * nbrContenusFondsAssocies : Nombre de contenus de fonds associés au contenant et qui correspond au nombre d'unités de description associées directement au contenant.
 * niveauRestrictionContenant : Niveau de restriction du contenant

Voici le nom des champs à utiliser pour demander un tri pour l'une des colonnes dans la liste des contenants :

 * adresseLocalisationAvecCodeEspace : Nom pour demander un tri pour la colonne 'Adresse de localisation' avec les champs dans cet ordre : NO_MAGASIN, CODE_SECTION, NO_RANGEE, NO_ETAGERE, NO_TABLETTE, TYPE_POSITION, POSITION et NIVEAU. Le tri par défaut est sur ce champ avec un tri ascendant.
 * noContenant : Nom pour demander un tri pour la colonne 'No de contenant'.
 * dimensions : Nom pour demander un tri pour la colonne 'Dimensions'.
 * indImpressionRequise : Nom pour demander un tri pour la colonne 'Impression requise'.
 * typeRattachement : Nom pour demander un tri selon le type de rattachement direct ou indirect d'un contenant à une unité de description.
 * nbrContenusFondsAssocies : Nom pour demander un tri pour la colonne 'Nb unités de descrition'.
 * niveauRestrictionContenant : Nom pour demande un tri pour la colonne 'Niveau de restriction'.

[[services-pistard-commun-acquisition-contenant-filtrerAssociesIdAcquisition]]
===== Filtrer les contenants pour une acquisition

====== Exemple de requête

include::{snippets}/post_filtrerContenants_avecIdAcquisition_triAdresseLocalisationAvecCodeEspace/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/post_filtrerContenants_avecIdAcquisition_triAdresseLocalisationAvecCodeEspace/http-response.adoc[]

[[services-pistard-commun-acquisition-contenant-filtrerAssociesNoAcquisition]]
===== Filtrer les contenants selon un numéro d'acquisition et un centre d'archives

====== Exemple de requête

include::{snippets}/post_filtrerContenants_avecNoAcquisition_triDimensions/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/post_filtrerContenants_avecNoAcquisition_triDimensions/http-response.adoc[]

[[services-pistard-commun-acquisition-contenant-filtrerAssociesNoAcquisitionEtNoContenant]]
===== Filtrer les contenants selon un numéro d'acquisition, un numéro de contenant et un centre d'archives

====== Exemple de requête

include::{snippets}/post_filtrerContenants_avecNoContenant/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/post_filtrerContenants_avecNoContenant/http-response.adoc[]

[[services-pistard-commun-acquisition-contenant-filtrerAssociesTablette]]
===== Filtrer les contenants pour une tablette
 
====== Exemple de requête

include::{snippets}/post_filtrerContenants_avecIdLocalisationTablette_triNoContenant/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/post_filtrerContenants_avecIdLocalisationTablette_triNoContenant/http-response.adoc[]

[[services-pistard-commun-acquisition-contenant-filtrerAssociesUnite]]
===== Filtrer les contenants pour une unité de description

Voici les critères de recherche possibles pour filtrer les contenants pour une unité de description avec la possibilité d'inclure les contenants indirectement associés à l'unité de description :

 * idUniteDescription : Identifiant d'une unité de description.
 * indInclureContenantsIndirects : Indicateur pour inclure les contenants indirectement associés à l'unité de description. Cet indicateur est utilisé seulement si un idUniteDescription est fourni.
 
====== Exemple de requête

include::{snippets}/post_filtrerContenants_avecIdUniteDescription_triDescDimensions/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/post_filtrerContenants_avecIdUniteDescription_triDescDimensions/http-response.adoc[]

[[services-pistard-commun-acquisition-contenant-filtrerAssociesUniteEtAcquisition]]
===== Filtrer les contenants pour une acquisition et qui ne sont pas associés à l'unité de description

Voici les critères de recherche possibles pour filtrer les contenants pour une acquisition avec la possibilité d'exclure les contenants directement associés à l'unité de description :

 * idAcquisition : Identifiant d'une acquisition.
 * noAcquisition : Le numéro d'une acquisition dans le format YYYY-MM-SSS (Ex. 2018-09-005).
 * noContenant : Le numéro de contenant. Valeur numérique optionnelle. Pour être considérée, un numéro d'acquisition doit être fourni.
 * idUniteDescription : Identifiant d'une unité de description.
 * indExclureContenantsDirects : Indicateur pour exclure les contenants directement associés à l'unité de description. Cet indicateur est utilisé seulement si un idUniteDescription est fourni.

pass:q[<u>*Les préconditions*</u>] pour filtrer les contenants pour une unité de description et une acquisition sont :

 * Si aucune acquisition avec le noAcquisition ou l'identifiant idAcquisition fourni est associée à l'UD ou à l'un de ses parents un code HTTP 412 est retourné.

====== Exemple de requête

include::{snippets}/post_filtrerContenants_avecIdUniteDescriptionEtAcquisition_exclureContenantDirects/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/post_filtrerContenants_avecIdUniteDescriptionEtAcquisition_exclureContenantDirects/http-response.adoc[]

[[services-pistard-commun-acquisition-contenant-obtenir]]
==== Obtenir un contenant

pass:q[<u>*La précondition*</u>] pour obtenir un contenant est :

 * Un contenant doit exister selon l'identifiant fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/get_obtenirContenant/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_obtenirContenant/http-response.adoc[]


[[services-pistard-commun-acquisition-contenant-dimensions-obtenir]]
==== Obtenir les dimensions de contenant

===== Exemple de requête

include::{snippets}/get_obtenirDimensionsContenant/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_obtenirDimensionsContenant/http-response.adoc[]


[[services-pistard-commun-acquisition-contenant-creer]]
==== Créer un ou plusieurs contenants pour une acquisition

pass:q[<u>*Les préconditions*</u>] pour créer un ou plusieurs contenants pour une acquisition sont :

 * Une acquisition doit exister selon l'identifiant fourni sinon un code HTTP 404 est retourné.
 * La largeur doit être fournie sinon un code HTTP 400 est retourné.
 * L'usager interne doit être responsable des espaces de conservation (RESPONSABLE_ESPACE), archiviste (PROFESSIONNEL) ou soutien (SOUTIEN) et être autorisé à créer un contenant pour cette acquisition sinon un code HTTP 403 est retourné.

===== Exemple de requête

include::{snippets}/post_creerContenants/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/post_creerContenants/http-response.adoc[]


[[services-pistard-commun-acquisition-contenant-modifier]]
==== Modifier un contenant

pass:q[<u>*Les préconditions*</u>] pour modifier un contenant sont :

 * Un contenant doit exister selon l'identifiant fourni sinon un code HTTP 404 est retourné.
 * La largeur doit être fourni sinon un code HTTP 400 est retourné.
 * L'usager interne doit être responsable des espaces de conservation (RESPONSABLE_ESPACE), archiviste (PROFESSIONNEL) ou soutien (SOUTIEN) et être autorisé à modifier le contenant sinon un code HTTP 403 est retourné.
 * Les dimensions du contenant localisé doivent respecter l'espace disponible sur la tablette sinon un code HTTP 409 est retourné.
 * La largeur du contenant localisé sur une tablette doit être au minimum la largeur du contenant au-dessus s'il y en a un et au maximum la largeur du contenant en-dessous s'il y en a un sinon un code HTTP 409 est retourné.
 * La profondeur du contenant localisé sur une tablette doit être au minimum la profondeur du contenant au-dessus s'il y en a un et au maximum la largeur du contenant en-dessous s'il y en a un sinon un code HTTP 409 est retourné.

===== Exemple de requête

include::{snippets}/put_modifierContenant/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/put_modifierContenant/http-response.adoc[]


[[services-pistard-commun-acquisition-contenant-supprimer]]
==== Supprimer un ou plusieurs contenants

pass:q[<u>*Les préconditions*</u>] pour supprimer un ou plusieurs contenants sont :

 * Un contenant doit exister pour chaque identifiant fourni sinon un code HTTP 404 est retourné.
 * L'usager interne doit être responsable des espaces de conservation (RESPONSABLE_ESPACE), archiviste (PROFESSIONNEL) ou soutien (SOUTIEN) et être autorisé à supprimer le contenant sinon un code HTTP 403 est retourné.

===== Exemple de requête

include::{snippets}/delete_supprimerContenants/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/delete_supprimerContenants/http-response.adoc[]

[[services-pistard-commun-acquisition-contenant-localiser]]
==== Localiser un contenant

pass:q[<u>*Les préconditions*</u>] pour localiser un contenant sont :

 * Un contenant doit exister selon l'identifiant fourni sinon un code HTTP 404 est retourné.
 * Une localisation doit exister selon l'identifiant fourni sinon un code HTTP 404 est retourné.
 * Le centre d'archives de l'acquisition du contenant doit être le même que celui de la localisation choisie sinon un code HTTP 400 est retourné.
 * La position, le type de position et le niveau doivent être fournis sinon un code HTTP 400 est retourné.
 * L'usager interne doit être responsable des espaces de conservation (RESPONSABLE_ESPACE) et être autorisé à localiser le contenant sinon un code HTTP 403 est retourné.
 * L'espace choisi pour occuper le contenant ne doit pas être occupé par un autre contenant sinon un code HTTP 409 est retourné.
 * L'espace choisi pour occuper le contenant doit être un espace libre sur la tablette sinon un code HTTP 412 est retourné.

La requête pour localiser un contenant est dans le format : PUT /service/contenant/{idContenant}/localiser/{idLocalisationTablette}

===== Exemple de requête

include::{snippets}/put_localiserContenant/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/put_localiserContenant/http-response.adoc[]


[[services-pistard-commun-acquisition-contenant-delocaliser]]
==== Délocaliser un ou plusieurs contenants

pass:q[<u>*Les préconditions*</u>] pour délocaliser un ou plusieurs contenants sont :

 * Un contenant doit exister pour chaque identifiant fourni sinon un code HTTP 404 est retourné.
 * L'usager interne doit être responsable des espaces de conservation (RESPONSABLE_ESPACE) et être autorisé à délocaliser le contenant sinon un code HTTP 403 est retourné.

===== Exemple de requête

include::{snippets}/patch_delocaliserContenants/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/patch_delocaliserContenants/http-response.adoc[]


[[services-pistard-commun-acquisition-contenant-produireEtiquette]]
==== Produire l'étiquette d'un ou plusieurs contenants

Ce service web désactive l'indicateur d'impression requise et produit l'étiquette d'un ou plusieurs contenants.

pass:q[<u>*Les préconditions*</u>] pour produire l'étiquette d'un ou plusieurs contenants sont :

 * Un contenant doit exister pour chaque identifiant fourni sinon un code HTTP 404 est retourné.
 * L'usager interne doit être responsable des espaces de conservation (RESPONSABLE_ESPACE) et être autorisé à imprimer l'étiquette de chaque contenant sinon un code HTTP 403 est retourné.

===== Exemple de requête

include::{snippets}/patch_produireEtiquetteContenants/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/patch_produireEtiquetteContenants/http-response.adoc[]


[[services-pistard-commun-acquisition-noteSuivi]]
=== Note de suivi d'une acquisition

Les services Web pour la gestion des notes de suivi d'une acquisition permettent :

 * <<services-pistard-commun-acquisition-noteSuivi-obtenirListe>>
 * <<services-pistard-commun-acquisition-noteSuivi-obtenir>>
 * <<services-pistard-commun-acquisition-noteSuivi-ajouter>>
 * <<services-pistard-commun-acquisition-noteSuivi-modifier>>
 * <<services-pistard-commun-acquisition-noteSuivi-supprimer>>

Note : Pour les notes de suivi ajoutées par le système, *typeSuivi* a la valeur *SYS* et les informations du *responsable* peuvent être ignorées.

Voici les valeurs possibles pour *typeSuivi* :

 * SYS - Note de suivi ajoutée par le système.
 * INT - Note de suivi interne ajoutée par un employé.
 * DCR - Note de suivi ajoutée par un archiviste pour une demande de modifications.
 * CCR - Note de suivi ajoutée par un usager externe pour confirmer les modifications effectuées.

[[services-pistard-commun-acquisition-noteSuivi-obtenirListe]]
==== Obtenir les notes de suivi d'une acquisition

Les notes de suivi sont triées par odre croissant sur la date de suivi.

Le service web pour obtenir les notes de suivi d'une acquisition permet retourner seulement les notes de suivi que l'usager peut consulter. Ainsi les usagers externes ne recevront pas les notes de suivi internes qui sont réservées pour une consultation par les usagers internes (employés des centres d'archives).

pass:q[<u>*La précondition*</u>] pour obtenir les notes de suivi d'une acquisition est :

 * Une acquisition doit exister selon l'identifiant fourni sinon un code HTTP 404 est retourné.

Voici les exemples d'utilisation du service web pour obtenir les notes de suivi d'une acquisition :

 * <<services-pistard-commun-acquisition-noteSuivi-obtenirListe-usagerInterne>>
 * <<services-pistard-commun-acquisition-noteSuivi-obtenirListe-usagerExterne>>

[[services-pistard-commun-acquisition-noteSuivi-obtenirListe-usagerInterne]]
===== Obtenir les notes de suivi d'une acquisition pour un usager interne

====== Exemple de requête

include::{snippets}/get_obtenirNotesSuivi_PourUsagerInterne/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/get_obtenirNotesSuivi_PourUsagerInterne/http-response.adoc[]


[[services-pistard-commun-acquisition-noteSuivi-obtenirListe-usagerExterne]]
===== Obtenir les notes de suivi d'une acquisition pour un usager externe

====== Exemple de requête

include::{snippets}/get_obtenirNotesSuivi_PourUsagerExterne/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/get_obtenirNotesSuivi_PourUsagerExterne/http-response.adoc[]


[[services-pistard-commun-acquisition-noteSuivi-obtenir]]
==== Obtenir une note de suivi d'une acquisition

pass:q[<u>*La précondition*</u>] pour obtenir une note de suivi est :

 * Une note de suivi doit exister selon l'identifiant fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/get_obtenirNoteSuivi/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_obtenirNoteSuivi/http-response.adoc[]


[[services-pistard-commun-acquisition-noteSuivi-ajouter]]
==== Ajouter une note de suivi pour une acquisition

pass:q[<u>*La précondition*</u>] pour ajouter une note de suivi pour une acquisition est :

 * Une acquisition doit exister selon l'identifiant fourni sinon un code HTTP 404 est retourné.

Voici les exemples d'utilisation du service web pour ajouter une note de suivi pour une acquisition :

 * <<services-pistard-commun-acquisition-noteSuivi-ajouter-int>>
 * <<services-pistard-commun-acquisition-noteSuivi-ajouter-dcr>>
 * <<services-pistard-commun-acquisition-noteSuivi-ajouter-ccr>>

[[services-pistard-commun-acquisition-noteSuivi-ajouter-int]]
===== Ajouter une note de suivi interne pour une acquisition

====== Exemple de requête

include::{snippets}/post_ajouterNoteSuivi_int/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/post_ajouterNoteSuivi_int/http-response.adoc[]


[[services-pistard-commun-acquisition-noteSuivi-ajouter-dcr]]
===== Ajouter une note de suivi par un archiviste pour une demande de modifications d'un versement

====== Exemple de requête

include::{snippets}/post_ajouterNoteSuivi_dcr/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/post_ajouterNoteSuivi_dcr/http-response.adoc[]


[[services-pistard-commun-acquisition-noteSuivi-ajouter-ccr]]
===== Ajouter une note de suivi par un usager externe pour confirmer les modifications effectuées à un versement

====== Exemple de requête

include::{snippets}/post_ajouterNoteSuivi_ccr/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/post_ajouterNoteSuivi_ccr/http-response.adoc[]


[[services-pistard-commun-acquisition-noteSuivi-modifier]]
==== Modifier une note de suivi

Le service web pour modifier une note de suivi permet la modification d'une note de suivi :

 * Système (typeSuivi = 'SYS') seulement par un administrateur sinon un code HTTP 412 est retourné.
 * Interne (typeSuivi = 'INT') seulement par son créateur sinon un code HTTP 412 est retourné.

Ainsi les usagers externes n'ont pas accès à modifier une note de suivi.

pass:q[<u>*La précondition*</u>] pour modifier une note de suivi est :

 * Une note de suivi doit exister selon l'identifiant fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/put_modifierNoteSuivi_int/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/put_modifierNoteSuivi_int/http-response.adoc[]


[[services-pistard-commun-acquisition-noteSuivi-supprimer]]
==== Supprimer une note de suivi

Le service web pour supprimer une note de suivi permet seulement la suppression d'une note de suivi :

 * Système (typeSuivi = 'SYS') seulement par un administrateur sinon un code HTTP 412 est retourné.
 * Interne (typeSuivi = 'INT') seulement par son créateur sinon un code HTTP 412 est retourné.

Ainsi les usagers externes n'ont pas accès à supprimer une note de suivi.

pass:q[<u>*La précondition*</u>] pour supprimer une note de suivi est :

 * Une note de suivi doit exister selon l'identifiant fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/delete_supprimerNoteSuivi_int/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/delete_supprimerNoteSuivi_int/http-response.adoc[]


[[services-pistard-acquisition-privee-offreAcquisition]]
=== Offre d'acquisition privée

Les services Web pour les offres d'acquisition permettent :

 * <<services-pistard-acquisition-privee-offreAcquisition-chercher>>
 * <<services-pistard-acquisition-privee-offreAcquisition-formulaireDonateur>>
 * <<services-pistard-acquisition-privee-offreAcquisition-creer>>
 * <<services-pistard-acquisition-privee-offreAcquisition-obtenir>>
 * <<services-pistard-acquisition-privee-offreAcquisition-obtenirEnEcriture>>
 * <<services-pistard-acquisition-privee-offreAcquisition-libererVerrou>>
 * <<services-pistard-acquisition-privee-offreAcquisition-sauvegarder>>
 * <<services-pistard-acquisition-privee-offreAcquisition-supprimer>>
 * <<services-pistard-acquisition-privee-offreAcquisition-completer>>
 * <<services-pistard-acquisition-privee-offreAcquisition-analyser>>
 * <<services-pistard-acquisition-privee-offreAcquisition-documenter>>
 * <<services-pistard-acquisition-privee-offreAcquisition-statuer>>
 * <<services-pistard-acquisition-privee-offreAcquisition-enregistrer>>
 * <<services-pistard-acquisition-privee-offreAcquisition-debuterTraitement>>
 * <<services-pistard-acquisition-privee-offreAcquisition-finaliserTraitement>>
 * <<services-pistard-acquisition-privee-offreAcquisition-evaluer>>


[[services-pistard-acquisition-privee-offreAcquisition-chercher]]
==== Chercher des offres d'acquisitions

Voici le nom des critères supportés pour la recherche des offres d'acquisition :

 * noAcquisition - Numéro d'acquisition.
 * ancienNoAcquisition - Ancien numéro de l'offre.
 * titre - Titre de l'offre.
 * dateOffreMin - Borne inférieure de la date de l'offre.
 * dateOffreMax - Borne supérieure de la date de l'offre.
 * codeCentreArchive - Code du centre d'archives BAnQ.
 * codeEmployeAttitre - Code de l'employé attitré à l'offre.
 * nbJoursAssignation - Nombre de jours d'assignation à l'offre.
 * statuts - Liste des codes de statut.
 * statutAssignation - Liste des statuts d'assignation.
 * indEnSuspens - Indicateur en suspens.
 * typeDeDons - Liste des types de don.
 * valeurPrescription - Valeur OUI ou NON pour la prescription acquisitive.
 * dateEntreeVigueurMin - Borne inférieure de la date d'entrée en vigueur de l'offre.
 * dateEntreeVigueurMax - Borne supérieure de la date d'entrée en vigueur de l'offre.
 * modeAcquisitions - Liste des modes d'acquisition.
 * prenomDonateur - Prénom du donateur.
 * nomDonateur - Nom du donateur.
 * nomOrganisme - Nom de l'organisme du donateur.
 * adressePostale - Adresse postale du donateur.
 * codeClasse - Code de classe.
 * noFonds - Numéro de fonds.
 * titreFonds - Titre de l'offre.
 * nomCreateurEtContextCreationFonds - Nom du créateur et contexte de création du fonds.
 * descriptionSommaireDocumentsOfferts - Description sommaire des documents offerts.
 * datePresentationMin - Borne inférieure de la date de présentation de l'offre.
 * datePresentationMax - Borne supérieure de la date de présentation de l'offre.
 * noConventionDonation - Numéro de convention de donation.
 * typeTitulaires - Liste des types de titulaires.
 * codesConditionsUtilisation - Liste des codes des conditions d'utilisation.
 * typeEvaluations - Liste des types d'évaluation.
 * valeurDemandeAttestation - Valeur OUI ou NON pour la demande d'attestion.
 * dateEvaluationMin - Borne inférieure de la date d'évaluation de l'offre.
 * dateEvaluationMax - Borne supérieure de la date d'évaluation de l'offre.
 * noteSuivi - Note de suivi.
 * dateSuiviMin - Borne inférieure de la date de suivi de l'offre.
 * dateSuiviMax - Borne supérieure de la date de suivi de l'offre.

Le tri par défaut est selon la séquence de l'étape et ensuite descendant sur le numéro d'acquisition associée à l'offre d'acquisition.

Voici le nom des champs possibles pour trier les résultats de recherche :

 * noAcquisition - Pour un tri sur la colonne 'Numéro'.
 * cedant - Pour un tri sur la colonne 'Cédant'.
 * dateOffre - Pour un tri sur la colonne 'Date'.
 * nomCentreArchive - Pour un tri sur la colonne 'Centre de BAnQ'.
 * sequenceStatut - Pour un tri sur la colonne 'Statut'.
 * sequenceEtape - Pour un tri sur la colonne 'Étape'.

===== Exemple de requête

include::{snippets}/post_chercherOffres_tri_parDefaut/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/post_chercherOffres_tri_parDefaut/http-response.adoc[]


[[services-pistard-acquisition-privee-offreAcquisition-formulaireDonateur]]
==== Créer une offre d'acquisition à partir du formulaire du donateur

Le formulaire du donateur est accédé à partir du portail Web de la BAnQ par un citoyen qui souhaite proposer des archives privées. Le service web POST utilisé par ce formulaire du donateur est donc accessible depuis l'extérieur de l'application Advitam (/service_ext) afin de permettre la création d'une offre d'acquisition suite à la soumission de ce formulaire du donateur.

===== Exemple de requête

include::{snippets}/post_formulaireDonateur/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/post_formulaireDonateur/http-response.adoc[]


[[services-pistard-acquisition-privee-offreAcquisition-creer]]
==== Créer une offre d'acquisition à l'interne

===== Exemple de requête

include::{snippets}/post_creerOffre/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/post_creerOffre/http-response.adoc[]


[[services-pistard-acquisition-privee-offreAcquisition-obtenir]]
==== Obtenir une offre d'acquisition

À plusieurs endroits dans l'application, on affiche le récapitulatif de l'offre d'acquisition.
Ce récapitulatif est obtenu en effectuant un GET sur la ressource offreAcquisition avec l'id de l'acquisition associée à l'offre concernée.
Au fur et à mesure que l'offre d'acquisition se construit (compléter, analyser, statuer, etc.) le payload retourné pour l'offre d'acquisition évolue avec les informations ajoutées.

pass:q[<u>*La précondition*</u>] pour obtenir une offre d'acquisition est :

 * Une offre d'acquisition doit exister selon l'identifiant fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/get_offreByIdAcquisition/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_offreByIdAcquisition/http-response.adoc[]


[[services-pistard-acquisition-privee-offreAcquisition-obtenirEnEcriture]]
==== Obtenir une offre d'acquisition en écriture

Pour modifier une offre d'acquisition, l'usager doit d'abord obternir un verrou.

Si l'offre est déja verrouillée en écriture par un autre usager depuis moins de 30 minutes alors un code HTTP 412 est retourné.

Si l'utilisateur n'a pas les rôles suffisants pour éditer une offre alors une code HTTP 403 est retourné.

Lors de la modification d'une offre, un code HTTP 403 est retourné si l'utilisateur n'a pas le verrou.

pass:q[<u>*La précondition*</u>] pour obtenir une offre d'acquisition est :

 * Une offre d'acquisition doit exister selon l'identifiant fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/get_offreByIdAcquisition_ecriture/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_offreByIdAcquisition_ecriture/http-response.adoc[]


[[services-pistard-acquisition-privee-offreAcquisition-libererVerrou]]
==== Libérer le verrou d'édition sur une offre d'acquisition

Pour libérer explicitement le verrou sur une offre d'acquisition.

Le verrou pour une offre est libéré automatiquement lorsque :

 * Le temps du verrou de 30 minutes est expiré.
 * L'offre d'acquisition est complétée.
 * L'offre d'acquisition est analysée.
 * L'offre d'acquisition est statuée.
 * L'offre d'acquisition est enregistrée.
 * L'offre d'acquisition est supprimée.

===== Exemple de requête

include::{snippets}/get_deverrouilleOffre/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_deverrouilleOffre/http-response.adoc[]


[[services-pistard-acquisition-privee-offreAcquisition-sauvegarder]]
==== Sauvegarder une offre d'acquisition

La sauvegarde d'une offre d'acquisition enregistre en base de données les informations sans les valider.
Ce service peut-être appelé pour sauvegarder les informations de l'offre ou bien par exemple pour suspendre une offre en activant l'indicateur indEnSuspens.
Pour sauvegarder une offre d'acquisition, l'usager doit préalablement obtenir le verrou en écriture sur l'offre (Voir <<services-pistard-acquisition-privee-offreAcquisition-obtenirEnEcriture>>).

Si l'offre est sauvegardée correctement, l'ancienne version est automatiquement enlevée de la cache pour remettre en cache la nouvelle version de l'offre.

L'utilisation de l'ancienne version de la requête de sauvegarde d'une offre d'acquisition *PUT /service/offreAcquisition/sauvegarder/1* doit être remplacée par la nouvelle version standard en enlevant */sauvegarder* du lien.

===== Exemple de requête

include::{snippets}/put_sauvegarderOffre/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/put_sauvegarderOffre/http-response.adoc[]


[[services-pistard-acquisition-privee-offreAcquisition-supprimer]]
==== Supprimer une offre d'acquisition

Une offre d'acquisition n'est jamais supprimée physiquement en base de données. On active simplement l'indicateur indSupprime de l'acquisition associée à l'offre.

pass:q[<u>*Les préconditions*</u>] pour compléter une offre d'acquisition sont :

 * L'offre doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * L'usager interne doit être assigné à l'offre ou bien avoir les privilèges nécessaires sinon un code HTTP 403 est retourné.
 * L'offre doit être assignée et le statut *NOUV - Nouvelle* ou *REAF - Réaffectée* sinon un code HTTP 412 est retourné.

Pour supprimer une offre d'acquisition, l'usager doit préalablement obtenir le verrou en écriture sur l'offre (Voir <<services-pistard-acquisition-privee-offreAcquisition-obtenirEnEcriture>>).

===== Exemple de requête

include::{snippets}/delete_supprimerOffre/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/delete_supprimerOffre/http-response.adoc[]


[[services-pistard-acquisition-privee-offreAcquisition-completer]]
==== Compléter une offre d'acquisition

pass:q[<u>*Les préconditions*</u>] pour compléter une offre d'acquisition sont :

 * L'offre doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * L'usager interne doit être assigné à l'offre ou bien avoir les privilèges nécessaires sinon un code HTTP 403 est retourné.
 * L'offre doit être assignée et le statut *NOUV - Nouvelle* ou *REAF - Réaffectée* sinon un code HTTP 412 est retourné.

Pour compléter une offre d'acquisition, l'usager doit préalablement obtenir le verrou en écriture sur l'offre (Voir <<services-pistard-acquisition-privee-offreAcquisition-obtenirEnEcriture>>).

À cette étape, le statut de l'offre d'acquisition est mis à jour à *COMP - Complété*.

===== Exemple de requête

include::{snippets}/put_completerOffre/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/put_completerOffre/http-response.adoc[]


[[services-pistard-acquisition-privee-offreAcquisition-analyser]]
==== Analyser une offre d'acquisition

Ce cas d'utilisation permet d'afficher le récapitulatif de l'offre et de soumettre une offre d'acquisition.
Le récapitulatif de l'offre est obtenu classiquement par un GET sur la ressource offreAcquisition avec l'id concerné (link:#offreAcquisition[ici]).

Pour soumettre une analyse, un simple PUT permet de modifier l'offre d'acquisition avec l'analyse effectuée.

Le payload de soumission contient également les informations du donateur afin de pouvoir éventuellement modifier les informations du donateur.

pass:q[<u>*Les préconditions*</u>] pour soumettre l'analyse d'une offre d'acquisition sont :

 * L'offre doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * L'usager interne doit être assigné à l'offre ou bien avoir les privilèges nécessaires sinon un code HTTP 403 est retourné.
 * L'offre doit être assignée et le statut *COMP - Complété* sinon un code HTTP 412 est retourné.
  
Pour anaylser une offre d'acquisition, l'usager doit préalablement obtenir le verrou en écriture sur l'offre (Voir <<services-pistard-acquisition-privee-offreAcquisition-obtenirEnEcriture>>).

===== Exemple de requête

include::{snippets}/put_analyserOffre/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/put_analyserOffre/http-response.adoc[]


[[services-pistard-acquisition-privee-offreAcquisition-documenter]]
==== Documenter une offre d'acquisition

pass:q[<u>*Les préconditions*</u>] pour documenter une offre d'acquisition sont :

 * L'offre doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * L'offre doit avoir au moins une collation approximative valide sinon un code HTTP 400 est retourné.
 * L'usager interne doit être assigné à l'offre ou bien avoir les privilèges nécessaires sinon un code HTTP 403 est retourné.
 * L'offre doit être assignée et avec les statuts *ACCP - Acceptée* sinon un code HTTP 412 est retourné.
  
Pour documenter une offre d'acquisition, l'usager doit préalablement obtenir le verrou en écriture sur l'offre (Voir <<services-pistard-acquisition-privee-offreAcquisition-obtenirEnEcriture>>).

À cette étape, le statut de l'offre d'acquisition est mis à jour à *DOCU - Documentée*.

===== Exemple de requête

include::{snippets}/put_documenterOffre/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/put_documenterOffre/http-response.adoc[]


[[services-pistard-acquisition-privee-offreAcquisition-statuer]]
==== Statuer sur une offre d'acquisition

pass:q[<u>*Les préconditions*</u>] pour statuer sur une offre d'acquisition sont :

 * L'offre doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * L'usager interne doit être assigné à l'offre ou bien avoir les privilèges nécessaires sinon un code HTTP 403 est retourné.
 * L'offre doit être assignée et le statut *DOCU - Documentée* sinon un code HTTP 412 est retourné.
  
Pour statuer sur une offre d'acquisition, l'usager doit préalablement obtenir le verrou en écriture sur l'offre (Voir <<services-pistard-acquisition-privee-offreAcquisition-obtenirEnEcriture>>).

À cette étape, le statut de l'offre d'acquisition peut être mis à jour à l'un des statuts suivants selon la décision rendue :

  * *REFU - Refusée*
  * *REDI - Redirigée*
  * *ACCP - Acceptée*

===== Exemple de requête

include::{snippets}/put_statuerOffre/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/put_statuerOffre/http-response.adoc[]


[[services-pistard-acquisition-privee-offreAcquisition-enregistrer]]
==== Enregistrer une offre d'acquisition

pass:q[<u>*Les préconditions*</u>] pour enregistrer une offre d'acquisition sont :

 * L'offre doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * L'usager interne doit être assigné à l'offre ou bien avoir les privilèges nécessaires sinon un code HTTP 403 est retourné.
 * L'offre doit être assignée et le statut *APPR - Approuvée* sinon un code HTTP 412 est retourné.

Pour enregistrer une offre d'acquisition, l'usager doit préalablement obtenir le verrou en écriture sur l'offre (Voir <<services-pistard-acquisition-privee-offreAcquisition-obtenirEnEcriture>>).

À cette étape, le statut de l'offre d'acquisition est mis à jour à *ENRE - Enregistrée*.

===== Exemple de requête

include::{snippets}/put_enregistrerOffre/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/put_enregistrerOffre/http-response.adoc[]


[[services-pistard-acquisition-privee-offreAcquisition-debuterTraitement]]
==== Débuter le traitement d'une offre d'acquisition

pass:q[<u>*Les préconditions*</u>] pour débuter le traitement d'une offre d'acquisition sont :

 * L'offre doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * L'usager interne doit être un archiviste assigné à l'offre sinon un code HTTP 403 est retourné.
 * L'offre doit être au statut *ENRE - Enregistrée* sinon un code HTTP 412 est retourné.
  
Pour débuter le traitement d'une offre d'acquisition, l'usager doit préalablement obtenir le verrou en écriture sur l'offre (Voir <<services-pistard-acquisition-privee-offreAcquisition-obtenirEnEcriture>>).

À cette étape, le statut de l'offre d'acquisition est mis à jour à *ETRA - En traitement*.

===== Exemple de requête

include::{snippets}/patch_debuterTraitementOffre/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/patch_debuterTraitementOffre/http-response.adoc[]


[[services-pistard-acquisition-privee-offreAcquisition-finaliserTraitement]]
==== Finaliser le traitement d'une offre d'acquisition

pass:q[<u>*Les préconditions*</u>] pour finaliser le traitement d'une offre d'acquisition sont :

 * L'offre doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * L'usager interne doit être un archiviste assigné à l'offre sinon un code HTTP 403 est retourné.
 * L'offre doit être au statut *ETRA - En traitement* et qu'il soit possible de finaliser son traitement sinon un code HTTP 412 est retourné.

Pour finaliser le traitement d'une offre d'acquisition, l'usager doit préalablement obtenir le verrou en écriture sur l'offre (Voir <<services-pistard-acquisition-privee-offreAcquisition-obtenirEnEcriture>>).

À cette étape, une vérification est faite pour déterminer si une évaluation monétaire est requise pour l'offre :

 * Si aucune évaluation monétaire est requise, le statut de l'offre d'acquisition est mis à jour à *TRAT - Traitée*.
 * Si une évaluation monétaire est requise, le statut de l'offre d'acquisition est mis à jour à *EVAL - À évaluer*.

===== Exemple de requête

include::{snippets}/patch_finaliserTraitementOffre/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/patch_finaliserTraitementOffre/http-response.adoc[]


[[services-pistard-acquisition-privee-offreAcquisition-evaluer]]
==== Évaluer une offre d'acquisition

pass:q[<u>*Les préconditions*</u>] pour évaluer une offre d'acquisition sont :

 * L'offre doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * L'usager interne doit être un coordonnateur pour pouvoir évaluer l'offre sinon un code HTTP 403 est retourné.
 * L'offre doit être assignée et le statut *EVAL - À évaluer* sinon un code HTTP 412 est retourné.
  
Pour évaluer une offre d'acquisition, l'usager doit préalablement obtenir le verrou en écriture sur l'offre (Voir <<services-pistard-acquisition-privee-offreAcquisition-obtenirEnEcriture>>).

À cette étape, le statut de l'offre d'acquisition est mis à jour à *TRAT - Traitée*.

===== Exemple de requête

include::{snippets}/put_evaluerOffre/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/put_evaluerOffre/http-response.adoc[]


[[services-pistard-acquisition-publique-versement]]
=== Versement d'acquisition publique

Les services Web pour les versements publiques permettent :

 * <<services-pistard-acquisition-publique-versement-chercher>>
 * <<services-pistard-acquisition-publique-versement-creer>>
 * <<services-pistard-acquisition-publique-versement-obtenir>>
 * <<services-pistard-acquisition-publique-versement-modifier>>
 * <<services-pistard-acquisition-publique-versement-libererVerrou>>
 * <<services-pistard-acquisition-publique-versement-annuler>>
 * <<services-pistard-acquisition-publique-versement-retourEnPreparation>>
 * <<services-pistard-acquisition-publique-versement-recommanderTransfert>>
 * <<services-pistard-acquisition-publique-versement-transferer>>
 * <<services-pistard-acquisition-publique-versement-enregistrer>>
 * <<services-pistard-acquisition-publique-versement-debuterTraitement>>
 * <<services-pistard-acquisition-publique-versement-finaliserTraitement>>
 * <<services-pistard-acquisition-publique-versement-produireBordereau>>

Voici les types de versement d'archives *typeVersement* possibles avec les types de documents versés *typeDocumentVersement* possibles pour chacun :

 * GOUV - Gourvernemental
 ** DOS - Dossier gouvernemental (analogique et/ou numérique)
 * CIVI - Directeur de l'état civil
 ** REG - Registre de l'état civil (analogique seulement)
 * COUR - Cour municipale
 ** ADM - Document administratif (analogique et/ou numérique)
 * JUDI - Tribunal provincial
 ** ADM - Document administratif (analogique et/ou numérique)
 ** JUD - Document et cause judiciaire (analogique et/ou numérique)
 ** JRN - Registre judiciaire (numérique seulement)

Voici les rôles des employés et des utilisateurs externes pouvant intervenir au niveau d'un versement à partir de Advitam :

 * Employés considérés comme usagers internes :
 ** DIRECTION - Directeur d'un centre d'archives BAnQ
 ** COORDONNATEUR - Coordonnateur d'un centre d'archives BAnQ
 ** PROFESSIONNEL - Archiviste d'un centre d'archives BAnQ
 ** SOUTIEN - Soutien d'un centre d'archives BAnQ
 * Utilisateurs externes considérés comme usagers externes :
 ** RESPONSABLE_ORGANISME - Responsable des versements
 ** SOUTIEN_ORGANISME - Soutien au responsable des versements

Voici les codes de statut *codeStatut* possibles pour un versement publique :

 * PRE - En préparation - Lorsque le versement a été créé par un usager externe.
 * ATT - En attente de transfert - Lorsque le versement a été recommandé par un usager externe ayant un rôle de soutien pour un transfert à un centre d'archives BAnQ.
 * TRA - Transféré - Lorsque le versement a été transféré par un usager externe ayant un rôle de responsable des versements.
 * MOD - À modifier - Lorsqu'une demande de modifications a été envoyée au créateur du versement. 
 * ENR - Enregistré - Lorsque le versement a été enregistré par un archiviste responsable de la DGAN.
 * ETR - En traitement - Lorsqu'un archiste responsable de la DGAN a débuté le traitement du versement.
 * TRT - Traité - Lorsque le traitement du versement a été finalisé par un archiviste responsable de la DGAN.
 * ANN - Annulé - Lorsqu'un versement a été supprimé par un usager externe ou annulé par un usager interne.


[[services-pistard-acquisition-publique-versement-chercher]]
==== Chercher des versements

Le service web pour chercher des versements permettent :

 * <<services-pistard-acquisition-publique-versement-chercherPourExterne>>
 * <<services-pistard-acquisition-publique-versement-chercherPourInterne-mesVersements>>
 * <<services-pistard-acquisition-publique-versement-chercherPourInterne-avecCriteres>>

Voici le nom des critères supportés pour la recherche des versements :

 * noAcquisition - Numéro d'acquisition.
 * codeStatuts - Liste des codes de statut.
 * typesVersement - Liste des types de versement.
 * idOrganisme - Identifiant de l'organisme.
 * indMonCentreBAnQ - Activer cet indicateur pour limiter la recherche aux versements du centre d'archives de l'usager effectuant la recherche.
 * indMesVersements - Activer cet indicateur pour limiter la recherche aux versements assignés à l'usager effectuant la recherche.
 * dateStatutDebut - Borne inférieure pour la date du statut.
 * dateStatutFin - Borne supérieure pour la date du statut.

Le tri par défaut est descendant sur le numéro d'acquisition associée au versement.

Voici le nom des champs possibles pour trier les résultats de recherche :

 * noAcquisition - Pour un tri sur la colonne 'No versement'.
 * typeArchivesVerseesLibelle - Pour un tri sur la colonne 'Archives versées'.
 * typeDocumentVersement - Pour un tri sur la colonne 'Documents versés'.
 * indAnaNum - Pour un tri sur la colonne 'Type de versement'.
 * nomCentreArchive - Pour un tri sur la colonne 'Centre de BAnQ'.
 * nomOrganisme - Pour un tri sur la colonne 'Organisme et greffe'.
 * greffe - Pour un tri sur la colonne 'Greffe'.
 * codeStatut - Pour un tri sur la colonne 'Statut'.
 * dateStatut - Pour un tri sur la colonne 'Date de statut'.
 * dateCreation - Pour un tri sur la colonne 'Date de création'.
 * usagerCreation - Pour un tri sur la colonne 'Créé par'.
 * usagerTransfert - Pour un tri sur la colonne 'Transféré par'.
 * archivisteResponsableEmploye - Pour un tri sur la colonne 'Archiviste responsable'.

[[services-pistard-acquisition-publique-versement-chercherPourExterne]]
===== Chercher des versements pour un usager externe selon son organisme

Pour un usager externe, la recherche est effectuée pour trouver les versements selon son organisme.

L'identifiant de l'organisme de l'usager n'a pas à être fourni au niveau des critères de recherche, car il est ajouté par la système au niveau des critères de recherche afin que la recherche soit toujours effectuée afin de retourner les versements associés à l'organisme de l'usager externe effectuant la recherche.

Le service web pour chercher des versements pour un usager externe selon son organisme permet :

 * <<services-pistard-acquisition-publique-versement-dos-chercherPourExterne>>
 * <<services-pistard-acquisition-publique-versement-reg-chercherPourExterne>>
 * <<services-pistard-acquisition-publique-versement-adm-chercherPourExterne>>
 * <<services-pistard-acquisition-publique-versement-jud-chercherPourExterne>>
 * <<services-pistard-acquisition-publique-versement-jrn-chercherPourExterne>>

[[services-pistard-acquisition-publique-versement-dos-chercherPourExterne]]
====== Chercher des versements d'un organisme gouvernemental avec des dossiers pour un usager externe selon son organisme

======= Exemple de requête

include::{snippets}/post_chercherVersement_dos_UsagerExterne/http-request.adoc[]

======= Exemple de réponse

include::{snippets}/post_chercherVersement_dos_UsagerExterne/http-response.adoc[]

[[services-pistard-acquisition-publique-versement-reg-chercherPourExterne]]
====== Chercher des versements du directeur de l'état civil avec des registres pour un usager externe

======= Exemple de requête

include::{snippets}/post_chercherVersement_reg_UsagerExterne/http-request.adoc[]

======= Exemple de réponse

include::{snippets}/post_chercherVersement_reg_UsagerExterne/http-response.adoc[]

[[services-pistard-acquisition-publique-versement-adm-chercherPourExterne]]
====== Chercher des versements d'une cour municipale ou d'un tribunal provincial avec des documents administratifs pour un usager externe selon son organisme

======= Exemple de requête

include::{snippets}/post_chercherVersement_adm_UsagerExterne/http-request.adoc[]

======= Exemple de réponse

include::{snippets}/post_chercherVersement_adm_UsagerExterne/http-response.adoc[]

[[services-pistard-acquisition-publique-versement-jud-chercherPourExterne]]
====== Chercher des versements d'un tribunal provincial avec des documents et des causes judiciaires pour un usager externe selon son organisme

======= Exemple de requête

include::{snippets}/post_chercherVersement_jud_UsagerExterne/http-request.adoc[]

======= Exemple de réponse

include::{snippets}/post_chercherVersement_jud_UsagerExterne/http-response.adoc[]

[[services-pistard-acquisition-publique-versement-jrn-chercherPourExterne]]
====== Chercher des versements d'un tribunal provincial avec des registres judiciaires pour un usager externe selon son organisme

======= Exemple de requête

include::{snippets}/post_chercherVersement_jrn_UsagerExterne/http-request.adoc[]

======= Exemple de réponse

include::{snippets}/post_chercherVersement_jrn_UsagerExterne/http-response.adoc[]


[[services-pistard-acquisition-publique-versement-chercherPourInterne-mesVersements]]
===== Chercher 'Mes versements' pour un usager interne selon son rôle

Avec l'onglet *Mes versements*, un usager interne (employé DGAN) pourra voir les versements au statut 'TRA - Transféré' sur lesquels il peut intervenir selon son ou ses rôles.

 * Un employé avec un accès en consultation (CONSULTATION_PISTARD) pourra voir, dans la liste de ses versements, les versements transférés à son centre d'archives BAnQ.
 * Un soutien (SOUTIEN) pourra voir, dans la liste de ses versements, les versements transférés à son centre d'archives BAnQ et qui lui sont assignés.
 * Un archiviste (PROFESSIONNEL) pourra voir, dans la liste de ses versements, les versements transférés à son centre d'archives BAnQ et qui lui sont assignés.
 * Un coordonnateur (COORDONNATEUR) pourra voir, dans la liste de ses versements, les versements transférés à son centre d'archives BAnQ.
 * Un directeur (DIRECTION) pourra voir, dans la liste de ses versements, les versements transférés à tous les centres d'archives BAnQ.

====== Exemple de requête

include::{snippets}/post_chercherVersement_Interne_MesVersements_Archiviste/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/post_chercherVersement_Interne_MesVersements_Archiviste/http-response.adoc[]


[[services-pistard-acquisition-publique-versement-chercherPourInterne-avecCriteres]]
===== Chercher parmi les versements accessibles à l'interne selon certains critères

Pour un usager interne (employé DGAN), tous les versements transférés, à modifier ou enregistrés pour tous les centres d'archives BAnQ sont accessibles.

Si aucun critère de recherche est fourni pour un usager interne, la recherche retournera tous les versements de tous les centres d'archives avec le statut 'TRA - Transféré'.

Voici les critères de recherche supportés par la recherche actuellement :

 * indMonCentreBAnQ : Activer cet indicateur pour limiter la recherche aux versements du centre d'archives de l'usager effectuant la recherche.
 * indMesVersements : Activer cet indicateur pour limiter la recherche aux versements assignés à l'usager effectuant la recherche.
 * typesVersement : Un ou plusieurs de ces types de versement peuvent être mentionnés pour limiter la recherche de versements : GOUV, CIVI, COUR et JUDI
 * codeStatuts : Propriété pour ajouter les codes de statut à considérer pour la recherche. Si le statut 'TRA - Transféré' est ajouté à la liste des codes de statut, on ajoute automatiquement, le code de statut 'MOD - À modifier' à la liste des codes de statut avant d'effectuer la recherche des versements étant donné qu'on considère les versements à modifier comme des versements transférés en cours de modifications afin qu'ils soient conformes aux exigences de l'archiviste.
 * dateStatutDebut : Pour limiter les versements ayant une date de statut égale ou plus grande que la date de statut de début mentionnée.
 * dateStatutFin : Pour limiter les versements ayant une date de statut égale ou plus petite que la date de statut de fin mentionnée.

====== Exemple de requête

include::{snippets}/post_chercherVersementPublique_Interne_avecCriteres/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/post_chercherVersementPublique_Interne_avecCriteres/http-request.adoc[]

[[services-pistard-acquisition-publique-versement-creer]]
==== Créer un versement

pass:q[<u>*Les préconditions*</u>] pour créer un versement sont :

 * L'usager doit être externe sinon un code HTTP 403 est retourné.
 * Au moins une collation pour un genre de document doit être fourni dans la liste sinon un code HTTP 400 est retourné.

Voici les mises à jour effectuées automatiquement par le système avant de sauvegarder le nouveau versement :

 * Le statut est mis à jour à 'PRE - En préparation'.
 * L'organisme est mis à jour avec l'organisme de l'usager externe ayant demandé la création.
 * Le type de versement d'archives est mis à jour avec le type de versement d'archives de l'organisme.

L'organisme associé à l'usager externe qui appelle le service web est obtenu automatiquement pour déterminer le type de versement *typeVersement*. Selon le type de versement (*GOUV*, *CIVI*, *COUR*, *JUDI*), des validations supplémentaires peuvent effectuées comme d'exiger le choix de l'année de disposition *anneeDisposition* pour un versement du type *CIVI* ou d'exiger le choixi du type de documents versés *typeDocumentVersement* pour un versement du type *JUDI*.

Le service web pour créer un versement permet :

 * <<services-pistard-acquisition-publique-versement-dos-creer>>
 * <<services-pistard-acquisition-publique-versement-reg-creer>>
 * <<services-pistard-acquisition-publique-versement-adm-creer-cour>>
 * <<services-pistard-acquisition-publique-versement-adm-creer-judi>>
 * <<services-pistard-acquisition-publique-versement-jud-creer>>
 * <<services-pistard-acquisition-publique-versement-jrn-creer>>

[[services-pistard-acquisition-publique-versement-dos-creer]]
===== Créer un versement d'un organisme gouvernemental avec des dossiers

====== Exemple de requête

include::{snippets}/post_creerVersementPublique_dos/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/post_creerVersementPublique_dos/http-response.adoc[]

[[services-pistard-acquisition-publique-versement-reg-creer]]
===== Créer un versement du directeur de l'état civil avec des registres

pass:q[<u>*La précondition*</u>] pour créer un versement du directeur de l'état civil est :

 * L'année de disposition est obligatoire et doit être inférieure ou égale à l'année courante sinon un code HTTP 400 est retourné.

====== Exemple de requête

include::{snippets}/post_creerVersementPublique_reg/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/post_creerVersementPublique_reg/http-response.adoc[]

[[services-pistard-acquisition-publique-versement-adm-creer-cour]]
===== Créer un versement d'une cour municipale avec des documents administratifs

====== Exemple de requête

include::{snippets}/post_creerVersementPublique_adm_cour/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/post_creerVersementPublique_adm_cour/http-response.adoc[]

[[services-pistard-acquisition-publique-versement-adm-creer-judi]]
===== Créer un versement d'un tribunal provincial avec des documents administratifs

pass:q[<u>*La précondition*</u>] pour créer un versement d'un tribunal provincial est :

 * Le type de documents versés (typeDocumentVersement = ADM) doit être mentionné sinon un code HTTP 400 est retourné.

====== Exemple de requête

include::{snippets}/post_creerVersementPublique_adm_judi/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/post_creerVersementPublique_adm_judi/http-response.adoc[]

[[services-pistard-acquisition-publique-versement-jud-creer]]
===== Créer un versement d'un tribunal provincial avec des documents et des causes judiciaires

pass:q[<u>*La précondition*</u>] pour créer un versement d'un tribunal provincial est :

 * Le type de documents versés (typeDocumentVersement = JUD) doit être mentionné sinon un code HTTP 400 est retourné.

====== Exemple de requête

include::{snippets}/post_creerVersementPublique_jud/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/post_creerVersementPublique_jud/http-response.adoc[]

[[services-pistard-acquisition-publique-versement-jrn-creer]]
===== Créer un versement d'un tribunal provincial avec des registres judiciaires

pass:q[<u>*La précondition*</u>] pour créer un versement d'un tribunal provincial est :

 * Le type de documents versés (typeDocumentVersement = JRN) doit être mentionné sinon un code HTTP 400 est retourné.

====== Exemple de requête

include::{snippets}/post_creerVersementPublique_jrn/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/post_creerVersementPublique_jrn/http-response.adoc[]


[[services-pistard-acquisition-publique-versement-obtenir]]
==== Obtenir un versement à partir de l'identifiant de l'acquisition

pass:q[<u>*Les préconditions*</u>] pour obtenir un versement sont :

 * Un versement doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * Si l'usager est externe, l'organisme de l'usager doit être l'organisme du versement sinon un code HTTP 403 est retourné.
 * Si l'usager est interne, le versement doit être 'TRA - Transféré', 'MOD - À modifier' ou 'ENR - Enregistré' sinon un code HTTP 403 est retourné.
 * Si l'usager est interne, il doit avoir l'un des rôles suivants :
 ** CONSULTATION_PISTARD - Employé d'un centre d'archives BAnQ avec un accès en consultation
 ** SOUTIEN - Soutien d'un centre d'archives BAnQ
 ** PROFESSIONNEL - Archiviste d'un centre d'archives BAnQ
 ** COORDONNATEUR - Coordonnateur d'un centre d'archives BAnQ
 ** DIRECTION - Directeur d'un centre d'archives BAnQ

La quantité numérique totale *qteNumerique* est en octet et représente le total des quantités numériques des collations.
La quantité numérique reçue *qteNumeriqueRecue* est en octet et représente la taille des fichiers numériques transférés.

Le service web pour obtenir un versement permet :

 * <<services-pistard-acquisition-publique-versement-obtenir-consultation>>
 * <<services-pistard-acquisition-publique-versement-obtenir-edition>>

[[services-pistard-acquisition-publique-versement-obtenir-consultation]]
===== Obtenir un versement en consultation

Le service web pour obtenir un versement en consultation permet :

 * <<services-pistard-acquisition-publique-versement-dos-obtenir-consultation>>
 * <<services-pistard-acquisition-publique-versement-reg-obtenir-consultation>>
 * <<services-pistard-acquisition-publique-versement-adm-obtenir-consultation-cour>>
 * <<services-pistard-acquisition-publique-versement-adm-obtenir-consultation-judi>>
 * <<services-pistard-acquisition-publique-versement-jud-obtenir-consultation>>
 * <<services-pistard-acquisition-publique-versement-jrn-obtenir-consultation>>

[[services-pistard-acquisition-publique-versement-dos-obtenir-consultation]]
====== Obtenir un versement en consultation d'un organisme gouvernemental avec des dossiers

======= Exemple de requête

include::{snippets}/get_obtenirVersementPublique_dos_en_lecture/http-request.adoc[]

======= Exemple de réponse

include::{snippets}/get_obtenirVersementPublique_dos_en_lecture/http-response.adoc[]

[[services-pistard-acquisition-publique-versement-reg-obtenir-consultation]]
====== Obtenir un versement en consultation du directeur de l'état civil avec des registres

======= Exemple de requête

include::{snippets}/get_obtenirVersementPublique_reg_en_lecture/http-request.adoc[]

======= Exemple de réponse

include::{snippets}/get_obtenirVersementPublique_reg_en_lecture/http-response.adoc[]

[[services-pistard-acquisition-publique-versement-adm-obtenir-consultation-cour]]
====== Obtenir un versement en consultation d'une cour municipale avec des documents administratifs

======= Exemple de requête

include::{snippets}/get_obtenirVersementPublique_adm_en_lecture_cour/http-request.adoc[]

======= Exemple de réponse

include::{snippets}/get_obtenirVersementPublique_adm_en_lecture_cour/http-response.adoc[]

[[services-pistard-acquisition-publique-versement-adm-obtenir-consultation-judi]]
====== Obtenir un versement en consultation d'un tribunal provincial avec des documents administratifs

======= Exemple de requête

include::{snippets}/get_obtenirVersementPublique_adm_en_lecture_judi/http-request.adoc[]

======= Exemple de réponse

include::{snippets}/get_obtenirVersementPublique_adm_en_lecture_judi/http-response.adoc[]

[[services-pistard-acquisition-publique-versement-jud-obtenir-consultation]]
====== Obtenir un versement en consultation d'un tribunal provincial avec des documents et des causes judiciaires

======= Exemple de requête

include::{snippets}/get_obtenirVersementPublique_jud_en_lecture/http-request.adoc[]

======= Exemple de réponse

include::{snippets}/get_obtenirVersementPublique_jud_en_lecture/http-response.adoc[]

[[services-pistard-acquisition-publique-versement-jrn-obtenir-consultation]]
====== Obtenir un versement en consultation d'un tribunal provincial avec des registres judiciaires

======= Exemple de requête

include::{snippets}/get_obtenirVersementPublique_jrn_en_lecture/http-request.adoc[]

======= Exemple de réponse

include::{snippets}/get_obtenirVersementPublique_jrn_en_lecture/http-response.adoc[]


[[services-pistard-acquisition-publique-versement-obtenir-edition]]
===== Obtenir un versement en édition

Le service web pour obtenir un versement en édition permet :

 * <<services-pistard-acquisition-publique-versement-dos-obtenir-edition>>
 * <<services-pistard-acquisition-publique-versement-reg-obtenir-edition>>
 * <<services-pistard-acquisition-publique-versement-adm-obtenir-edition-cour>>
 * <<services-pistard-acquisition-publique-versement-adm-obtenir-edition-judi>>
 * <<services-pistard-acquisition-publique-versement-jud-obtenir-edition>>
 * <<services-pistard-acquisition-publique-versement-jrn-obtenir-edition>>

[[services-pistard-acquisition-publique-versement-dos-obtenir-edition]]
====== Obtenir un versement en édition d'un organisme gouvernemental avec des dossiers

======= Exemple de requête

include::{snippets}/get_obtenirVersementPublique_dos_avec_verrou_en_ecriture/http-request.adoc[]

======= Exemple de réponse

include::{snippets}/get_obtenirVersementPublique_dos_avec_verrou_en_ecriture/http-response.adoc[]

[[services-pistard-acquisition-publique-versement-reg-obtenir-edition]]
====== Obtenir un versement en édition du directeur de l'état civil avec des registres

======= Exemple de requête

include::{snippets}/get_obtenirVersementPublique_reg_avec_verrou_en_ecriture/http-request.adoc[]

======= Exemple de réponse

include::{snippets}/get_obtenirVersementPublique_reg_avec_verrou_en_ecriture/http-response.adoc[]

[[services-pistard-acquisition-publique-versement-adm-obtenir-edition-cour]]
====== Obtenir un versement en édition d'une cour municipale avec des documents administratifs

======= Exemple de requête

include::{snippets}/get_obtenirVersementPublique_adm_avec_verrou_en_ecriture_cour/http-request.adoc[]

======= Exemple de réponse

include::{snippets}/get_obtenirVersementPublique_adm_avec_verrou_en_ecriture_cour/http-response.adoc[]

[[services-pistard-acquisition-publique-versement-adm-obtenir-edition-judi]]
====== Obtenir un versement en édition d'un tribunal provincial avec des documents administratifs

======= Exemple de requête

include::{snippets}/get_obtenirVersementPublique_adm_avec_verrou_en_ecriture_judi/http-request.adoc[]

======= Exemple de réponse

include::{snippets}/get_obtenirVersementPublique_adm_avec_verrou_en_ecriture_judi/http-response.adoc[]

[[services-pistard-acquisition-publique-versement-jud-obtenir-edition]]
====== Obtenir un versement en édition d'un tribunal provincial avec des documents et des causes judiciaires

======= Exemple de requête

include::{snippets}/get_obtenirVersementPublique_jud_avec_verrou_en_ecriture/http-request.adoc[]

======= Exemple de réponse

include::{snippets}/get_obtenirVersementPublique_jud_avec_verrou_en_ecriture/http-response.adoc[]

[[services-pistard-acquisition-publique-versement-jrn-obtenir-edition]]
====== Obtenir un versement en édition d'un tribunal provincial avec des registres judiciaires

======= Exemple de requête

include::{snippets}/get_obtenirVersementPublique_jrn_avec_verrou_en_ecriture/http-request.adoc[]

======= Exemple de réponse

include::{snippets}/get_obtenirVersementPublique_jrn_avec_verrou_en_ecriture/http-response.adoc[]


[[services-pistard-acquisition-publique-versement-modifier]]
==== Modifier un versement

Pour modifier un versement, l'usager doit d'abord obternir un verrou.

Si le versement est déja verrouillé pour édition par un autre usager alors un code HTTP 403 est retourné.

pass:q[<u>*Les préconditions*</u>] pour modifier un versement sont :

 * Un versement doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * Si l'usager est externe, l'organisme de l'usager doit être l'organisme du versement sinon un code HTTP 403 est retourné.
 * Si l'usager est externe, le statut du versement doit être 'PRE - En préparation', 'ATT - En attente de transfert' ou 'MOD - À modifier' pour que le versement puisse être modifié sinon un code HTTP 412 est retourné.
 * Si l'usager est externe et que le statut du versement est 'ATT - En attente de transfert', l'usager doit être un responsable des versements de son organisme (RESPONSABLE_ORGANISME) pour que le versement puisse être modifié sinon un code HTTP 412 est retourné.
 * Si l'usager est interne, le versement doit être 'TRA - Transféré' pour pouvoir être modifié sinon un code HTTP 412 est retourné.
 * Si l'usager est interne, il doit être dans l'un cas suivants sinon un code HTTP 403 est retourné :
 ** Un archiviste responsable (PROFESSIONNEL) d'un centre d'archives BAnQ peut modifier les données d'enregistrement uniquement si il est un employé assigné au versement.
 ** Un coordonnateur (COORDONNATEUR) d'un centre d'archives BAnQ peut modifier l'archiviste responsable uniquement si il est associé comme responsable au centre d'archives BAnQ du versement.
 ** Un directeur (DIRECTION) d'un centre d'archives BAnQ peut modifier l'archiviste responsable et/ou le centre d'archives BAnQ d'un versement.

Voici les mises à jour effectuées automatiquement par le système avant de sauvegarder le versement :

 * L'organisme associé au versement lors de sa création est mis à jour pour être conservé.
 * Le type de versement d'archives associé au versement lors de sa création est mis à jour pour être conservé.
 * L'indicateur analogique est forcé pour un versement qui n'est pas encore transféré s'il y a des contenants ou des informations analogiques au niveau des collations.
 * L'indicateur numérique est forcé pour un versement qui n'est pas encore transféré s'il y a des informations numériques au niveau des collations.

Si le versement est sauvegardé correctement, il est automatiquement enlevé de la cache. Le versement est remis en cache automatiquement seulement dans le cas de la sauvegarde des données d'enregistrement effectué par un archiviste responsable d'un centre BAnQ attitré au versement afin de permettre l'enregistrement final du versement qui nécessite un verrou sur le versement afin de modifier son statut à *ENR - Enregistré*.

Le service web pour modifier un versement permet aux usagers externes et internes de modifier certaines informations selon leur rôle et le statut du versement :

 * <<services-pistard-acquisition-publique-versement-dos-modifier-externe>>
 * <<services-pistard-acquisition-publique-versement-reg-modifier-externe>>
 * <<services-pistard-acquisition-publique-versement-adm-modifier-externe-cour>>
 * <<services-pistard-acquisition-publique-versement-adm-modifier-externe-judi>>
 * <<services-pistard-acquisition-publique-versement-jud-modifier-externe>>
 * <<services-pistard-acquisition-publique-versement-jrn-modifier-externe>>
 * <<services-pistard-acquisition-publique-versement-dos-modifier-interne>>
 * <<services-pistard-acquisition-publique-versement-reg-modifier-interne>>
 * <<services-pistard-acquisition-publique-versement-adm-modifier-interne-cour>>
 * <<services-pistard-acquisition-publique-versement-adm-modifier-interne-judi>>
 * <<services-pistard-acquisition-publique-versement-jud-modifier-interne>>
 * <<services-pistard-acquisition-publique-versement-jrn-modifier-interne>>

[[services-pistard-acquisition-publique-versement-dos-modifier-externe]]
===== Modifier un versement d'un organisme gouvernemental avec des dossiers par un usager externe

====== Exemple de requête

include::{snippets}/put_modifierVersementPublique_dos_externe/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/put_modifierVersementPublique_dos_externe/http-response.adoc[]

[[services-pistard-acquisition-publique-versement-reg-modifier-externe]]
===== Modifier un versement du directeur de l'état civil avec des registres par un usager externe

pass:q[<u>*La précondition*</u>] pour modifier un versement du directeur de l'état civil est :

 * L'année de disposition est obligatoire et doit être inférieure ou égale à l'année courante sinon un code HTTP 400 est retourné.

====== Exemple de requête

include::{snippets}/put_modifierVersementPublique_reg_externe/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/put_modifierVersementPublique_reg_externe/http-response.adoc[]

[[services-pistard-acquisition-publique-versement-adm-modifier-externe-cour]]
===== Modifier un versement d'une cour municipale avec des documents administratifs par un usager externe

====== Exemple de requête

include::{snippets}/put_modifierVersementPublique_adm_externe_cour/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/put_modifierVersementPublique_adm_externe_cour/http-response.adoc[]

[[services-pistard-acquisition-publique-versement-adm-modifier-externe-judi]]
===== Modifier un versement d'un tribunal provincial avec des documents administratifs par un usager externe

====== Exemple de requête

include::{snippets}/put_modifierVersementPublique_adm_externe_judi/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/put_modifierVersementPublique_adm_externe_judi/http-response.adoc[]

[[services-pistard-acquisition-publique-versement-jud-modifier-externe]]
===== Modifier un versement d'un tribunal provincial avec des documents et des causes judiciaires par un usager externe

====== Exemple de requête

include::{snippets}/put_modifierVersementPublique_jud_externe/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/put_modifierVersementPublique_jud_externe/http-response.adoc[]

[[services-pistard-acquisition-publique-versement-jrn-modifier-externe]]
===== Modifier un versement d'un tribunal provincial avec des registres judiciaires par un usager externe

====== Exemple de requête

include::{snippets}/put_modifierVersementPublique_jrn_externe/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/put_modifierVersementPublique_jrn_externe/http-response.adoc[]


[[services-pistard-acquisition-publique-versement-dos-modifier-interne]]
===== Modifier un versement d'un organisme gouvernemental avec des dossiers par un usager interne

Pour un versement d'un organisme gouvernemental, l'archiviste responsable peut cocher la case 'Entente de dépôt' pour préciser que les contenants et les fichiers numériques ne seront pas transférés au centre d'archives BAnQ.

====== Exemple de requête

include::{snippets}/put_modifierVersementPublique_dos_interne_analogique/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/put_modifierVersementPublique_dos_interne_analogique/http-response.adoc[]

[[services-pistard-acquisition-publique-versement-reg-modifier-interne]]
===== Modifier un versement du directeur de l'état civil avec des registres par un usager interne

Pour un versement du directeur de l'état civil, il n'y a pas de case 'Entente de dépôt' ce qui signifie que les contenants seront toujours transférés au centre d'archives BAnQ.

====== Exemple de requête

include::{snippets}/put_modifierVersementPublique_reg_interne/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/put_modifierVersementPublique_reg_interne/http-response.adoc[]

[[services-pistard-acquisition-publique-versement-adm-modifier-interne-cour]]
===== Modifier un versement d'une cour municipale avec des documents administratifs par un usager interne

Pour un versement d'une cour municipale, l'archiviste responsable peut cocher la case 'Entente de dépôt' pour préciser que les contenants et les fichiers numériques ne seront pas transférés au centre d'archives BAnQ.

====== Exemple de requête

include::{snippets}/put_modifierVersementPublique_adm_interne_analogique_cour/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/put_modifierVersementPublique_adm_interne_analogique_cour/http-response.adoc[]

[[services-pistard-acquisition-publique-versement-adm-modifier-interne-judi]]
===== Modifier un versement d'un tribunal provincial avec des documents administratifs par un usager interne

Pour un versement d'un tribunal provincial, il n'y a pas de case 'Entente de dépôt' ce qui signifie que les contenants seront toujours transférés au centre d'archives BAnQ.

====== Exemple de requête

include::{snippets}/put_modifierVersementPublique_adm_interne_analogique_judi/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/put_modifierVersementPublique_adm_interne_analogique_judi/http-response.adoc[]

[[services-pistard-acquisition-publique-versement-jud-modifier-interne]]
===== Modifier un versement d'un tribunal provincial avec des documents et des causes judiciaires par un usager interne

Pour un versement d'un tribunal provincial, il n'y a pas de case 'Entente de dépôt' ce qui signifie que les contenants seront toujours transférés au centre d'archives BAnQ.

====== Exemple de requête

include::{snippets}/put_modifierVersementPublique_jud_interne_analogique/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/put_modifierVersementPublique_jud_interne_analogique/http-response.adoc[]

[[services-pistard-acquisition-publique-versement-jrn-modifier-interne]]
===== Modifier un versement d'un tribunal provincial avec des registres judiciaires par un usager interne

Pour un versement d'un tribunal provincial, il n'y a pas de case 'Entente de dépôt' ce qui signifie que les contenants seront toujours transférés au centre d'archives BAnQ.

====== Exemple de requête

include::{snippets}/put_modifierVersementPublique_jrn_interne/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/put_modifierVersementPublique_jrn_interne/http-response.adoc[]


[[services-pistard-acquisition-publique-versement-libererVerrou]]
==== Libérer le verrou d'édition d'un versement

Pour libérer explicitement le verrou sur un versement.

Le verrou pour un versement est libéré automatiquement lorsque :

 * Le temps du verrou de 30 minutes est expiré.
 * Le versement est recommandé pour un transfert.
 * Le versement est transféré.
 * Le versement est enregistré.
 * Le versement est annulé.

===== Exemple de requête

include::{snippets}/get_deverrouilleVersement/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_deverrouilleVersement/http-response.adoc[]


[[services-pistard-acquisition-publique-versement-annuler]]
==== Supprimer ou annuler un versement

Un versement n'est jamais supprimée physiquement en base de données. On active simplement l'indicateur indSupprime de l'acquisition associée au versement.

pass:q[<u>*Les préconditions*</u>] pour supprimer ou annuler un versement sont :

 * Un versement doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * Si l'usager est externe et qu'il a un rôle de soutien, le versement doit être en préparation et il doit avoir été créé par l'usager pour pouvoir être annulé sinon un code HTTP 403 est retourné.
 * Si l'usager est externe et qu'il est un responsable des versements, le versement doit être en préparation ou en attente de transfert pour pouvoir être annulé sinon un code HTTP 403 est retourné.
 * Si l'usager est interne, l'usager doit être l'archiviste responsable assigné au versement sinon un code HTTP 403 est retourné.
 * Le versement doit être transféré pour pouvoir être annulé sinon un code HTTP 412 est retourné.

===== Exemple de requête

include::{snippets}/delete_annulerVersementPublique_Externe/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/delete_annulerVersementPublique_Externe/http-response.adoc[]


[[services-pistard-acquisition-publique-versement-retourEnPreparation]]
==== Retourner un versement en préparation

pass:q[<u>*Les préconditions*</u>] pour retourner un versement en préparation sont :

 * Un versement doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * L'organisme de l'usager externe doit être l'organisme du versement sinon un code HTTP 403 est retourné.
 * Le versement doit être recommander pour un transfert pour pouvoir le retourner en préparation sinon un code HTTP 412 est retourné.

À cette étape, le statut du versement est mis à jour automatiquement à *PRE - En préparation*.

===== Exemple de requête

include::{snippets}/patch_retourEnPreparationVersementPublique/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/patch_retourEnPreparationVersementPublique/http-response.adoc[]

[[services-pistard-acquisition-publique-versement-recommanderTransfert]]
==== Recommander un transfert d'un versement

pass:q[<u>*Les préconditions*</u>] pour recommander un versement pour un transfert sont :

 * Un versement doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * L'organisme de l'usager externe doit être l'organisme du versement sinon un code HTTP 403 est retourné.
 * L'organisme du versement doit avoir un responsable des versements sinon un code HTTP 412 est retourné.
 * Le versement doit être en préparation pour pouvoir le recommander pour un transfert sinon un code HTTP 412 est retourné.
 * Si des ajustements au versement sont nécessaires avant de permettre d'effectuer la recommandation de son transfert, un code HTTP 412 est retourné avec une liste de messages de validation dans le payload selon les préconditions suivantes :
 ** Un versement valide doit avoir au moins une collation.
 ** Un versement valide doit avoir au moins un dossier.
 ** Un versement valide doit avoir aucun dossier analogique associé à aucun contenant ce qui pourrait arriver par exemple suite à l'importation de dossiers, ceux-ci ne sont pas associés à aucun contenant.
 ** Un versement valide doit avoir aucun contenant vide.
 ** Un versement seulement analogique valide a seulement des dossiers analogiques.
 ** Un versement seulement numérique a seulement des dossiers numériques.

À cette étape, le statut du versement est mis à jour automatiquement à *ATT - En attente de transfert*.

Le service web pour recommander un versement pour un transfert permet :

 * <<services-pistard-acquisition-publique-versement-dos-recommanderTransfert>>
 * <<services-pistard-acquisition-publique-versement-reg-recommanderTransfert>>
 * <<services-pistard-acquisition-publique-versement-adm-recommanderTransfert>>
 * <<services-pistard-acquisition-publique-versement-jud-recommanderTransfert>>
 * <<services-pistard-acquisition-publique-versement-jrn-recommanderTransfert>>

[[services-pistard-acquisition-publique-versement-dos-recommanderTransfert]]
===== Recommander un transfert d'un versement d'un organisme gouvernemental avec des dossiers

====== Exemple de requête

include::{snippets}/patch_recommanderTransfertVersementPublique_dos/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/patch_recommanderTransfertVersementPublique_dos/http-response.adoc[]

[[services-pistard-acquisition-publique-versement-reg-recommanderTransfert]]
===== Recommander un transfert d'un versement du directeur de l'état civil avec des registres

====== Exemple de requête

include::{snippets}/patch_recommanderTransfertVersementPublique_reg/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/patch_recommanderTransfertVersementPublique_reg/http-response.adoc[]

[[services-pistard-acquisition-publique-versement-adm-recommanderTransfert]]
===== Recommander un transfert d'un versement d'une cour municipale ou d'un tribunal provincial avec des documents administratifs

====== Exemple de requête

include::{snippets}/patch_recommanderTransfertVersementPublique_adm_cour/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/patch_recommanderTransfertVersementPublique_adm_cour/http-response.adoc[]

[[services-pistard-acquisition-publique-versement-jud-recommanderTransfert]]
===== Recommander un transfert d'un versement d'un tribunal provincial avec des causes judiciaires

====== Exemple de requête

include::{snippets}/patch_recommanderTransfertVersementPublique_jud/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/patch_recommanderTransfertVersementPublique_jud/http-response.adoc[]

[[services-pistard-acquisition-publique-versement-jrn-recommanderTransfert]]
===== Recommander un transfert d'un versement d'un tribunal provincial avec des registres judiciaires

====== Exemple de requête

include::{snippets}/patch_recommanderTransfertVersementPublique_jrn/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/patch_recommanderTransfertVersementPublique_jrn/http-response.adoc[]


[[services-pistard-acquisition-publique-versement-transferer]]
==== Transférer un versement

pass:q[<u>*Les préconditions*</u>] pour transférer un versement sont :

 * Un versement doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * L'organisme de l'usager externe doit être l'organisme du versement sinon un code HTTP 403 est retourné.
 * L'usager doit être responsable des versements sinon un code HTTP 403 est retourné.
 * Le versement doit être en préparation ou en attente de transfert pour pouvoir le transférer sinon un code HTTP 412 est retourné.
 * Si des ajustements au versement sont nécessaires avant de permettre d'effectuer la recommandation de son transfert, un code HTTP 412 est retourné avec une liste de messages de validation dans le payload selon les préconditions suivantes :
 ** Un versement valide doit avoir au moins une collation.
 ** Un versement valide doit avoir au moins un dossier.
 ** Un versement valide doit avoir aucun dossier analogique associé à aucun contenant ce qui pourrait arriver par exemple suite à l'importation de dossiers, ceux-ci ne sont pas associés à aucun contenant.
 ** Un versement valide doit avoir aucun contenant vide.
 ** Un versement seulement analogique valide a seulement des dossiers analogiques.
 ** Un versement seulement numérique a seulement des dossiers numériques.

À cette étape, le statut du versement est mis à jour automatiquement à *TRA - Transféré*.

Le service web pour transférer un versement permet :

 * <<services-pistard-acquisition-publique-versement-dos-transferer>>
 * <<services-pistard-acquisition-publique-versement-reg-transferer>>
 * <<services-pistard-acquisition-publique-versement-adm-transferer>>
 * <<services-pistard-acquisition-publique-versement-jud-transferer>>
 * <<services-pistard-acquisition-publique-versement-jrn-transferer>>

[[services-pistard-acquisition-publique-versement-dos-transferer]]
===== Transférer un versement d'un organisme gouvernemental avec des dossiers

====== Exemple de requête

include::{snippets}/patch_transfererVersementPublique_dos/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/patch_transfererVersementPublique_dos/http-response.adoc[]

[[services-pistard-acquisition-publique-versement-reg-transferer]]
===== Transférer un versement du directeur de l'état civil avec des registres

====== Exemple de requête

include::{snippets}/patch_transfererVersementPublique_reg/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/patch_transfererVersementPublique_reg/http-response.adoc[]

[[services-pistard-acquisition-publique-versement-adm-transferer]]
===== Transférer un versement d'une cour municipale ou d'un tribunal provincial avec des documents administratifs

====== Exemple de requête

include::{snippets}/patch_transfererVersementPublique_adm_cour/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/patch_transfererVersementPublique_adm_cour/http-response.adoc[]

[[services-pistard-acquisition-publique-versement-jud-transferer]]
===== Transférer un versement d'un tribunal provincial avec des documents et des causes judiciaires

====== Exemple de requête

include::{snippets}/patch_transfererVersementPublique_jud/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/patch_transfererVersementPublique_jud/http-response.adoc[]

[[services-pistard-acquisition-publique-versement-jrn-transferer]]
===== Transférer un versement d'un tribunal provincial avec des registres judiciaires

====== Exemple de requête

include::{snippets}/patch_transfererVersementPublique_jrn/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/patch_transfererVersementPublique_jrn/http-response.adoc[]


[[services-pistard-acquisition-publique-versement-enregistrer]]
==== Enregistrer un versement

pass:q[<u>*Les préconditions*</u>] pour enregistrer un versement sont :

 * Un versement doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * L'usager interne doit être l'archiviste responsable assigné au versement sinon un code HTTP 403 est retourné.
 * Le versement doit être transféré pour pouvoir être enregistré sinon un code HTTP 412 est retourné.
 * Si des données d'enregistrement sont manquantes au niveau du versement un code HTTP 412 est retourné avec une liste de messages de validation dans le payload. Si la case 'Entente de dépôt' n'a pas été cochée, les données d'enregistrement suivantes doivent être fournies :
 ** Pour un versement analogique, les informations 'Date de réception analogique' et 'Nombre de contenants reçus'.
 ** Pour un versement numérique, les informations 'Date de réception numérique' et 'Quantité numérique totale reçue' qui correspond à la taille en octet des fichiers numériques reçus.

À cette étape, le statut du versement est mis à jour automatiquement à *ENR - Enregistré*.

Le service web pour enregistrer un versement permet :

 * <<services-pistard-acquisition-publique-versement-dos-enregistrer>>
 * <<services-pistard-acquisition-publique-versement-reg-enregistrer>>
 * <<services-pistard-acquisition-publique-versement-adm-enregistrer>>
 * <<services-pistard-acquisition-publique-versement-jud-enregistrer>>
 * <<services-pistard-acquisition-publique-versement-jrn-enregistrer>>

[[services-pistard-acquisition-publique-versement-dos-enregistrer]]
===== Enregistrer un versement d'un organisme gouvernemental avec des dossiers

====== Exemple de requête

include::{snippets}/patch_enregistrerVersementPublique_dos/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/patch_enregistrerVersementPublique_dos/http-response.adoc[]

[[services-pistard-acquisition-publique-versement-reg-enregistrer]]
===== Enregistrer un versement du directeur de l'état civil avec des registres

====== Exemple de requête

include::{snippets}/patch_enregistrerVersementPublique_reg/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/patch_enregistrerVersementPublique_reg/http-response.adoc[]

[[services-pistard-acquisition-publique-versement-adm-enregistrer]]
===== Enregistrer un versement d'une cour municipale ou d'un tribunal provincial avec des documents administratifs

====== Exemple de requête

include::{snippets}/patch_enregistrerVersementPublique_adm/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/patch_enregistrerVersementPublique_adm/http-response.adoc[]

[[services-pistard-acquisition-publique-versement-jud-enregistrer]]
===== Enregistrer un versement d'un tribunal provincial avec des documents et des causes judiciaires

====== Exemple de requête

include::{snippets}/patch_enregistrerVersementPublique_jud/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/patch_enregistrerVersementPublique_jud/http-response.adoc[]

[[services-pistard-acquisition-publique-versement-jrn-enregistrer]]
===== Enregistrer un versement d'un tribunal provincial avec des registres judiciaires

====== Exemple de requête

include::{snippets}/patch_enregistrerVersementPublique_jrn/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/patch_enregistrerVersementPublique_jrn/http-response.adoc[]


[[services-pistard-acquisition-publique-versement-debuterTraitement]]
==== Débuter le traitement d'un versement

Ce service web permet de débuter le traitement d'un versement. Les unités de pré-traitement sont créées à partir des informations des documents publiques incluant le numéro du verseur, le titre, les dates de début et de fin, l'identifiant ainsi que l'unité parent. Enfin, l'indicateur *indEstConserve* (IND_CONSERVE) est activé pour chaque unité de pré-traitement.

pass:q[<u>*Les préconditions*</u>] pour débuter le traitement d'un versement sont :

 * Un versement doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * L'usager interne doit être un archiviste assigné au versement sinon un code HTTP 403 est retourné.
 * Le versement doit être enregistré pour pouvoir débuter son traitement sinon un code HTTP 412 est retourné.

À cette étape, le statut du versement est mis à jour automatiquement à *ETR - En traitement*.

===== Exemple de requête

include::{snippets}/patch_debuterTraitementVersementPublique/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/patch_debuterTraitementVersementPublique/http-response.adoc[]


[[services-pistard-acquisition-publique-versement-finaliserTraitement]]
==== Finaliser le traitement d'un versement

pass:q[<u>*Les préconditions*</u>] pour finaliser le traitement d'un versement sont :

 * Un versement doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * L'usager interne doit être un archiviste assigné au versement sinon un code HTTP 403 est retourné.
 * Le versement doit être au statut *ETR - En traitement* et qu'il soit possible de finaliser son traitement sinon un code HTTP 412 est retourné.

À cette étape, le statut du versement est mis à jour automatiquement à *TRT- Traité*.

===== Exemple de requête

include::{snippets}/patch_finaliserTraitementVersementPublique/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/patch_finaliserTraitementVersementPublique/http-response.adoc[]


[[services-pistard-acquisition-publique-versement-produireBordereau]]
==== Produire le bordereau d'un versement

pass:q[<u>*Les préconditions*</u>] pour produire le bordereau d'un versement sont :

 * Un versement doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * L'usager interne doit être l'archiviste responsable assigné au versement sinon un code HTTP 403 est retourné.
 * L'usager externe doit être associé au même organisme que le versement sinon un code HTTP 403 est retourné.
 * Le traitement du versement doit être débuté ou bien avoir été finalisé sinon un code HTTP 412 est retourné.

Le bordereau du versement est produit en format Excel et il est retourné dans la réponse de la requête.

===== Exemple de requête

include::{snippets}/get_produireBordereauVersementPublique/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_produireBordereauVersementPublique/http-response.adoc[]


[[services-pistard-acquisition-publique-contenant]]
=== Contenant d'un versement

Les services Web pour les contenants d'un versement avec du contenu analogique permettent :

 * <<services-pistard-acquisition-publique-contenant-filtrer>>
 * <<services-pistard-acquisition-publique-contenant-obtenirListe>>
 * <<services-pistard-acquisition-publique-contenant-creer>>
 * <<services-pistard-acquisition-publique-contenant-modifier>>
 * <<services-pistard-acquisition-publique-contenant-supprimer>>

[[services-pistard-acquisition-publique-contenant-filtrer]]
==== Filtrer les contenants d'un versement

Ce service web permet de filtrer les contenants pour un versement selon différents critères.

Voici les critères de recherche :

 * idAcquisition : Identifiant de l'acquisition associée au versement.

pass:q[<u>*Les préconditions*</u>] pour filtrer les contenants pour un versement sont :

 * Un versement doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * Si l'usager est externe, l'organisme de l'usager doit être l'organisme du versement sinon un code HTTP 403 est retourné.

===== Exemple de requête

include::{snippets}/post_filtrerContenantsVersement/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/post_filtrerContenantsVersement/http-response.adoc[]


[[services-pistard-acquisition-publique-contenant-obtenirListe]]
==== Obtenir les contenants d'un versement

pass:q[<u>*Les préconditions*</u>] pour obtenir les contenants d'un versement sont :

 * Un versement doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * Si l'usager est externe, l'organisme de l'usager doit être l'organisme du versement sinon un code HTTP 403 est retourné.

Le service web pour obtenir les contenants d'un versement permet :

 * <<services-pistard-acquisition-publique-versement-contenant-obtenirTous>>
 * <<services-pistard-acquisition-publique-versement-dos-contenant-obtenirListe>>
 * <<services-pistard-acquisition-publique-versement-reg-contenant-obtenirListe>>
 * <<services-pistard-acquisition-publique-versement-adm-contenant-obtenirListe>>
 * <<services-pistard-acquisition-publique-versement-jud-contenant-obtenirListe>>

[[services-pistard-acquisition-publique-versement-contenant-obtenirTous]]
===== Obtenir tous les contenants d'un versement

====== Exemple de requête

include::{snippets}/get_obtenirTousContenantsVersement/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/get_obtenirTousContenantsVersement/http-response.adoc[]

[[services-pistard-acquisition-publique-versement-dos-contenant-obtenirListe]]
===== Obtenir les contenants d'un versement d'un organisme gouvernemental avec des dossiers

====== Exemple de requête

include::{snippets}/get_obtenirContenantsVersement_dos/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/get_obtenirContenantsVersement_dos/http-response.adoc[]

[[services-pistard-acquisition-publique-versement-reg-contenant-obtenirListe]]
===== Obtenir les contenants d'un versement du directeur de l'état civil avec des registres

====== Exemple de requête

include::{snippets}/get_obtenirContenantsVersement_reg/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/get_obtenirContenantsVersement_reg/http-response.adoc[]

[[services-pistard-acquisition-publique-versement-adm-contenant-obtenirListe]]
===== Obtenir les contenants d'un versement d'une cour municipale ou d'un tribunal provincial avec des documents administratifs

====== Exemple de requête

include::{snippets}/get_obtenirContenantsVersement_adm/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/get_obtenirContenantsVersement_adm/http-response.adoc[]

[[services-pistard-acquisition-publique-versement-jud-contenant-obtenirListe]]
===== Obtenir les contenants d'un versement d'un tribunal provincial avec des documents et des causes judiciaires

====== Exemple de requête

include::{snippets}/get_obtenirContenantsVersement_jud/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/get_obtenirContenantsVersement_jud/http-response.adoc[]


[[services-pistard-acquisition-publique-contenant-creer]]
==== Créer un contenant pour un versement

pass:q[<u>*Les préconditions*</u>] pour créer un contenant pour un versement sont :

 * Un versement doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * L'usager doit être externe sinon un code HTTP 403 est retourné.
 * L'organisme de l'usager doit être l'organisme du versement sinon un code HTTP 403 est retourné.
 * Le versement doit être en préparation ou en attente de transfert pour pouvoir être modifié sinon un code HTTP 403 est retourné.
 * Le numéro de contenant fourni ne doit pas être utilisé par un autre contenant du versement sinon un code HTTP 409 est retourné.

===== Exemple de requête

include::{snippets}/post_creerContenantVersement/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/post_creerContenantVersement/http-response.adoc[]


[[services-pistard-acquisition-publique-contenant-modifier]]
==== Modifier un contenant d'un versement

pass:q[<u>*Les préconditions*</u>] pour modifier un contenant d'un versement sont :

 * Un versement doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * L'usager doit être externe sinon un code HTTP 403 est retourné.
 * L'organisme de l'usager doit être l'organisme du versement sinon un code HTTP 403 est retourné.
 * Le versement doit être en préparation ou en attente de transfert pour pouvoir être modifié sinon un code HTTP 403 est retourné.
 * Le contenant à modifier doit être l'un des contenants du versement sinon un code HTTP 412 est retourné.
 * Le numéro de contenant fourni ne doit pas être utilisé par un autre contenant du versement sinon un code HTTP 409 est retourné.

===== Exemple de requête

include::{snippets}/put_modifierContenantVersement/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/put_modifierContenantVersement/http-response.adoc[]


[[services-pistard-acquisition-publique-contenant-supprimer]]
==== Supprimer un ou des contenants d'un versement

Fournir la liste des identifiants des contenants à supprimer.

pass:q[<u>*Les préconditions*</u>] pour supprimer un contenant d'un versement sont :

 * Un versement doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * L'usager doit être externe sinon un code HTTP 403 est retourné.
 * L'organisme de l'usager doit être l'organisme du versement sinon un code HTTP 403 est retourné.
 * Le versement doit être en préparation ou en attente de transfert pour pouvoir être modifié sinon un code HTTP 403 est retourné.
 * Le ou les contenants à supprimer doit être l'un des contenants du versement sinon un code HTTP 412 est retourné.

===== Exemple de requête

include::{snippets}/delete_supprimerContenantVersement/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/delete_supprimerContenantVersement/http-response.adoc[]


[[services-pistard-acquisition-publique-restrictionsAdmissibles]]
=== Obtenir les restrictions admissibles d'un versement

Ce service web permet d'obtenir les restrictions admissibles d'un versement à partir de l'identifiant de l'acquisition.

pass:q[<u>*Les préconditions*</u>] pour obtenir les restrictions admissibles d'un versement sont :

 * Un versement doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.

==== Exemple de requête

include::{snippets}/get_restrictionsAdmissiblesVersement_judi/http-request.adoc[]

==== Exemple de réponse

include::{snippets}/get_restrictionsAdmissiblesVersement_judi/http-response.adoc[]


[[services-pistard-acquisition-publique-document-dos]]
=== Dossier gouvernemental

Le code pour le type de document d'un dossier gouvernemental est *DOS*.

Les services Web pour les dossiers pour un versement d'un organisme gouvernemental permettent :

 * <<services-pistard-acquisition-publique-document-dos-filtrer>>
 * <<services-pistard-acquisition-publique-document-dos-obtenirListe>>
 * <<services-pistard-acquisition-publique-document-dos-creer>>
 * <<services-pistard-acquisition-publique-document-dos-modifier>>
 * <<services-pistard-acquisition-publique-document-dos-supprimer>>
 * <<services-pistard-acquisition-publique-document-dos-importer>>
 * <<services-pistard-acquisition-publique-document-dos-saisieEnLot>>

[[services-pistard-acquisition-publique-document-dos-filtrer]]
==== Filtrer les dossiers pour un versement d'un organisme gouvernemental

Ce service web permet de filtrer les dossiers pour un versement d'un organisme gouvernemental selon différents critères.

Voici les 2 critères de recherche :

 * idAcquisition : Identifiant de l'acquisition associée au versement.
 * idContenantVersementPublique : Identifiant d'un contenant du versement (Optionnel).

pass:q[<u>*Les préconditions*</u>] pour filtrer les dossiers pour un versement d'un organisme gouvernemental sont :

 * Un versement doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * Un contenant doit exister selon l'identifiant du contenant fourni sinon un code HTTP 404 est retourné.
 * Si l'usager est externe, l'organisme de l'usager doit être l'organisme du versement sinon un code HTTP 403 est retourné.

===== Exemple de requête

include::{snippets}/post_filtrerDocumentsVersement_dos/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/post_filtrerDocumentsVersement_dos/http-response.adoc[]


[[services-pistard-acquisition-publique-document-dos-obtenirListe]]
==== Obtenir les dossiers pour un versement d'un organisme gouvernemental

pass:q[<u>*Les préconditions*</u>] pour obtenir les dossiers pour un versement d'un organisme gouvernemental sont :

 * Un versement doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * Si l'usager est externe, l'organisme de l'usager doit être l'organisme du versement sinon un code HTTP 403 est retourné.

===== Exemple de requête

include::{snippets}/get_obtenirDocumentsVersement_dos/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_obtenirDocumentsVersement_dos/http-response.adoc[]


[[services-pistard-acquisition-publique-document-dos-creer]]
==== Créer un dossier pour un versement d'un organisme gouvernemental

pass:q[<u>*Les préconditions*</u>] pour créer un dossier pour un versement d'un organisme gouvernemental sont :

 * Un versement doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * L'usager doit être externe sinon un code HTTP 403 est retourné.
 * L'organisme de l'usager doit être l'organisme du versement sinon un code HTTP 403 est retourné.
 * Le versement doit être en préparation ou en attente de transfert pour pouvoir être modifié sinon un code HTTP 403 est retourné.
 * Le numéro de dossier fourni ne doit pas déjà avoir été utilisé par un autre dossier du versement en cours ou d'un autre versement de l'organisme sinon un code HTTP 409 est retourné.
 * Si l'indicateur 'Droit d'auteur' fourni est faux, l'information 'Précision Droit d'auteur' doit être fournie sinon un code HTTP 400 est retourné.
 * La règle de conservation choisie doit être associée à l’organisme du versement sinon un code HTTP 412 est retourné.
 * Pour chaque restriction, l'année d'accès est obligatoire et si aucune restriction est choisie, une précision doit être fournie sinon un code HTTP 400 est retourné.

===== Exemple de requête

include::{snippets}/post_creerDocumentVersement_dos/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/post_creerDocumentVersement_dos/http-response.adoc[]


[[services-pistard-acquisition-publique-document-dos-modifier]]
==== Modifier un dossier pour un versement d'un organisme gouvernemental

pass:q[<u>*Les préconditions*</u>] pour modifier un dossier pour un versement d'un organisme gouvernemental sont :

 * Un versement doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * L'usager doit être externe sinon un code HTTP 403 est retourné.
 * L'organisme de l'usager doit être l'organisme du versement sinon un code HTTP 403 est retourné.
 * Le versement doit être en préparation ou en attente de transfert pour pouvoir être modifié sinon un code HTTP 403 est retourné.
 * Le dossier à modifier doit être l'un des dossiers du versement sinon un code HTTP 412 est retourné.
 * Le numéro de dossier fourni ne doit pas déjà avoir été utilisé par un autre dossier du versement en cours ou d'un autre versement de l'organisme sinon un code HTTP 409 est retourné.
 * Si l'indicateur 'Droit d'auteur' fourni est faux, l'information 'Précision Droit d'auteur' doit être fournie sinon un code HTTP 400 est retourné.
 * La règle de conservation choisie doit être associée à l’organisme du versement sinon un code HTTP 412 est retourné.
 * Pour chaque restriction, l'année d'accès est obligatoire et si aucune restriction est choisie, une précision doit être fournie sinon un code HTTP 400 est retourné.

===== Exemple de requête

include::{snippets}/put_modifierDocumentVersement_dos/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/put_modifierDocumentVersement_dos/http-response.adoc[]


[[services-pistard-acquisition-publique-document-dos-supprimer]]
==== Supprimer un ou des dossiers pour un versement d'un organisme gouvernemental

Fournir la liste des identifiants des dossiers à supprimer.

pass:q[<u>*Les préconditions*</u>] pour supprimer un dossier pour un versement d'un organisme gouvernemental sont :

 * Un versement doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * L'usager doit être externe sinon un code HTTP 403 est retourné.
 * L'organisme de l'usager doit être l'organisme du versement sinon un code HTTP 403 est retourné.
 * Le versement doit être en préparation ou en attente de transfert pour pouvoir être modifié sinon un code HTTP 403 est retourné.
 * Le ou les dossiers à supprimer doit être l'un des dossiers du versement sinon un code HTTP 412 est retourné.

===== Exemple de requête

include::{snippets}/delete_supprimerDocumentVersement_dos/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/delete_supprimerDocumentVersement_dos/http-response.adoc[]


[[services-pistard-acquisition-publique-document-dos-importer]]
==== Importer des dossiers pour un versement d'un organisme gouvernemental à partir d'un fichier XML

pass:q[<u>*Les préconditions*</u>] pour importer des dossiers pour un versement d'un organisme gouvernemental sont :

 * Un versement doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * L'usager doit être externe sinon un code HTTP 403 est retourné.
 * L'organisme de l'usager doit être l'organisme du versement sinon un code HTTP 403 est retourné.
 * Le versement doit être en préparation ou en attente de transfert pour pouvoir être modifié sinon un code HTTP 403 est retourné.
 * Le fichier XML des dossiers ne doit pas être vide ou contenir seulement des espaces sinon un code HTTP 412 est retourné.
 * Le fichier XML des dossiers doit être lisible et valide selon le schéma XSD des dossiers sinon un code HTTP 412 est retourné.

Un code HTTP 412 est retourné avec un message détaillé dans le payload, si une erreur survient lors de la lecture du fichier XML ou durant l'interprétation de son contenu pour obtenir les informations des dossiers.

Un code HTTP 409 est retourné avec une liste de messages de validation dans le payload, si des corrections aux informations des dossiers sont nécessaires afin de permettre leur importation.
La liste des messages de validation est associée à chaque numéro de dossier auquel elle se rapporte.

===== Exemple de requête

include::{snippets}/upload_importerDocumentsVersement_dos/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/upload_importerDocumentsVersement_dos/http-response.adoc[]


[[services-pistard-acquisition-publique-document-dos-saisieEnLot]]
==== Saisie en lot de dossiers pour un versement d'un organisme gouvernemental afin de modifier une ou plusieurs métadonnées

pass:q[<u>*Les préconditions*</u>] pour saisir en lot des dossiers d'un versement d'un organisme gouvernemental sont :

 * Un versement doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * L'usager doit être externe sinon un code HTTP 403 est retourné.
 * L'organisme de l'usager doit être l'organisme du versement sinon un code HTTP 403 est retourné.
 * Le versement doit être en préparation ou en attente de transfert pour pouvoir être modifié sinon un code HTTP 403 est retourné.
 * Au moins un identifiant de dossier doit être fourni dans la liste des identifiants des dossiers sinon un code HTTP 412 est retourné.
 * Les identifiants de dossier fournis doivent correspondre à des dossiers du versement sinon un code HTTP 412 est retourné.
 * Les numéros de contenant fournis doivent exister au niveau des contenants du versement sinon un code HTTP 404 est retourné.
 * Si l'indicateur 'Droit d'auteur' fourni est faux, l'information 'Précision Droit d'auteur' doit être fournie sinon un code HTTP 400 est retourné.
 * Si l'identifiant d'une règle de conservation est mentionnée, elle doit être associée à l’organisme du versement sinon un code HTTP 412 est retourné.
 * Pour chaque restriction, l'année d'accès est obligatoire et si aucune restriction est choisie, une précision doit être fournie sinon un code HTTP 400 est retourné.

Si l'indicateur indRestriction fourni est faux, les restrictions sont supprimées des dossiers identifiés.

Si l'indicateur indDroitAuteur fourni est vrai, l'information 'Précision Droit d'auteur' est supprimée des dossiers identifiés.

===== Exemple de requête

include::{snippets}/patch_saisieLotDocumentsVersement_dos/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/patch_saisieLotDocumentsVersement_dos/http-response.adoc[]


[[services-pistard-acquisition-publique-document-reg]]
=== Registre de l'état civil

Le code pour le type de document d'un registre de l'état civil est *REG*.

Les services Web pour les registres pour un versement du directeur de l'état civil permettent :

 * <<services-pistard-acquisition-publique-document-reg-filtrer>>
 * <<services-pistard-acquisition-publique-document-reg-obtenirListe>>
 * <<services-pistard-acquisition-publique-document-reg-creer>>
 * <<services-pistard-acquisition-publique-document-reg-modifier>>
 * <<services-pistard-acquisition-publique-document-reg-supprimer>>
 * <<services-pistard-acquisition-publique-document-reg-importer>>

[[services-pistard-acquisition-publique-document-reg-filtrer]]
==== Filtrer les registres pour un versement du directeur de l'état civil

Ce service web permet de filtrer les registres pour un versement du directeur de l'état civil selon différents critères.

Voici les 2 critères de recherche :

 * idAcquisition : Identifiant de l'acquisition associée au versement.
 * idContenantVersementPublique : Identifiant d'un contenant du versement (Optionnel).

pass:q[<u>*Les préconditions*</u>] pour filtrer les registres pour un versement du directeur de l'état civil sont :

 * Un versement doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * Un contenant doit exister selon l'identifiant du contenant fourni sinon un code HTTP 404 est retourné.
 * Si l'usager est externe, l'organisme de l'usager doit être l'organisme du versement sinon un code HTTP 403 est retourné.

===== Exemple de requête

include::{snippets}/post_filtrerDocumentsVersement_reg/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/post_filtrerDocumentsVersement_reg/http-response.adoc[]


[[services-pistard-acquisition-publique-document-reg-obtenirListe]]
==== Obtenir les registres pour un versement du directeur de l'état civil

pass:q[<u>*Les préconditions*</u>] pour obtenir les registres pour un versement du directeur de l'état civil sont :

 * Un versement doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * Si l'usager est externe, l'organisme de l'usager doit être l'organisme du versement sinon un code HTTP 403 est retourné.

===== Exemple de requête

include::{snippets}/get_obtenirDocumentsVersement_reg/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_obtenirDocumentsVersement_reg/http-response.adoc[]


[[services-pistard-acquisition-publique-document-reg-creer]]
==== Créer un registre pour un versement du directeur de l'état civil

pass:q[<u>*Les préconditions*</u>] pour créer un registre pour un versement du directeur de l'état civil sont :

 * Un versement doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * L'usager doit être externe sinon un code HTTP 403 est retourné.
 * L'organisme de l'usager doit être l'organisme du versement sinon un code HTTP 403 est retourné.
 * Le versement doit être en préparation ou en attente de transfert pour pouvoir être modifié sinon un code HTTP 403 est retourné.
 * Le numéro de registre fourni ne doit pas déjà avoir été utilisé par un autre registre du versement en cours ou d'un autre versement de l'organisme sinon un code HTTP 409 est retourné.
 * La règle de conservation choisie doit être associée à l’organisme du versement sinon un code HTTP 412 est retourné.

===== Exemple de requête

include::{snippets}/post_creerDocumentVersement_reg/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/post_creerDocumentVersement_reg/http-response.adoc[]


[[services-pistard-acquisition-publique-document-reg-modifier]]
==== Modifier un registre pour un versement du directeur de l'état civil

pass:q[<u>*Les préconditions*</u>] pour modifier un registre pour un versement du directeur de l'état civil sont :

 * Un versement doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * Si l'usager est externe, le versement doit être 'PRE - En préparation', 'MOD - À modifier' ou 'ATT - En attente de transfert' sinon un code HTTP 403 est retourné.
 * Si l'usager est interne, le versement doit être 'TRA - Transféré' et l'usager doit être l'archiviste responsable du versement sinon un code HTTP 403 est retourné.
 * L'organisme de l'usager doit être l'organisme du versement sinon un code HTTP 403 est retourné.
 * Le versement doit être en préparation ou en attente de transfert pour pouvoir être modifié sinon un code HTTP 403 est retourné.
 * Le registre modifier l'un des registres du versement sinon un code HTTP 412 est retourné.
 * Le numéro de registre fourni ne doit pas déjà avoir été utilisé par un autre registre du versement en cours ou d'un autre versement de l'organisme sinon un code HTTP 409 est retourné.
 * La règle de conservation choisie doit être associée à l’organisme du versement sinon un code HTTP 412 est retourné.

P.S. Lorsque l'archiviste responsable du versement modifie un registre pour un versement du directeur de l'état civil, il peut seulement modifier le fonds d'archives (fonds) et la série (autreInfoCoteBAnQ).

===== Exemple de requête

include::{snippets}/put_modifierDocumentVersement_reg_externe/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/put_modifierDocumentVersement_reg_externe/http-response.adoc[]


[[services-pistard-acquisition-publique-document-reg-supprimer]]
==== Supprimer un ou des registres pour un versement du directeur de l'état civil

Fournir la liste des identifiants des registres à supprimer.

pass:q[<u>*Les préconditions*</u>] pour supprimer un registre pour un versement du directeur de l'état civil sont :

 * Un versement doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * L'usager doit être externe sinon un code HTTP 403 est retourné.
 * L'organisme de l'usager doit être l'organisme du versement sinon un code HTTP 403 est retourné.
 * Le versement doit être en préparation ou en attente de transfert pour pouvoir être modifié sinon un code HTTP 403 est retourné.
 * Le ou les registres à supprimer doit être l'un des registres du versement sinon un code HTTP 412 est retourné.

===== Exemple de requête

include::{snippets}/delete_supprimerDocumentVersement_reg/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/delete_supprimerDocumentVersement_reg/http-response.adoc[]


[[services-pistard-acquisition-publique-document-reg-importer]]
==== Importer des registres pour un versement du directeur de l'état civil à partir d'un fichier XML

pass:q[<u>*Les préconditions*</u>] pour importer des registres pour un versement du directeur de l'état civil sont :

 * Un versement doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * L'usager doit être externe sinon un code HTTP 403 est retourné.
 * L'organisme de l'usager doit être l'organisme du versement sinon un code HTTP 403 est retourné.
 * Le versement doit être en préparation ou en attente de transfert pour pouvoir être modifié sinon un code HTTP 403 est retourné.
 * Le fichier XML des registres ne doit pas être vide ou contenir seulement des espaces sinon un code HTTP 412 est retourné.
 * Le fichier XML des registres doit être lisible et valide selon le schéma XSD des registres sinon un code HTTP 412 est retourné.

Un code HTTP 412 est retourné avec un message détaillé dans le payload, si une erreur survient lors de la lecture du fichier XML ou durant l'interprétation de son contenu pour obtenir les informations des registres.

Un code HTTP 409 est retourné avec une liste de messages de validation dans le payload, si des corrections aux informations des registres sont nécessaires afin de permettre leur importation.
La liste des messages de validation est associée à chaque numéro de registre auquel elle se rapporte.

===== Exemple de requête

include::{snippets}/upload_importerDocumentsVersement_reg/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/upload_importerDocumentsVersement_reg/http-response.adoc[]


[[services-pistard-acquisition-publique-document-ajd]]
=== Document administratif

Le code pour le type de document d'un document administratif est *AJD*.

Les services Web pour les documents administratifs pour un versement d'une cour municipale ou d'un tribunal provincial permettent :

 * <<services-pistard-acquisition-publique-document-ajd-filtrer>>
 * <<services-pistard-acquisition-publique-document-ajd-obtenirListe>>
 * <<services-pistard-acquisition-publique-document-ajd-creer>>
 * <<services-pistard-acquisition-publique-document-ajd-modifier>>
 * <<services-pistard-acquisition-publique-document-ajd-supprimer>>
 * <<services-pistard-acquisition-publique-document-ajd-saisieEnLot>>


[[services-pistard-acquisition-publique-document-ajd-filtrer]]
==== Filtrer les documents administratifs pour un versement d'une cour municipale ou d'un tribunal provincial

Ce service web permet de filtrer les documents administratifs pour un versement d'une cour municipale ou d'un tribunal provincial selon différents critères.

Voici les 3 critères de recherche :

 * idAcquisition : Identifiant de l'acquisition associée au versement.
 * typeDocument : Type de document égale à AJD.
 * idContenantVersementPublique : Identifiant d'un contenant du versement (Optionnel).

pass:q[<u>*Les préconditions*</u>] pour filtrer les documents administratifs pour un versement d'une cour municipale ou d'un tribunal provincial sont :

 * Un versement doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * Un contenant doit exister selon l'identifiant du contenant fourni sinon un code HTTP 404 est retourné.
 * Si l'usager est externe, l'organisme de l'usager doit être l'organisme du versement sinon un code HTTP 403 est retourné.

===== Exemple de requête

include::{snippets}/post_filtrerDocumentsVersement_ajd/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/post_filtrerDocumentsVersement_ajd/http-response.adoc[]


[[services-pistard-acquisition-publique-document-ajd-obtenirListe]]
==== Obtenir les documents administratifs pour un versement d'une cour municipale ou d'un tribunal provincial

pass:q[<u>*Les préconditions*</u>] pour obtenir les documents administratifs pour un versement d'une cour municipale ou d'un tribunal provincial sont :

 * Un versement doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * Si l'usager est externe, l'organisme de l'usager doit être l'organisme du versement sinon un code HTTP 403 est retourné.

===== Exemple de requête

include::{snippets}/get_obtenirDocumentsVersement_ajd/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_obtenirDocumentsVersement_ajd/http-response.adoc[]


[[services-pistard-acquisition-publique-document-ajd-creer]]
==== Créer un document administratif pour un versement d'une cour municipale ou d'un tribunal provincial
pass:q[<u>*Les préconditions*</u>] pour créer un document administratif pour un versement d'une cour municipale ou d'un tribunal provincial sont :

 * Un versement doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * L'usager doit être externe sinon un code HTTP 403 est retourné.
 * L'organisme de l'usager doit être l'organisme du versement sinon un code HTTP 403 est retourné.
 * Le versement doit être en préparation ou en attente de transfert pour pouvoir être modifié sinon un code HTTP 403 est retourné.
 * Si l'indicateur indRestriction fourni est vrai, une 'Précision Restriction' doit être fournie et une 'Année d'accès' n'est pas obligatoire, mais si elle est fournie elle doit être une valeur numérique de 4 chiffres sinon un code HTTP 400 est retourné.
 * La règle de conservation choisie doit être associée à l’organisme du versement sinon un code HTTP 412 est retourné.

===== Exemple de requête

include::{snippets}/post_creerDocumentVersement_ajd/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/post_creerDocumentVersement_ajd/http-response.adoc[]


[[services-pistard-acquisition-publique-document-ajd-modifier]]
==== Modifier un document administratif pour un versement d'une cour municipale ou d'un tribunal provincial

pass:q[<u>*Les préconditions*</u>] pour modifier un document administratif pour un versement d'une cour municipale ou d'un tribunal provincial sont :

 * Un versement doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * L'usager doit être externe sinon un code HTTP 403 est retourné.
 * L'organisme de l'usager doit être l'organisme du versement sinon un code HTTP 403 est retourné.
 * Le versement doit être en préparation ou en attente de transfert pour pouvoir être modifié sinon un code HTTP 403 est retourné.
 * Le document administratif à modifier doit être l'un des documents administratifs du versement sinon un code HTTP 412 est retourné.
 * Si l'indicateur indRestriction fourni est vrai, une 'Précision Restriction' doit être fournie et une 'Année d'accès' n'est pas obligatoire, mais si elle est fournie elle doit être une valeur numérique de 4 chiffres sinon un code HTTP 400 est retourné.
 * La règle de conservation choisie doit être associée à l’organisme du versement sinon un code HTTP 412 est retourné.

===== Exemple de requête

include::{snippets}/put_modifierDocumentVersement_ajd/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/put_modifierDocumentVersement_ajd/http-response.adoc[]


[[services-pistard-acquisition-publique-document-ajd-supprimer]]
==== Supprimer un ou des documents administratifs pour un versement d'une cour municipale ou d'un tribunal provincial

Fournir la liste des identifiants des documents administratifs à supprimer.

pass:q[<u>*Les préconditions*</u>] pour supprimer un document administratif pour un versement d'une cour municipale ou d'un tribunal provincial sont :

 * Un versement doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * L'usager doit être externe sinon un code HTTP 403 est retourné.
 * L'organisme de l'usager doit être l'organisme du versement sinon un code HTTP 403 est retourné.
 * Le versement doit être en préparation ou en attente de transfert pour pouvoir être modifié sinon un code HTTP 403 est retourné.
 * Le ou les documents administratifs à supprimer doit être l'un des documents administratifs du versement sinon un code HTTP 412 est retourné.

===== Exemple de requête

include::{snippets}/delete_supprimerDocumentVersement_ajd/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/delete_supprimerDocumentVersement_ajd/http-response.adoc[]


[[services-pistard-acquisition-publique-document-ajd-saisieEnLot]]
==== Saisie en lot de documents administratifs pour un versement d'une cour municipale ou d'un tribunal provincial afin de modifier une ou plusieurs métadonnées

pass:q[<u>*Les préconditions*</u>] pour saisir en lot des documents administratifs d'un versement d'une cour municipale ou d'un tribunal provincial sont :

 * Un versement doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * L'usager doit être externe sinon un code HTTP 403 est retourné.
 * L'organisme de l'usager doit être l'organisme du versement sinon un code HTTP 403 est retourné.
 * Le versement doit être en préparation ou en attente de transfert pour pouvoir être modifié sinon un code HTTP 403 est retourné.
 * Au moins un identifiant de document administratif doit être fourni dans la liste des identifiants des documents administratifs sinon un code HTTP 412 est retourné.
 * Les identifiants de document administratif fournis doivent correspondre à des documents administratifs du versement sinon un code HTTP 412 est retourné.
 * Les numéros de contenant fournis doivent exister au niveau des contenants du versement sinon un code HTTP 404 est retourné.
 * Si l'identifiant d'une règle de conservation est mentionnée, elle doit être associée à l’organisme du versement sinon un code HTTP 412 est retourné.

===== Exemple de requête

include::{snippets}/patch_saisieLotDocumentsVersement_ajd/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/patch_saisieLotDocumentsVersement_ajd/http-response.adoc[]


[[services-pistard-acquisition-publique-document-djd]]
=== Document judiciaire

Le code pour le type de document d'un document judiciaire est *DJD*.

Les services Web pour les documents judiciaires pour un versement d'un tribunal provincial permettent :

 * <<services-pistard-acquisition-publique-document-djd-filtrer>>
 * <<services-pistard-acquisition-publique-document-djd-obtenirListe>>
 * <<services-pistard-acquisition-publique-document-djd-creer>>
 * <<services-pistard-acquisition-publique-document-djd-modifier>>
 * <<services-pistard-acquisition-publique-document-djd-supprimer>>
 * <<services-pistard-acquisition-publique-document-djd-saisieEnLot>>


[[services-pistard-acquisition-publique-document-djd-filtrer]]
==== Filtrer les documents judiciaires pour un versement d'un tribunal provincial

Ce service web permet de filtrer les documents judiciaires pour un versement d'un tribunal provincial selon différents critères.

Voici les 3 critères de recherche :

 * idAcquisition : Identifiant de l'acquisition associée au versement.
 * typeDocument : Type de document égale à DJD.
 * idContenantVersementPublique : Identifiant d'un contenant du versement (Optionnel).

pass:q[<u>*Les préconditions*</u>] pour filtrer les documents judiciaires pour un versement d'un tribunal provincial sont :

 * Un versement doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * Un contenant doit exister selon l'identifiant du contenant fourni sinon un code HTTP 404 est retourné.
 * Si l'usager est externe, l'organisme de l'usager doit être l'organisme du versement sinon un code HTTP 403 est retourné.

===== Exemple de requête

include::{snippets}/post_filtrerDocumentsVersement_djd/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/post_filtrerDocumentsVersement_djd/http-response.adoc[]


[[services-pistard-acquisition-publique-document-djd-obtenirListe]]
==== Obtenir les documents judiciaires pour un versement d'un tribunal provincial

pass:q[<u>*Les préconditions*</u>] pour obtenir les documents judiciaires pour un versement d'un tribunal provincial sont :

 * Un versement doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * Si l'usager est externe, l'organisme de l'usager doit être l'organisme du versement sinon un code HTTP 403 est retourné.

===== Exemple de requête

include::{snippets}/get_obtenirDocumentsVersement_djd/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_obtenirDocumentsVersement_djd/http-response.adoc[]


[[services-pistard-acquisition-publique-document-djd-creer]]
==== Créer un document judiciaire pour un versement d'un tribunal provincial

pass:q[<u>*Les préconditions*</u>] pour créer un document judiciaire pour un versement d'un tribunal provincial sont :

 * Un versement doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * L'usager doit être externe sinon un code HTTP 403 est retourné.
 * L'organisme de l'usager doit être l'organisme du versement sinon un code HTTP 403 est retourné.
 * Le versement doit être en préparation ou en attente de transfert pour pouvoir être modifié sinon un code HTTP 403 est retourné.
 * Si l'indicateur indRestriction fourni est vrai, une 'Précision Restriction' doit être fournie et une 'Année d'accès' n'est pas obligatoire, mais si elle est fournie elle doit être une valeur numérique de 4 chiffres sinon un code HTTP 400 est retourné.
 * La règle de conservation choisie doit être associée à l’organisme du versement sinon un code HTTP 412 est retourné.

===== Exemple de requête

include::{snippets}/post_creerDocumentVersement_djd/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/post_creerDocumentVersement_djd/http-response.adoc[]


[[services-pistard-acquisition-publique-document-djd-modifier]]
==== Modifier un document judiciaire pour un versement d'un tribunal provincial

pass:q[<u>*Les préconditions*</u>] pour modifier un document judiciaire pour un versement d'un tribunal provincial sont :

 * Un versement doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * L'usager doit être externe sinon un code HTTP 403 est retourné.
 * L'organisme de l'usager doit être l'organisme du versement sinon un code HTTP 403 est retourné.
 * Le versement doit être en préparation ou en attente de transfert pour pouvoir être modifié sinon un code HTTP 403 est retourné.
 * Le document judiciaire à modifier doit être l'un des documents judiciaires du versement sinon un code HTTP 412 est retourné.
 * Si l'indicateur indRestriction fourni est vrai, une 'Précision Restriction' doit être fournie et une 'Année d'accès' n'est pas obligatoire, mais si elle est fournie elle doit être une valeur numérique de 4 chiffres sinon un code HTTP 400 est retourné.
 * La règle de conservation choisie doit être associée à l’organisme du versement sinon un code HTTP 412 est retourné.

===== Exemple de requête

include::{snippets}/put_modifierDocumentVersement_djd/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/put_modifierDocumentVersement_djd/http-response.adoc[]


[[services-pistard-acquisition-publique-document-djd-supprimer]]
==== Supprimer un ou des documents judiciaires pour un versement d'un tribunal provincial

Fournir la liste des identifiants des documents judiciaires à supprimer.

pass:q[<u>*Les préconditions*</u>] pour supprimer un document judiciaire pour un versement d'un tribunal provincial sont :

 * Un versement doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * L'usager doit être externe sinon un code HTTP 403 est retourné.
 * L'organisme de l'usager doit être l'organisme du versement sinon un code HTTP 403 est retourné.
 * Le versement doit être en préparation ou en attente de transfert pour pouvoir être modifié sinon un code HTTP 403 est retourné.
 * Le ou les documents judiciaires à supprimer doit être l'un des documents judiciaires du versement sinon un code HTTP 412 est retourné.

===== Exemple de requête

include::{snippets}/delete_supprimerDocumentVersement_djd/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/delete_supprimerDocumentVersement_djd/http-response.adoc[]


[[services-pistard-acquisition-publique-document-djd-saisieEnLot]]
==== Saisie en lot de documents judiciaires pour un versement d'un tribunal provincial afin de modifier une ou plusieurs métadonnées

pass:q[<u>*Les préconditions*</u>] pour saisir en lot des documents judiciaires d'un versement d'un tribunal provincial sont :

 * Un versement doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * L'usager doit être externe sinon un code HTTP 403 est retourné.
 * L'organisme de l'usager doit être l'organisme du versement sinon un code HTTP 403 est retourné.
 * Le versement doit être en préparation ou en attente de transfert pour pouvoir être modifié sinon un code HTTP 403 est retourné.
 * Au moins un identifiant de document judiciaire doit être fourni dans la liste des identifiants des documents judiciaires sinon un code HTTP 412 est retourné.
 * Les identifiants de document judiciaire fournis doivent correspondre à des documents judiciaires du versement sinon un code HTTP 412 est retourné.
 * Les numéros de contenant fournis doivent exister au niveau des contenants du versement sinon un code HTTP 404 est retourné.
 * Si l'identifiant d'une règle de conservation est mentionnée, elle doit être associée à l’organisme du versement sinon un code HTTP 412 est retourné.

===== Exemple de requête

include::{snippets}/patch_saisieLotDocumentsVersement_djd/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/patch_saisieLotDocumentsVersement_djd/http-response.adoc[]


[[services-pistard-acquisition-publique-document-cjd]]
=== Cause judiciaire

Le code pour le type de document d'une cause judiciaire est *CJD*.

Les services Web pour les causes judiciaires pour un versement d'un tribunal provincial permettent :

 * <<services-pistard-acquisition-publique-document-cjd-filtrer>>
 * <<services-pistard-acquisition-publique-document-cjd-obtenirListe>>
 * <<services-pistard-acquisition-publique-document-cjd-modifier>>
 * <<services-pistard-acquisition-publique-document-cjd-supprimer>>
 * <<services-pistard-acquisition-publique-document-cjd-importer>>
 * <<services-pistard-acquisition-publique-document-cjd-saisieEnLot>>


[[services-pistard-acquisition-publique-document-cjd-filtrer]]
==== Filtrer les causes judiciaires pour un versement d'un tribunal provincial

Ce service web permet de filtrer les causes judiciaires pour un versement d'un tribunal provincial selon différents critères.

Voici les 3 critères de recherche :

 * idAcquisition : Identifiant de l'acquisition associée au versement.
 * typeDocument : Type de document égale à CJD.
 * idContenantVersementPublique : Identifiant d'un contenant du versement (Optionnel).

pass:q[<u>*Les préconditions*</u>] pour filtrer les causes judiciaires pour un versement d'un tribunal provincial sont :

 * Un versement doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * Un contenant doit exister selon l'identifiant du contenant fourni sinon un code HTTP 404 est retourné.
 * Si l'usager est externe, l'organisme de l'usager doit être l'organisme du versement sinon un code HTTP 403 est retourné.

===== Exemple de requête

include::{snippets}/post_filtrerDocumentsVersement_cjd/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/post_filtrerDocumentsVersement_cjd/http-response.adoc[]


[[services-pistard-acquisition-publique-document-cjd-obtenirListe]]
==== Obtenir les causes judiciaires pour un versement d'un tribunal provincial

pass:q[<u>*Les préconditions*</u>] pour obtenir les causes judiciaires pour un versement d'un tribunal provincial sont :

 * Un versement doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * Si l'usager est externe, l'organisme de l'usager doit être l'organisme du versement sinon un code HTTP 403 est retourné.

===== Exemple de requête

include::{snippets}/get_obtenirDocumentsVersement_cjd/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_obtenirDocumentsVersement_cjd/http-response.adoc[]


[[services-pistard-acquisition-publique-document-cjd-modifier]]
==== Modifier un cause judiciaire pour un versement d'un tribunal provincial

pass:q[<u>*Les préconditions*</u>] pour modifier un cause judiciaire pour un versement d'un tribunal provincial sont :

 * Un versement doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * L'usager doit être externe sinon un code HTTP 403 est retourné.
 * L'organisme de l'usager doit être l'organisme du versement sinon un code HTTP 403 est retourné.
 * Le versement doit être en préparation ou en attente de transfert pour pouvoir être modifié sinon un code HTTP 403 est retourné.
 * Le cause judiciaire à modifier doit être l'un des causes judiciaires du versement sinon un code HTTP 412 est retourné.
 * Si l'indicateur indRestriction fourni est vrai, une 'Précision Restriction' doit être fournie et une 'Année d'accès' n'est pas obligatoire, mais si elle est fournie elle doit être une valeur numérique de 4 chiffres sinon un code HTTP 400 est retourné.
 * La règle de conservation choisie doit être associée à l’organisme du versement sinon un code HTTP 412 est retourné.

===== Exemple de requête

include::{snippets}/put_modifierDocumentVersement_cjd/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/put_modifierDocumentVersement_cjd/http-response.adoc[]


[[services-pistard-acquisition-publique-document-cjd-supprimer]]
==== Supprimer un ou des causes judiciaires pour un versement d'un tribunal provincial

Fournir la liste des identifiants des causes judiciaires à supprimer.

pass:q[<u>*Les préconditions*</u>] pour supprimer un cause judiciaire pour un versement d'un tribunal provincial sont :

 * Un versement doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * L'usager doit être externe sinon un code HTTP 403 est retourné.
 * L'organisme de l'usager doit être l'organisme du versement sinon un code HTTP 403 est retourné.
 * Le versement doit être en préparation ou en attente de transfert pour pouvoir être modifié sinon un code HTTP 403 est retourné.
 * Le ou les causes judiciaires à supprimer doit être l'un des causes judiciaires du versement sinon un code HTTP 412 est retourné.

===== Exemple de requête

include::{snippets}/delete_supprimerDocumentVersement_cjd/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/delete_supprimerDocumentVersement_cjd/http-response.adoc[]


[[services-pistard-acquisition-publique-document-cjd-importer]]
==== Importer des causes judiciaires pour un versement d'un tribunal provincial à partir d'un fichier CSV

pass:q[<u>*Les préconditions*</u>] pour importer des causes judiciaires pour un versement d'un tribunal provincial sont :

 * Un versement doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * L'usager doit être externe sinon un code HTTP 403 est retourné.
 * L'organisme de l'usager doit être l'organisme du versement sinon un code HTTP 403 est retourné.
 * Le versement doit être en préparation ou en attente de transfert pour pouvoir être modifié sinon un code HTTP 403 est retourné.
 * Le fichier CSV des causes ne doit pas être vide ou contenir seulement des espaces sinon un code HTTP 412 est retourné.
 * Le fichier CSV des causes doit être lisible et valide selon le format prévu sinon un code HTTP 412 est retourné.

Un code HTTP 412 est retourné avec un message détaillé dans le payload, si une erreur survient lors de la lecture du fichier CSV ou durant l'interprétation de son contenu pour obtenir les informations des causes.

Un code HTTP 409 est retourné avec une liste de messages de validation dans le payload, si des corrections aux informations des causes sont nécessaires afin de permettre leur importation.
La liste des messages de validation est associée à chaque numéro de cause auquel elle se rapporte.

===== Exemple de requête

include::{snippets}/upload_importerDocumentsVersement_cjd/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/upload_importerDocumentsVersement_cjd/http-response.adoc[]

[[services-pistard-acquisition-publique-document-cjd-saisieEnLot]]
==== Saisie en lot de causes judiciaires pour un versement d'un tribunal provincial afin de modifier une ou plusieurs métadonnées

pass:q[<u>*Les préconditions*</u>] pour saisir en lot des causes judiciaires d'un versement d'un tribunal provincial sont :

 * Un versement doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * L'usager doit être externe sinon un code HTTP 403 est retourné.
 * L'organisme de l'usager doit être l'organisme du versement sinon un code HTTP 403 est retourné.
 * Le versement doit être en préparation ou en attente de transfert pour pouvoir être modifié sinon un code HTTP 403 est retourné.
 * Au moins un identifiant de cause judiciaire doit être fourni dans la liste des identifiants des causes judiciaires sinon un code HTTP 412 est retourné.
 * Les identifiants de cause judiciaire fournis doivent correspondre à des causes judiciaires du versement sinon un code HTTP 412 est retourné.
 * Les numéros de contenant fournis doivent exister au niveau des contenants du versement sinon un code HTTP 404 est retourné.
 * Si l'identifiant d'une règle de conservation est mentionnée, elle doit être associée à l’organisme du versement sinon un code HTTP 412 est retourné.

===== Exemple de requête

include::{snippets}/patch_saisieLotDocumentsVersement_cjd/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/patch_saisieLotDocumentsVersement_cjd/http-response.adoc[]
 
 
[[services-pistard-acquisition-publique-document-rjd]]
=== Registre judiciaire

Le code pour le type de document d'un registre judiciaire est *RJD*.

Les services Web pour les registres judiciaires pour un versement d'un tribunal provincial permettent :

 * <<services-pistard-acquisition-publique-document-rjd-filtrer>>
 * <<services-pistard-acquisition-publique-document-rjd-obtenirListe>>
 * <<services-pistard-acquisition-publique-document-rjd-creer>>
 * <<services-pistard-acquisition-publique-document-rjd-modifier>>
 * <<services-pistard-acquisition-publique-document-rjd-supprimer>>
 * <<services-pistard-acquisition-publique-document-rjd-importer>>
 * <<services-pistard-acquisition-publique-document-rjd-saisieEnLot>>


[[services-pistard-acquisition-publique-document-rjd-filtrer]]
==== Filtrer les registres judiciaires pour un versement d'un tribunal provincial

Ce service web permet de filtrer les registres judiciaires pour un versement d'un tribunal provincial selon différents critères.

Voici les 2 critères de recherche :

 * idAcquisition : Identifiant de l'acquisition associée au versement.
 * typeDocument : Type de document égale à RJD.

pass:q[<u>*Les préconditions*</u>] pour filtrer les registres judiciaires pour un versement d'un tribunal provincial sont :

 * Un versement doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * Si l'usager est externe, l'organisme de l'usager doit être l'organisme du versement sinon un code HTTP 403 est retourné.

===== Exemple de requête

include::{snippets}/post_filtrerDocumentsVersement_rjd/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/post_filtrerDocumentsVersement_rjd/http-response.adoc[]


[[services-pistard-acquisition-publique-document-rjd-obtenirListe]]
==== Obtenir les registres judiciaires pour un versement d'un tribunal provincial

pass:q[<u>*Les préconditions*</u>] pour obtenir les registres judiciaires pour un versement d'un tribunal provincial sont :

 * Un versement doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * Si l'usager est externe, l'organisme de l'usager doit être l'organisme du versement sinon un code HTTP 403 est retourné.

===== Exemple de requête

include::{snippets}/get_obtenirDocumentsVersement_rjd/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_obtenirDocumentsVersement_rjd/http-response.adoc[]


[[services-pistard-acquisition-publique-document-rjd-creer]]
==== Créer un registre judiciaire pour un versement d'un tribunal provincial

pass:q[<u>*Les préconditions*</u>] pour créer un registre judiciaire pour un versement d'un tribunal provincial sont :

 * Un versement doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * L'usager doit être externe sinon un code HTTP 403 est retourné.
 * L'organisme de l'usager doit être l'organisme du versement sinon un code HTTP 403 est retourné.
 * Le versement doit être en préparation ou en attente de transfert pour pouvoir être modifié sinon un code HTTP 403 est retourné.
 * Si l'indicateur indRestriction fourni est vrai, une 'Précision Restriction' doit être fournie et une 'Année d'accès' n'est pas obligatoire, mais si elle est fournie elle doit être une valeur numérique de 4 chiffres sinon un code HTTP 400 est retourné.
 * La règle de conservation choisie doit être associée à l’organisme du versement sinon un code HTTP 412 est retourné.

===== Exemple de requête

include::{snippets}/post_creerDocumentVersement_rjd/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/post_creerDocumentVersement_rjd/http-response.adoc[]


[[services-pistard-acquisition-publique-document-rjd-modifier]]
==== Modifier un registre judiciaire pour un versement d'un tribunal provincial

pass:q[<u>*Les préconditions*</u>] pour modifier un registre judiciaire pour un versement d'un tribunal provincial sont :

 * Un versement doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * L'usager doit être externe sinon un code HTTP 403 est retourné.
 * L'organisme de l'usager doit être l'organisme du versement sinon un code HTTP 403 est retourné.
 * Le versement doit être en préparation ou en attente de transfert pour pouvoir être modifié sinon un code HTTP 403 est retourné.
 * Le registre judiciaire à modifier doit être l'un des registres judiciaires du versement sinon un code HTTP 412 est retourné.
 * Si l'indicateur indRestriction fourni est vrai, une 'Précision Restriction' doit être fournie et une 'Année d'accès' n'est pas obligatoire, mais si elle est fournie elle doit être une valeur numérique de 4 chiffres sinon un code HTTP 400 est retourné.
 * La règle de conservation choisie doit être associée à l’organisme du versement sinon un code HTTP 412 est retourné.

===== Exemple de requête

include::{snippets}/put_modifierDocumentVersement_rjd/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/put_modifierDocumentVersement_rjd/http-response.adoc[]


[[services-pistard-acquisition-publique-document-rjd-supprimer]]
==== Supprimer un ou des registres judiciaires pour un versement d'un tribunal provincial

Fournir la liste des identifiants des registres judiciaires à supprimer.

pass:q[<u>*Les préconditions*</u>] pour supprimer un registre judiciaire pour un versement d'un tribunal provincial sont :

 * Un versement doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * L'usager doit être externe sinon un code HTTP 403 est retourné.
 * L'organisme de l'usager doit être l'organisme du versement sinon un code HTTP 403 est retourné.
 * Le versement doit être en préparation ou en attente de transfert pour pouvoir être modifié sinon un code HTTP 403 est retourné.
 * Le ou les registres judiciaires à supprimer doit être l'un des registres judiciaires du versement sinon un code HTTP 412 est retourné.

===== Exemple de requête

include::{snippets}/delete_supprimerDocumentVersement_rjd/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/delete_supprimerDocumentVersement_rjd/http-response.adoc[]


[[services-pistard-acquisition-publique-document-rjd-importer]]
==== Importer des registres judiciaires pour un versement d'un tribunal provincial à partir d'un fichier XML

pass:q[<u>*Les préconditions*</u>] pour importer des registres pour un versement d'un tribunal provincial sont :

 * Un versement doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * L'usager doit être externe sinon un code HTTP 403 est retourné.
 * L'organisme de l'usager doit être l'organisme du versement sinon un code HTTP 403 est retourné.
 * Le versement doit être en préparation ou en attente de transfert pour pouvoir être modifié sinon un code HTTP 403 est retourné.
 * Le fichier XML des registres ne doit pas être vide ou contenir seulement des espaces sinon un code HTTP 412 est retourné.
 * Le fichier XML des registres doit être lisible et valide selon le schéma XSD des registres sinon un code HTTP 412 est retourné.

Un code HTTP 412 est retourné avec un message détaillé dans le payload, si une erreur survient lors de la lecture du fichier XML ou durant l'interprétation de son contenu pour obtenir les informations des registres.

Un code HTTP 409 est retourné avec une liste de messages de validation dans le payload, si des corrections aux informations des registres sont nécessaires afin de permettre leur importation.
La liste des messages de validation est associée à chaque numéro de dossier auquel elle se rapporte.

===== Exemple de requête

include::{snippets}/upload_importerDocumentsVersement_rjd/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/upload_importerDocumentsVersement_rjd/http-response.adoc[]


[[services-pistard-acquisition-publique-document-rjd-saisieEnLot]]
==== Saisie en lot de registres judiciaires pour un versement d'un tribunal provincial afin de modifier une ou plusieurs métadonnées

pass:q[<u>*Les préconditions*</u>] pour saisir en lot des registres judiciaires d'un versement d'un tribunal provincial sont :

 * Un versement doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * L'usager doit être externe sinon un code HTTP 403 est retourné.
 * L'organisme de l'usager doit être l'organisme du versement sinon un code HTTP 403 est retourné.
 * Le versement doit être en préparation ou en attente de transfert pour pouvoir être modifié sinon un code HTTP 403 est retourné.
 * Au moins un identifiant de registre judiciaire doit être fourni dans la liste des identifiants des registres judiciaires sinon un code HTTP 412 est retourné.
 * Les identifiants de registre judiciaire fournis doivent correspondre à des registres judiciaires du versement sinon un code HTTP 412 est retourné.
 * Les numéros de contenant fournis doivent exister au niveau des contenants du versement sinon un code HTTP 404 est retourné.
 * Si l'identifiant d'une règle de conservation est mentionnée, elle doit être associée à l’organisme du versement sinon un code HTTP 412 est retourné.

===== Exemple de requête

include::{snippets}/patch_saisieLotDocumentsVersement_rjd/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/patch_saisieLotDocumentsVersement_rjd/http-response.adoc[]


[[services-pistard-acquisition-unitePreTraitement]]
=== Unité de pré-traitement

Les services Web pour les unités de pré-traitement permettent :

 * <<services-pistard-acquisition-unitePreTraitement-filtrer>>
 * <<services-pistard-acquisition-unitePreTraitement-creer>>
 * <<services-pistard-acquisition-unitePreTraitement-obtenir>>
 * <<services-pistard-acquisition-unitePreTraitement-modifier>>
 * <<services-pistard-acquisition-unitePreTraitement-supprimer>>
 * <<services-pistard-acquisition-unitePreTraitement-conserver>>
 * <<services-pistard-acquisition-unitePreTraitement-valider>>
 * <<services-pistard-acquisition-unitePreTraitement-invalider>>
 * <<services-pistard-acquisition-unitePreTraitement-classifier>>
 * <<services-pistard-acquisition-unitePreTraitement-ranger>>
 * <<services-pistard-acquisition-unitePreTraitement-retirer>>
 * <<services-pistard-acquisition-unitePreTraitement-basculer>>

Voici les types de document pour les unités de pré-traitement :

 * DPV - Dossier archives privées
 * DOS - Dossier archives gouvernementales
 * REG - Registre archives du Directeur de l'état civil
 * AJD - Document administratif archives judiciaires et civiles
 * DJD - Document judiciaire archives judiciaires
 * CJD - Cause judiciaire archives judiciaires
 * RJD - Registre judiciaire archives judiciaires

[[services-pistard-acquisition-unitePreTraitement-filtrer]]
==== Filtrer les unités de pré-traitement

Ce service web permet de filtrer les unités de pré-traitement selon différents critères.

pass:q[<u>*Les préconditions*</u>] pour filtrer les unités de pré-traitement sont :

 * Une acquisition doit exister selon l'identifiant d'acquisition fourni sinon un code HTTP 404 est retourné.
 * Un contenant du versement associé à l'acquisition doit exister selon l'identifiant du contenant fourni sinon un code HTTP 404 est retourné.
 * Un contenant BAnQ associé à l'acquisition doit exister selon l'identifiant du contenant fourni sinon un code HTTP 404 est retourné.
 * L'usager doit être interne sinon un code HTTP 403 est retourné.

Voici les 3 critères de recherche :

 * idAcquisition - Identifiant de l'acquisition associée.
 * idContenantVersementPublique - Identifiant d'un contenant du versement associé à l'acquisition (Optionnel).
 * idContenantBAnQ : Identifiant d'un contenant BAnQ (Optionnel).

Le tri par défaut est ascendant sur le champ *noVerseur* et ensuite sur le champ *titre* pour trier les unités de pré-traitement avec aucun numéro du verseur.

Voici le nom des champs possibles pour trier les résultats de recherche :

 * noVerseur - Numéro du verseur
 * titre - Titre
 * dateDebut - Date de début
 * dateFin - Date de fin
 * nbrContenantsVerseur - Nombre de contenants verseur
 * nbrContenantsBAnQ - Nombre de contenants BAnQ
 * coteUniteParentOuCreee - Cote de l'unité créée ou de l'unité parent si l'unité de pré-traitement n'a pas été basculée
 * indAnaNum - Indicateurs indAnalogique et indNumerique
 * statutUniteCreee - Statut de l'unité créée si l'unité de pré-traitement a été basculée

===== Exemple de requête

include::{snippets}/post_filtrerUnitesPreTraitement/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/post_filtrerUnitesPreTraitement/http-response.adoc[]


[[services-pistard-acquisition-unitePreTraitement-creer]]
==== Créer une unité de pré-traitement pour une acquisition

Ce service web permet de cérer une unité de pré-traitement pour une acquisition. Cette création active les indicateurs *indAEteAjoute* (IND_AJOUTE) et *indEstConserve* (IND_CONSERVE).

Le *typeDocument* est déterminé selon l'acquisition associée privée ou publique et selon le *typeDocumentVersement* du versement pour une acquisition publique. Dans le cas que le *typeDocumentVersement* est égal à *JUD*, à ce moment là, la propriété *typeDocument* doit être précisée dans la requête de création d'une unité de pré-traitement pour la valeur *CJD* ou *DJD*.

pass:q[<u>*Les préconditions*</u>] pour créer une unité de pré-traitement pour une acquisition sont :

 * Une acquisition doit exister selon l'identifiant fourni sinon un code HTTP 404 est retourné.
 * L'usager doit être interne et assigné à l'acquisition sinon un code HTTP 403 est retourné.
 * Pour une acquisition publique, si le *typeDocumentVersement* est égal à *JUD*, la propriété *typeDocument* doit être précisée avec la valeur *CJD* ou *DJD* sinon un code HTTP 412 est retourné.
 * Pour une acquisition publique, le versement doit être 'ETR - En traitement' pour pouvoir créer une unité de pré-traitement sinon un code HTTP 412 est retourné.
 * Pour une acquisition privée, l'offre doit être 'ETR - En traitement' pour pouvoir créer une unité de pré-traitement sinon un code HTTP 412 est retourné.

===== Exemple de requête

include::{snippets}/post_creerUnitePreTraitement/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/post_creerUnitePreTraitement/http-response.adoc[]


[[services-pistard-acquisition-unitePreTraitement-obtenir]]
==== Obtenir une unité de pré-traitement

pass:q[<u>*La précondition*</u>] pour obtenir une unité de pré-traitement est :

 * Une unité de pré-traitement doit exister selon l'identifiant fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/get_obtenirUnitePreTraitement/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_obtenirUnitePreTraitement/http-response.adoc[]


[[services-pistard-acquisition-unitePreTraitement-modifier]]
==== Modifier une unité de pré-traitement

pass:q[<u>*Les préconditions*</u>] pour modifier une unité de pré-traitement sont :

 * Une unité de pré-traitement doit exister selon l'identifiant fourni sinon un code HTTP 404 est retourné.
 * L'usager doit être interne et assigné à l'acquisition sinon un code HTTP 403 est retourné.
 * Une unité de pré-traitement ne doit pas avoir été basculée et doit être conservée sinon un code HTTP 412 est retourné.
 * Pour une acquisition publique, le versement doit être 'ETR - En traitement' pour pouvoir modifier une unité de pré-traitement sinon un code HTTP 412 est retourné.
 * Pour une acquisition privée, l'offre doit être 'ETR - En traitement' pour pouvoir modifier une unité de pré-traitement sinon un code HTTP 412 est retourné.

===== Exemple de requête

include::{snippets}/put_modifierUnitePreTraitement/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/put_modifierUnitePreTraitement/http-response.adoc[]


[[services-pistard-acquisition-unitePreTraitement-supprimer]]
==== Supprimer une ou plusieurs unités de pré-traitement

Ce service web permet d'invalider une ou plusieurs unités de pré-traitement ce qui désactive l'indicateur *indEstConserve* (IND_CONSERVE).

pass:q[<u>*Les préconditions*</u>] pour supprimer une ou plusieurs unités de pré-traitement sont :

 * La ou les unités de pré-traitement doivent exister selon les identifiants fournis sinon un code HTTP 404 est retourné.
 * L'usager doit être interne et assigné à l'acquisition sinon un code HTTP 403 est retourné.
 * Une unité de pré-traitement ne doit pas avoir été basculée sinon un code HTTP 412 est retourné.
 * Pour une acquisition publique, le versement doit être 'ETR - En traitement' pour pouvoir supprimer une ou plusieurs unités de pré-traitement sinon un code HTTP 412 est retourné.
 * Pour une acquisition privée, l'offre doit être 'ETR - En traitement' pour pouvoir supprimer une ou plusieurs unités de pré-traitement sinon un code HTTP 412 est retourné.

===== Exemple de requête

include::{snippets}/patch_supprimerUnitesPreTraitement/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/patch_supprimerUnitesPreTraitement/http-response.adoc[]


[[services-pistard-acquisition-unitePreTraitement-conserver]]
==== Conserver une ou plusieurs unités de pré-traitement

Ce service web permet de valider une ou plusieurs unités de pré-traitement ce qui active l'indicateur *indEstConserve* (IND_CONSERVE).

pass:q[<u>*Les préconditions*</u>] pour conserver une ou plusieurs unités de pré-traitement sont :

 * La ou les unités de pré-traitement doivent exister selon les identifiants fournis sinon un code HTTP 404 est retourné.
 * L'usager doit être interne et assigné à l'acquisition sinon un code HTTP 403 est retourné.
 * Une unité de pré-traitement ne doit pas avoir été basculée sinon un code HTTP 412 est retourné.
 * Pour une acquisition publique, le versement doit être 'ETR - En traitement' pour pouvoir conserver une ou plusieurs unités de pré-traitement sinon un code HTTP 412 est retourné.
 * Pour une acquisition privée, l'offre doit être 'ETR - En traitement' pour pouvoir conserver une ou plusieurs unités de pré-traitement sinon un code HTTP 412 est retourné.

===== Exemple de requête

include::{snippets}/patch_conserverUnitesPreTraitement/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/patch_conserverUnitesPreTraitement/http-response.adoc[]


[[services-pistard-acquisition-unitePreTraitement-valider]]
==== Valider une ou plusieurs unités de pré-traitement

Ce service web permet de valider une ou plusieurs unités de pré-traitement ce qui active l'indicateur *indAEteValide* (IND_VALIDE).

pass:q[<u>*Les préconditions*</u>] pour valider une ou plusieurs unités de pré-traitement sont :

 * La ou les unités de pré-traitement doivent exister selon les identifiants fournis sinon un code HTTP 404 est retourné.
 * L'usager doit être interne et assigné à l'acquisition sinon un code HTTP 403 est retourné.
 * Une unité de pré-traitement ne doit pas avoir été basculée sinon un code HTTP 412 est retourné.
 * Pour une acquisition publique, le versement doit être 'ETR - En traitement' pour pouvoir valider une ou plusieurs unités de pré-traitement sinon un code HTTP 412 est retourné.
 * Pour une acquisition privée, l'offre doit être 'ETR - En traitement' pour pouvoir valider une ou plusieurs unités de pré-traitement sinon un code HTTP 412 est retourné.

===== Exemple de requête

include::{snippets}/patch_validerUnitesPreTraitement/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/patch_validerUnitesPreTraitement/http-response.adoc[]


[[services-pistard-acquisition-unitePreTraitement-invalider]]
==== Invalider une ou plusieurs unités de pré-traitement

Ce service web permet d'invalider une ou plusieurs unités de pré-traitement ce qui désactive l'indicateur *indAEteValide* (IND_VALIDE).

pass:q[<u>*Les préconditions*</u>] pour invalider une ou plusieurs unités de pré-traitement sont :

 * La ou les unités de pré-traitement doivent exister selon les identifiants fournis sinon un code HTTP 404 est retourné.
 * L'usager doit être interne et assigné à l'acquisition sinon un code HTTP 403 est retourné.
 * Une unité de pré-traitement ne doit pas avoir été basculée sinon un code HTTP 412 est retourné.
 * Pour une acquisition publique, le versement doit être 'ETR - En traitement' pour pouvoir invalider une ou plusieurs unités de pré-traitement sinon un code HTTP 412 est retourné.
 * Pour une acquisition privée, l'offre doit être 'ETR - En traitement' pour pouvoir invalider une ou plusieurs unités de pré-traitement sinon un code HTTP 412 est retourné.

===== Exemple de requête

include::{snippets}/patch_invaliderUnitesPreTraitement/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/patch_invaliderUnitesPreTraitement/http-response.adoc[]


[[services-pistard-acquisition-unitePreTraitement-classifier]]
==== Classifier une ou plusieurs unités de pré-traitement

Ce service web permet de classifier une ou plusieurs unités de pré-traitement afin de modifier l'unité de description parent qui sera utilisée pour créer une nouvelle unité de description lors de la bascule.

pass:q[<u>*Les préconditions*</u>] pour classifier une ou plusieurs unités de pré-traitement sont :

 * La ou les unités de pré-traitement doivent exister selon les identifiants fournis sinon un code HTTP 404 est retourné.
 * L'unité de description parent doit exister selon l'identifiant fourni sinon un code HTTP 404 est retourné.
 * L'usager doit être interne et assigné à l'acquisition sinon un code HTTP 403 est retourné.
 * Une unité de pré-traitement ne doit pas avoir été basculée et doit être conservée sinon un code HTTP 412 est retourné.
 * Pour une acquisition publique, le versement doit être 'ETR - En traitement' pour pouvoir modifier une ou plusieurs unités de pré-traitement sinon un code HTTP 412 est retourné.
 * Pour une acquisition privée, l'offre doit être 'ETR - En traitement' pour pouvoir modifier une ou plusieurs unités de pré-traitement sinon un code HTTP 412 est retourné.

===== Exemple de requête

include::{snippets}/patch_classifierUnitesPreTraitement/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/patch_classifierUnitesPreTraitement/http-response.adoc[]


[[services-pistard-acquisition-unitePreTraitement-ranger]]
==== Ranger une ou plusieurs unités de pré-traitement

Ce service web permet de ranger une ou plusieurs unités de pré-traitement dans un ou plusieurs contenants BAnQ. Les contenants BAnQ associés à une unité de pré-traitement seront utilisés pour créer automatiquement des contenus de fonds pour la nouvelle unité de description qui sera créée lors de sa bascule.

pass:q[<u>*Les préconditions*</u>] pour ranger une ou plusieurs unités de pré-traitement dans un ou plusieurs contenants BAnQ sont :

 * La ou les unités de pré-traitement doivent exister selon les identifiants fournis sinon un code HTTP 404 est retourné.
 * Le ou les contenants BAnQ doivent exister selon les identifiants fournis sinon un code HTTP 404 est retourné.
 * L'usager doit être interne et assigné à l'acquisition sinon un code HTTP 403 est retourné.
 * Une unité de pré-traitement ne doit pas avoir été basculée et doit être conservée sinon un code HTTP 412 est retourné.
 * Pour une acquisition publique, le versement doit être 'ETR - En traitement' pour pouvoir modifier une ou plusieurs unités de pré-traitement sinon un code HTTP 412 est retourné.
 * Pour une acquisition privée, l'offre doit être 'ETR - En traitement' pour pouvoir modifier une ou plusieurs unités de pré-traitement sinon un code HTTP 412 est retourné.

===== Exemple de requête

include::{snippets}/patch_rangerUnitesPreTraitement/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/patch_rangerUnitesPreTraitement/http-response.adoc[]


[[services-pistard-acquisition-unitePreTraitement-retirer]]
==== Retirer une unité de pré-traitement

Ce service web permet de retirer une unité de pré-traitement d'un ou de plusieurs contenants BAnQ.

pass:q[<u>*Les préconditions*</u>] pour classifier une ou plusieurs unités de pré-traitement sont :

 * L'unité de pré-traitement doit exister selon l'identifiant fourni sinon un code HTTP 404 est retourné.
 * Le ou les contenants BAnQ doivent exister selon les identifiants fournis sinon un code HTTP 404 est retourné.
 * L'usager doit être interne et assigné à l'acquisition sinon un code HTTP 403 est retourné.
 * Une unité de pré-traitement ne doit pas avoir été basculée et doit être conservée sinon un code HTTP 412 est retourné.
 * Pour une acquisition publique, le versement doit être 'ETR - En traitement' pour pouvoir modifier une ou plusieurs unités de pré-traitement sinon un code HTTP 412 est retourné.
 * Pour une acquisition privée, l'offre doit être 'ETR - En traitement' pour pouvoir modifier une ou plusieurs unités de pré-traitement sinon un code HTTP 412 est retourné.

===== Exemple de requête

include::{snippets}/patch_retirerUnitePreTraitement/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/patch_retirerUnitePreTraitement/http-response.adoc[][


[[services-pistard-acquisition-unitePreTraitement-basculer]]
==== Basculer une ou plusieurs unités de pré-traitement

Ce service web permet de basculer une ou plusieurs unités de pré-traitement afin de créer la nouvelle unité de description de type dossier sous l'unité parent et d'activer l'indicateur *indAEteBascule* (IND_BASCULE). Aussi, les contenants BAnQ associés à chaque unité de pré-traitement seront utilisés pour créer automatiquement des contenus de fonds pour la nouvelle unité de description créée.

pass:q[<u>*Les préconditions*</u>] pour basculer une ou plusieurs unités de pré-traitement sont :

 * La ou les unités de pré-traitement doivent exister selon les identifiants fournis sinon un code HTTP 404 est retourné.
 * L'usager doit être interne et assigné à l'acquisition sinon un code HTTP 403 est retourné.
 * Une unité de pré-traitement ne doit pas avoir été basculée et doit être conservée sinon un code HTTP 412 est retourné.
 * Pour une acquisition publique, le versement doit être 'ETR - En traitement' pour pouvoir modifier une ou plusieurs unités de pré-traitement sinon un code HTTP 412 est retourné.
 * Pour une acquisition privée, l'offre doit être 'ETR - En traitement' pour pouvoir modifier une ou plusieurs unités de pré-traitement sinon un code HTTP 412 est retourné.

===== Exemple de requête

include::{snippets}/patch_basculerUnitesPreTraitement/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/patch_basculerUnitesPreTraitement/http-response.adoc[]


[[services-pistard-categorieRestriction]]
=== Catégorie de restriction

Les services Web pour les catégories de restriction permettent :

 * <<services-banq-reference-categorieRestriction-obtenirListe>>
 * <<services-banq-reference-categorieRestriction-obtenir>>

[[services-banq-reference-categorieRestriction-obtenirListe]]
==== Obtenir les catégories de restriction

===== Exemple de requête

include::{snippets}/get_categoriesRestriction/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_categoriesRestriction/http-response.adoc[]


[[services-banq-reference-categorieRestriction-obtenir]]
==== Obtenir une catégorie de restriction à partir de son code

pass:q[<u>*La précondition*</u>] pour obtenir une catégorie de restriction est :

 * Une catégorie de restriction doit exister selon le code fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/get_categorieRestriction/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_categorieRestriction/http-response.adoc[]


[[services-pistard-typeDuree]]
=== Type de durée

Les services Web pour les types de duree permettent :

 * <<services-banq-reference-typeDuree-obtenirListe>>
 * <<services-banq-reference-typeDuree-obtenir>>

[[services-banq-reference-typeDuree-obtenirListe]]
==== Obtenir les types de duree

===== Exemple de requête

include::{snippets}/get_typesDuree/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_typesDuree/http-response.adoc[]


[[services-banq-reference-typeDuree-obtenir]]
==== Obtenir un type de duree à partir de son code

pass:q[<u>*La précondition*</u>] pour obtenir une type de duree est :

 * Une type de duree doit exister selon le code fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/get_typeDuree/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_typeDuree/http-response.adoc[]


[[services-pistard-demandeRestriction]]
=== Demande de restriction

Les services Web pour les demandes de restriction permettent :

 * <<services-pistard-demandeRestriction-obtenirListe>>
 * <<services-pistard-demandeRestriction-obtenir>>
 * <<services-pistard-demandeRestriction-creer>>
 * <<services-pistard-demandeRestriction-modifier>>
 * <<services-pistard-demandeRestriction-accepter-ajout>>
 * <<services-pistard-demandeRestriction-accepter-modification>>
 * <<services-pistard-demandeRestriction-refuser>>

Voici les rôles des employés pouvant créer une demande de restriction :

 * Analyste restriction (ANALYSTE_RESTRICTION)
 * Coordonnateur d'un centre d'archives BAnQ (COORDONNATEUR)
 * Archiviste d'un centre d'archives BAnQ (PROFESSIONNEL)

Le rôle d'analyse restriction (ANALYSTE_RESTRICTION) est nécessaire pour *accepter* ou *refuser* une demande de restriction à partir de Advitam.

Voici les types de demande possibles pour une demande de restriction :

 * A - Ajout
 * M - Modification

Voici les statuts possibles pour une demande de restriction :

 * NOU - Nouvelle
 * ACC - Acceptée
 * REF - Refusée
 * TER - Terminée

[[services-pistard-demandeRestriction-obtenirListe]]
==== Obtenir les demandes de restriction

===== Exemple de requête

include::{snippets}/get_demandesRestriction/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_demandesRestriction/http-response.adoc[]


[[services-pistard-demandeRestriction-obtenir]]
==== Obtenir une demande de restriction

pass:q[<u>*La précondition*</u>] pour obtenir une demande de restriction est :

 * Une demande de restriction doit exister selon l'identifiant fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/get_demandeRestriction/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_demandeRestriction/http-response.adoc[]


[[services-pistard-demandeRestriction-creer]]
==== Créer une demande de restriction

pass:q[<u>*Les préconditions*</u>] pour créer une demande de restriction sont :

 * L'employé doit avoir l'un des rôles ANALYSTE_RESTRICTION, COORDONNATEUR ou PROFESSIONNEL sinon un code HTTP 403 est retourné.
 * Si une demande de modification d'une restriction existe déjà au statut 'NOU - Nouvelle' ou 'ACC - Acceptée' pour la même restriction un code HTTP 409 est retourné.
 
===== Exemple de requête

include::{snippets}/post_creerDemandeRestriction/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/post_creerDemandeRestriction/http-response.adoc[]


[[services-pistard-demandeRestriction-modifier]]
==== Modifier une demande de restriction pour fournir une raison du refus

pass:q[<u>*Les préconditions*</u>] pour modifier une demande de restriction pour fournir une raison du refus sont :

 * Une demande de restriction doit exister selon l'identifiant fourni sinon un code HTTP 404 est retourné.
 * L'employé doit avoir le rôle ANALYSTE_RESTRICTION sinon un code HTTP 403 est retourné.
 
===== Exemple de requête

include::{snippets}/put_modifierDemandeRestriction/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/put_modifierDemandeRestriction/http-response.adoc[]


[[services-pistard-demandeRestriction-accepter-ajout]]
==== Accepter une demande d'ajout d'une restriction

Accepter une demande d'ajout d'une restriction va créer une nouvelle restriction associée à la demande.

pass:q[<u>*Les préconditions*</u>] pour accepter une demande d'ajout d'une restriction sont :

 * Une demande de restriction doit exister selon l'identifiant fourni sinon un code HTTP 404 est retourné.
 * L'employé doit avoir le rôle ANALYSTE_RESTRICTION sinon un code HTTP 403 est retourné.

===== Exemple de requête

include::{snippets}/patch_accepterDemandeRestriction_Ajout/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/patch_accepterDemandeRestriction_Ajout/http-response.adoc[]


[[services-pistard-demandeRestriction-accepter-modification]]
==== Accepter une demande de modification d'une restriction

Accepter une demande de modification d'une restriction va créer une nouvelle restriction associée à la demande.

pass:q[<u>*Les préconditions*</u>] pour accepter une demande de modification d'une restriction sont :

 * Une demande de restriction doit exister selon l'identifiant fourni sinon un code HTTP 404 est retourné.
 * L'employé doit avoir le rôle ANALYSTE_RESTRICTION sinon un code HTTP 403 est retourné.

===== Exemple de requête

include::{snippets}/patch_accepterDemandeRestriction_Modification/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/patch_accepterDemandeRestriction_Modification/http-response.adoc[]


[[services-pistard-demandeRestriction-refuser]]
==== Refuser une demande de restriction

pass:q[<u>*Les préconditions*</u>] pour refuser une demande de restriction sont :

 * Une demande de restriction doit exister selon l'identifiant fourni sinon un code HTTP 404 est retourné.
 * L'employé doit avoir le rôle ANALYSTE_RESTRICTION sinon un code HTTP 403 est retourné.

===== Exemple de requête

include::{snippets}/patch_refuserDemandeRestriction/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/patch_refuserDemandeRestriction/http-response.adoc[]


[[services-pistard-restriction]]
=== Restriction type

Les services Web pour les restrictions type permettent :

 * <<services-pistard-restriction-obtenirListe>>
 * <<services-pistard-restriction-obtenir>>
 * <<services-pistard-restriction-obtenirApprouvee>>
 * <<services-pistard-restriction-modifier>>
 * <<services-pistard-restriction-approuver>>

Le rôle d'analyste des restrictions (ANALYSTE_RESTRICTION) est nécessaire pour *créer*, *modifier* et *approuver* une restriction type à partir de Advitam.

Voici les statuts possibles pour une restriction type :

 * ACT - Active
 * CMP - Complétée
 * NOU - Nouvelle

Voici les types de durée possibles pour une restriction type :

 * ANN - Nombre d'année(s) fixe
 * VAR - Variable en nombre d'année(s)
 * IND - Indéfinie
 * PER - Permanente
 * INF - Infinie

[[services-pistard-restriction-obtenirListe]]
==== Obtenir toutes les restrictions type

Voici les 2 services Web pour obtenir les restrictions type où le paramètre *codeCategorie* est optionel pour préciser le code de catégorie :

 * <<services-pistard-restriction-obtenirListeComplete>>
 * <<services-pistard-restriction-obtenirListeUnePage>>

[[services-pistard-restriction-obtenirListeComplete]]
===== Obtenir la liste complète des restrictions type actives

====== Exemple de requête

include::{snippets}/get_obtenirRestrictionsListeComplete/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/get_obtenirRestrictionsListeComplete/http-response.adoc[]

[[services-pistard-restriction-obtenirListeUnePage]]
===== Obtenir une page de restrictions type

Si aucun code de catégorie est fourni, les restrictions type peu importe leur statut sont retournées.
Si un code de catégorie est fourni, seulement les restrictions type actives pour cette catégorie sont retournées.

====== Exemple de requête

include::{snippets}/get_filtrerRestrictionsUnePageByCodeCategorie/http-request.adoc[]

====== Exemple de réponse

include::{snippets}/get_filtrerRestrictionsUnePageByCodeCategorie/http-response.adoc[]


[[services-pistard-restriction-obtenir]]
==== Obtenir une restriction type

Ce service web permet d'obtenir une restriction type selon la logique suivante :

 . On retourne une restriction type au statut 'ACT - Active', si elle existe.
 . Sinon on retourne une restriction type au statut 'CMP - Complétée', si elle existe.
 . Sinon on retourne une restriction type au statut 'NOU - Nouvelle', si elle existe.

pass:q[<u>*La précondition*</u>] pour obtenir une restriction est :

 * Une restriction type doit exister selon le numéro de restriction type fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/get_obtenirRestrictionByNoRestriction/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_obtenirRestrictionByNoRestriction/http-response.adoc[]


[[services-pistard-restriction-obtenirApprouvee]]
==== Obtenir une restriction type approuvée et active

Ce service va obtenir une restriction type au statut 'ACT - Active' seulement.

pass:q[<u>*La précondition*</u>] pour obtenir une restriction type approuvée et active est :

 * Une restriction type doit exister selon le numéro de restriction type fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/get_obtenirApprovedRestriction/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_obtenirApprovedRestriction/http-response.adoc[]


[[services-pistard-restriction-modifier]]
==== Modifier une restriction type

Ce service web permet de modifier une restriction type selon la logique suivante :

 . On modifie une restriction type au statut 'NOU - Nouvelle', si elle existe.
 . Sinon on modifie une restriction type au statut 'CMP - Complétée', si elle existe.

pass:q[<u>*Les préconditions*</u>] pour modifier une restriction type sont :

 * Une restriction type doit exister selon le numéro de restriction fourni sinon un code HTTP 404 est retourné.
 * L'employé doit avoir le rôle ANALYSTE_RESTRICTION sinon un code HTTP 403 est retourné.
 * Si une restriction type a été trouvée avec le numéro de restriction et que son statut est 'ACT - Active', un code HTTP 400 est retourné.

===== Exemple de requête

include::{snippets}/put_modifierRestriction/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/put_modifierRestriction/http-response.adoc[]


[[services-pistard-restriction-approuver]]
==== Approuver une restriction type

pass:q[<u>*Les préconditions*</u>] pour approuver une restriction type sont :

 * Une restriction complétée doit exister selon le numéro de restriction fourni sinon un code HTTP 404 est retourné.
 * L'employé doit avoir le rôle ANALYSTE_RESTRICTION sinon un code HTTP 403 est retourné.

===== Exemple de requête

include::{snippets}/patch_approuverRestriction/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/patch_approuverRestriction/http-response.adoc[]


[[services-pistard-restrictionAppliquee]]
=== Restriction appliquée

Les services Web pour les restrictions appliquées permettent :

 * <<services-pistard-restrictionAppliquee-filtrer>>
 * <<services-pistard-restrictionAppliquee-obtenirListePourUnite>>
 * <<services-pistard-restrictionAppliquee-obtenirListePourContenant>>
 * <<services-pistard-restrictionAppliquee-obtenirListePourRestriction>>
 * <<services-pistard-restrictionAppliquee-obtenir>>
 * <<services-pistard-restrictionAppliquee-creerPourContenus>>
 * <<services-pistard-restrictionAppliquee-modifier>>
 * <<services-pistard-restrictionAppliquee-supprimer>>

Voici les types de restriction appliquée :

 * CONTENU - Pour une restriction appliquée à tout le contenu d'un contenant.
 * UNIDE - Pour une restriction appliquée à tout le contenu d'une unité de description.

[[services-pistard-restrictionAppliquee-filtrer]]
==== Filtrer les restrictions appliquées

Ce service web permet de filtrer les restrictions appliquées selon différents critères.

Voici les critères de recherche possibles :

 * codesCentreArchive : Liste de codes de centre d'archives pour filtrer sur un ou plusieurs centres d'archives. Si la liste n'est pas fournie, tous les centres d'archives seront considérés n'ayant pas de filtre.
 * idUniteDescription : Identifiant d'une unité de description pour la recherche des restrictions appliquées pour une unité de description.
 * coteUniteDescription : Cote complète d'une unité de description pour la recherche des restrictions appliquées pour une unité de description.
 * idContenantAssocie : Identifiant d'un contenant pour la recherche des restrictions appliquées pour les contenus associés à un contenant.
 * noAcquisitionAssociee : Numéro d'acquisition pour la recherche des restrictions appliquées dans le format 'aaaa-mm-jj' pour les contenus associés à un contenant d'une acquisition.
 * noContenantAssocie : Numéro d'un contenant avec le numéro d'acquisition dans le format 'aaaa-mm-jj \ {noContenant}' pour la recherche des restrictions appliquées pour les contenus associés à un contenant. Seulement le numéro de contenant est considéré pour ce champ, c'est pourquoi il faut absolument que le numéro d'acquisition soit fourni dans le champ noAcquisitionAssociee.
 * idsCategorieRestriction : Identifiant pour préciser un ou plusieurs identifiants de catégorie de restriction pour la recherche des restrictions appliquées pour une ou plusieurs catégories de restriction.
 * idsRestriction : Identifiant pour préciser un ou plusieurs identifiants de restriction type pour la recherche des restrictions appliquées pour une ou plusieurs restrictions type.
 * dateDebut : Date de début pour la recherche des restrictions appliquées avec une date de début d'application postérieure ou égale à la date de début fournie.
 * dateFin : Date de fin pour la recherche des restrictions appliquées avec une date de fin antérieure ou égale à la date de fin fournie.
 * dateApplicationEffective : Date d'application effective pour la recherche des restrictions appliquées avec une date de début plus petite ou égale et une date de fin plus grande ou égale à la date d'application effective fournie.
 * indInclureUnitesInferieures : Indicateur pour inclure les restrictions appliquées associées aux unités inférieures de l'unité de description fournie. Cet indicateur est utilisé seulement si une cote coteUniteDescription ou un identifiant idUniteDescription est fourni.

Voici le nom des champs à utiliser pour l'affichage des colonnes dans la liste des restrictions appliquées :

 * centreArchive.nom : Nom du centre d'archives
 * noRestriction : Numéro de la restriction type
 * contenant.noAcquisition + ' \ ' + contenant.noContenant : Numéro de contenant formatté avec son numéro d'acquisition
 * unite.coteComplete : Cote complète de l'unité de description
 * dateDebut : Date de début de l'application de la restriction
 * dateFin : Date de fin de l'application de la restriction

Voici le nom des champs à utiliser pour demander un tri pour l'une des colonnes dans la liste des restrictions appliquées :

 * adresseLocalisation : Nom pour demander un tri pour la colonne 'Localisation'.
 * coteUniteDescription : Nom pour demander un tri pour la colonne 'Cote'.
 * dateDebut : Nom pour demander un tri pour la colonne 'Date début'.
 * dateFin : Nom pour demander un tri pour la colonne 'Date fin'.
 * noContenant : Nom pour demander un tri pour la colonne 'Contenant'.
 * noContenantTriInitial : Nom pour demander le tri par défaut.
 * nomCentreArchive : Nom pour demander un tri pour la colonne 'Centre d'archives'.
 * noRestriction : Nom pour demander un tri pour la colonne 'Restriction'.

pass:q[<u>*Les préconditions*</u>] pour filtrer les restrictions appliquées sont :

 * Une unité de description doit exister selon la cote fournie sinon un code HTTP 404 est retourné.
 * Une catégorie de restriction doit exister pour chaque identifiant fourni sinon un code HTTP 404 est retourné.
 * Une restriction type doit exister pour chaque identifiant fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

include::{snippets}/post_filtrerRestrictionsAppliqueesPourCentreArchives/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/post_filtrerRestrictionsAppliqueesPourCentreArchives/http-response.adoc[]


[[services-pistard-restrictionAppliquee-obtenirListePourUnite]]
==== Obtenir les restrictions appliquées à une unité de description ou à ses contenus

===== Exemple de requête

include::{snippets}/get_obtenirRestrictionsAppliqueesAUnite/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_obtenirRestrictionsAppliqueesAUnite/http-response.adoc[]


[[services-pistard-restrictionAppliquee-obtenirListePourContenant]]
==== Obtenir les restrictions appliquées à tous les contenus d'un contenant

===== Exemple de requête

include::{snippets}/get_obtenirRestrictionsAppliqueesAuContenant/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_obtenirRestrictionsAppliqueesAuContenant/http-response.adoc[]


[[services-pistard-restrictionAppliquee-obtenirListePourRestriction]]
==== Obtenir les restrictions appliquées pour une restriction type

===== Exemple de requête

include::{snippets}/get_obtenirRestrictionsAppliqueesPourRestriction/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_obtenirRestrictionsAppliqueesPourRestriction/http-response.adoc[]


[[services-pistard-restrictionAppliquee-obtenir]]
==== Obtenir une restriction appliquée

pass:q[<u>*La précondition*</u>] pour obtenir une restriction est :

 * Une restriction appliquée doit exister selon l'identifiant de la restriction appliquée fourni sinon un code HTTP 404 est retourné.

===== Exemple de requête

Avec un usager authentifié :

include::{snippets}/get_obtenirRestrictionAppliquee/http-request.adoc[]

Ou de façon anonyme (externe) :

include::{snippets}/get_obtenirRestrictionAppliquee_externe/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/get_obtenirRestrictionAppliquee/http-response.adoc[]


[[services-pistard-restrictionAppliquee-creerPourContenus]]
==== Appliquer une restriction type à une liste contenus de fonds

pass:q[<u>*Les préconditions*</u>] pour d'appliquer une restriction type à une liste de contenus de fonds sont :

 * Une restriction type et les contenus de fonds doivent exister selon les identifiants fournis sinon un code HTTP 404 est retourné.
 * L'usager interne doit être archiviste (PROFESSIONNEL) ou soutien (SOUTIEN) et être autorisé à modifier l'unité de description associée qui doit être en traitement sinon un code HTTP 403 est retourné.

===== Exemple de requête

include::{snippets}/post_creerRestrictionsAppliqueesPourContenusFonds/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/post_creerRestrictionsAppliqueesPourContenusFonds/http-response.adoc[]


[[services-pistard-restrictionAppliquee-modifier]]
==== Modifier une restriction appliquée

Ce service web permet de modifier une restriction appliquée selon la logique suivante :

 . On modifie une restriction appliquée au statut 'NOU - Nouvelle', si elle existe.
 . Sinon on modifie une restriction appliquée au statut 'CMP - Complétée', si elle existe.

pass:q[<u>*Les préconditions*</u>] pour modifier une restriction appliquée sont :

 * Une restriction appliquée doit exister selon l'identifiant de la restriction appliquée fourni sinon un code HTTP 404 est retourné.
 * L'usager interne doit être archiviste (PROFESSIONNEL) ou soutien (SOUTIEN) et être autorisé à modifier l'unité de description associée qui doit être en traitement sinon un code HTTP 403 est retourné.

===== Exemple de requête

include::{snippets}/put_modifierRestrictionAppliquee/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/put_modifierRestrictionAppliquee/http-response.adoc[]

[[services-pistard-restrictionAppliquee-supprimer]]
==== Supprimer une ou plusieurs restrictions appliquées

pass:q[<u>*Les préconditions*</u>] pour supprimer une ou plusieurs restrictions appliquées sont :

 * Une restriction appliquée doit exister pour chaque identifiant fourni sinon un code HTTP 404 est retourné.
 * Si l'unité de description associée est en traitement, l'usager interne doit être archiviste (PROFESSIONNEL) ou soutien (SOUTIEN) et être autorisé à modifier l'unité associée sinon un code HTTP 403 est retourné.
 * Si l'unité de description associée est traitée ou diffusée, l'usager interne doit être coordonnateur (COORDONNATEUR) être autorisé à supprimer la restriction appliquée sinon un code HTTP 403 est retourné.

===== Exemple de requête

include::{snippets}/delete_supprimerRestrictionsAppliquees/http-request.adoc[]

===== Exemple de réponse

include::{snippets}/delete_supprimerRestrictionsAppliquees/http-response.adoc[]
